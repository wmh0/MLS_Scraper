function cloneCopyEvent(e,t){var n=0;t.each(function(){if(this.nodeName!==(e[n]&&e[n].nodeName))return;var t=jQuery.data(e[n++]),r=jQuery.data(this,t),s=t&&t.events;if(s){delete r.handle,r.events={};for(var o in s)for(var u in s[o])jQuery.event.add(this,o,s[o][u],s[o][u].data)}})}function finishShapeDescription(e,t,n,r){function i(e,t){return t=n.getAny(t),e[t]}e.photos=e.photos||[];var s=getEntityKey(),o=window.storage.getFromEntityKey(s).get("entity"),u=o["dynamic.CanLocateSurProps"],a=e.getMarkers?e.getMarkers():e.data,f=e.getLocation?e.getLocation():e.position,l=!e.position;f=f?{latitude:f.latitude?f.latitude:f.lat(),longitude:f.longitude?f.longitude:f.lng()}:{};var c=jQuery(".infobox-form-container",e.element);jQuery.each(a,function(o,a){a.data&&(a=a.data[0]);var h=a.key(),p=jQuery(c[o]);e.photos[o]&&e.photos[o].dispose(),e.photos[o]=initMultiPhotos(p,a,s,r,n),updateMapPopupToFavorites(p.find(".favorites-indicator a").get(0),h),updateMapPopupToShoppingCart(p.find(".shopping-cart-indicator a").get(0),h);var d=jQuery("span:contains('"+e.mlLabel+"')",p).next("span");d.html('<a href="javascript:void(0)" onclick="viewListing(\''+d.text()+"');\">"+d.text()+"</a>");if(f.latitude&&f.longitude){var d=jQuery("span:contains('[BirdsEye]')",p).next("span");getCurrentUserObject().appName!=="MLSLI"&&d.html(l?'<a class="birds-eye" href="javascript:void(0);">Bird\'s eye</a>':"");var v=d.find("a.birds-eye");v.click(function(){viewBirdsEye(f.latitude,f.longitude,t)}),e.showLspLink!==!1&&u==="true"&&(e.address||(e.address=i(a,"addr")+"<br />"+i(a,"town")+", "+i(a,"zip")),d.append('<br /><a class="locate-surrounding-properties" href="javascript:void(0);">Locate Surrounding Properties</a>').find("a.locate-surrounding-properties").data("shape",e).click(function(){var e=jQuery(this).data("shape");if(!e)return;var t=e.getLocation?e.getLocation():e.position;t={latitude:t.latitude?t.latitude:t.lat(),longitude:t.longitude?t.longitude:t.lng()},SDS.Services.MLSLI.EntityReportLinksProvider.handleLocateSurroundingLink(t.latitude,t.longitude,e.address,h)}))}a.selected&&(jQuery("input[type=checkbox]",p).prop("checked",!0),jQuery("input[type=checkbox]",p).attr("checked",!0))})}function HideMapInfobox(e,t){e.hideInfobox()}function createMapInfoboxContainer(e){var t=document.createElement("div"),n=e.getMarkers?e.getMarkers():e.data;jQuery.isArray(n)||(n=[n]);if(n.length>1){var r=jQuery("<strong>"+n.length+" Overlapping Listings: </strong>");r.appendTo(t)}var i=jQuery('<div class="infobox-listing-container"></div>');return n.length>2&&!e.getMarkers&&i.css({position:"relative",height:"275px","overflow-y":"scroll","overflow-x":"hidden"}),i.appendTo(t),appendSeperatorToElement(i),"Microsoft"in window?e.content=t:e.infoboxContent=t,i}function RenderMapInfoboxStaticContent(e,t,n){var r=createMapInfoboxContainer(t);r.append(n),appendSeperatorToElement(r),e.displayInfobox(t)}function appendSeperatorToElement(e){var t=jQuery('<div style="border-top:1px solid #eeeeee;" />');t.appendTo(e)}function RenderMapInfobox(e,t,n,r,i){var s=createMapInfoboxContainer(t),o=t.getMarkers?t.getMarkers():t.data,u=0,a={};if(t.getMarkers)for(var f=0,l=o.length;f<l;f++)o[f].data.length&&o[f].data.length==1&&(a[o[f].data[0].key()]=o[f]);for(var f=0,l=o.length;f<l;f++){var c=o[f];o[f].data&&(c=o[f].data.length&&o[f].data.length==1?o[f].data[0]:o[f].data);var h=jQuery('<div class="infobox-form-container"></div>');h.appendTo(s),appendSeperatorToElement(s),RenderFormForInfobox(t,c,h.get(0),n,function(){u++;if(u==l){if(t.mouseovercancel)return;t.element=t.infoboxContent||t.content,t.GetID=function(){return"infobox"},t.GetCustomIcon=function(e,n){var r=t;a[n]&&(r=a[n]);if(!e&&!r.getHtmlContent&&!r.getContent)return"";var i=jQuery(e||r.getHtmlContent?r.getHtmlContent():r.getContent());return i.outerHTML()},postProcessMapDescription(t,r),finishShapeDescription(t,e,r,i),e.displayInfobox(t)}})}}function RenderFormForInfobox(e,t,n,r,i){var s={};for(var o=0;o<requiredMapFields.length;o++)s[requiredMapFields[o]]=t.get(requiredMapFields[o]);var u=(t.get("class")||"").toLowerCase(),a=getTemplateFromForms(r,u),f=new SDS.Controls.Forms.Form({element:n});SDS.Controls.Forms.Form.deserializeFromXmlString(a,f),s=extendListingObject(s);if(e.mouseovercancel)return;f.bindObject(s,i)}function getTemplateFromForms(e,t){var n=jQuery.grep(e,function(e){var n=e.conditions||e.form.filterConditions||[];for(var r=0;r<n.length;r++)if(n[r].name=="class"&&n[r].value==t)return!0;return!1});return n.length==0&&n.push(e.single()),n=n.single().data,n}function initShapes(e,t,n){console.log2("initShapes"),init=!0;for(var r=0;r<e.length;++r){var i=e[r];i.element||(setMapDescription(i,t,n),init=!1)}return init}function initMultiPhotos(e,t,n,r,i){var s=jQuery("img",e);s.attr("id")||s.attr("id","multi-photo-"+t.key());if(typeof google!="undefined"&&google.maps&&s.parents(".infobox-container").length==0){window.setTimeout(function(){initMultiPhotos(jQuery("#multi-photo-"+t.key()).parent(),t,n,r,i)},150);return}var o=function(){s.unbind("error",o).attr("src",(window.relativeRootPath?window.relativeRootPath:"../../")+"Images/PhotoNotAvailable.png")};return s.bind("error",o),new SDS.MultiPhotos(s,{id:t.key(),entity:n,object:t,columnMap:i},r)}function addMapPopupToFavorites(e,t){SDS.Favorites.toggle(t)}function addMapPopupToShoppingCart(e,t){SDS.Controls.ListingCartDialog.Show({selections:[t],caller:null})}function updateMapPopupToFavorites(e,t){var n=SDS.Favorites.contains(t)?"addClass":"removeClass";jQuery(e)[n]("favorite")}function updateMapPopupToShoppingCart(e,t){var n=SDS.ShoppingCart.contains(t)?"addClass":"removeClass";jQuery(e)[n]("in-cart")}function viewBirdsEye(e,t,n){e*=1,t*=1;var r={latitude:e,longitude:t};jQuery("#facebox").css("display")=="block"?Directions.map.SetBirdseyeScene(r):(n.isUserPanEvent=n.isUserZoomEvent=!0,n.setCenter(r,19,Microsoft.Maps.MapTypeId.birdseye),n.isUserPanEvent=n.isUserZoomEvent=!1)}function viewListing(e,t){jQuery("#directions-dialog").css("display")!="none"&&jQuery(document).trigger("close.facebox","directions-dialog"),SDS.Routes.set("View",{id:e})}function selectListing(e,t,n){var r={};r[t]=n,resultsList.findByExample(r).setSelected(jQuery(e).prop("checked"),!1)}function setMapDescription(e,t,n){var r={};for(var i=0;i<requiredMapFields.length;i++)r[requiredMapFields[i]]=e.data.cellAt(n.get(requiredMapFields[i]));var s=(e.data.cellAt(e.class_column)||"").toLowerCase();template=jQuery.grep(t.mapForms,function(e){var t=e.conditions||e.form.filterConditions||[];for(var n=0;n<t.length;n++)if(t[n].name=="class"&&t[n].value==s)return!0;return!1}),template.length==0&&template.push(t.mapForms.single()),template=template.single().data,e.element=document.createElement("DIV");var o=new SDS.Controls.Forms.Form({element:e.element});SDS.Controls.Forms.Form.deserializeFromXmlString(template,o),r=extendListingObject(r),o.bindObject(r,function(){postProcessMapDescription(e,n)})}function postProcessMapDescription(e,t){var n=e.getMarkers?e.getMarkers():e.data,r=jQuery(".infobox-form-container",e.element);for(var i=0,s=n.length;i<s;i++){var o=n[i].data||n[i];o.length==1&&(o=o[0]);var u=jQuery(r[i]),a=o.key(),f=o.get?o.get("arn")||"":"",l=o.get?o.get("parcel_id")||"":"";u.find("span:contains('[Photo]')").next("span").html('<img style="width:165px;height:124px;" class="map-description-listing-photo" src="'+betterGetPhotoUrl(getFullEntityName(),a)+'" onerror="this.src=\'../../Images/PhotoNotAvailable.png\';this.onerror=null;" alt="" />');var c=['<span class="favorites-indicator column-icon sprite" style="white-space:nowrap;"><a href="javascript:void(0)" class="favorite-'+(a||"").replace("*","_")+'" onclick="addMapPopupToFavorites(this,\''+a+"');return false;\">Favorites</a></span>",'<span class="shopping-cart-indicator column-icon sprite" style="white-space:nowrap;"><a href="javascript:void(0)" class="shopping-cart-'+(a||"").replace("*","_")+'" onclick="addMapPopupToShoppingCart(this,\''+a+"');return false;\">Shopping Cart</a></span>"];u.find("span:contains('[Favorites]')").next("span").html(c.join("")),u.find("span:contains('[ListCheckbox]')").next("span").html('<input type="checkbox" onclick="selectListing(this,'+o._key+",'"+a+"');\" />"),u.find("span:contains('[ListNum]')").next("span").html(e.GetCustomIcon(o.pinHtml,a));switch(currentAppName){case"TREB":postProcessTREBMapDescription(e,t);break;case"MLSLI":postProcessMLSLIMapDescription(e,t)}}jQuery(e.element).find(".template-report").attr("shapeID",e.GetID()),SDS.Events.trigger("mapShapeProcessed",e)}function postProcessTREBMapDescription(e,t){e.mlLabel="MLS#"}function postProcessMLSLIMapDescription(e,t){var n=e.data[0];getEntityKey().entityName=="Listing"?(n.cellAt(t.get("lsc")).toLowerCase()=="cl"?(jQuery("span:contains('[$listPrice]')",e.element).parent().css("display","none"),val=n.cellAt(t.get("sp_dol")),(val==null||val.length==0)&&jQuery("span:contains('[sp_dol]')",e.element).parent().css("display","none")):n.cellAt(t.get("lsc")).toLowerCase()=="re"?(jQuery("span:contains('[$listPrice]')",e.element).parent().css("display","none"),val=n.cellAt(t.get("rp_dol")),(val==null||val.length==0)&&jQuery("span:contains('[rp_dol]')",e.element).parent().css("display","none")):(jQuery("span:contains('[sp_dol]')",e.element).parent().css("display","none"),jQuery("span:contains('[rp_dol]')",e.element).parent().css("display","none")),e.mlLabel="ML#"):e.mlLabel="ID#"}function _log(e,t){console&&console.log&&console.log(e,t),console&&console.log2&&console.log2(e,t)}function __msAjaxDateReplacer(e,t){if(!t||typeof t!="string"||t.lastIndexOf("/Date(",0)!==0)return t;var n=__reMsAjax.exec(t);if(!n)return t;var r=n[1].split(/[-+,.]/);return new Date(r[0]?+r[0]:0-+r[1])}function __dateReplacer(e,t){if(!t||typeof t!="string")return t;var n=reISO.exec(t);if(n)return new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],+n[6]));n=reMsAjax.exec(t);if(!n)return t;var r=n[1].split(/[-+,.]/);return new Date(r[0]?+r[0]:0-+r[1])}function handleSwitchDisplayUnits(e){var t=jQuery(e).val();jQuery(".link-item").each(function(e,t){var n=jQuery(t);n.removeClass("loaded").attr("data-deferred-load",n.attr("data-deferred-loaded")).children("div:not(.header)").remove()}),$.force_appear()}function showSpinner(e){var t="<center>Preparing to print or download...</center>";window.currentAppName.toLowerCase()==="treb"&&(t="<center>Preparing to print...</center>"),spinner.setText(t),spinner.show();var n=jQuery(".spinner-container");n.css("position","fixed"),n.css("top",jQuery(window).scrollTop()+10+"px")}function hideSpinner(){spinner.hide()}function printFailed(e){hideSpinner(),(new SDS.Controls.PageBox("There was a Problem",'<p>We were unable to render the requested printout. Please submit a bug report and include the following information:<br /><br /><p><textarea style="width:300px;height:200px;">"Failed to render print data: '+e._message+e._statusCode+e._timedOut+e._stackTrace+"</textarea></p><p>(You can select all text by clicking in the box and press CTRL-A (Windows) or META-A (Mac)</p>",{bodyClass:"body-dark"})).show()}function detectAcrobat(){var acrobat=new Object;acrobat.installed=!1;if(navigator.plugins&&navigator.plugins.length){var hasChromePDF=!1;for(var x=0,l=navigator.plugins.length;x<l;++x){if(navigator.plugins[x].description.indexOf("Adobe Acrobat")!=-1||navigator.plugins[x].description.indexOf("Adobe PDF")!=-1||navigator.plugins[x].name.indexOf("Adobe Acrobat")!=-1)acrobat.installed=!0;navigator.plugins[x].name.indexOf("Chrome PDF")!=-1&&(hasChromePDF=!0)}hasChromePDF&&acrobat.installed&&(acrobat.installed=!1)}else if(window.ActiveXObject){for(x=2;x<10;x++)try{oAcro=eval("new ActiveXObject('PDF.PdfCtrl."+x+"');"),oAcro&&(acrobat.installed=!0)}catch(e){}try{oAcro4=new ActiveXObject("PDF.PdfCtrl.1"),oAcro4&&(acrobat.installed=!0)}catch(e){}try{oAcro7=new ActiveXObject("AcroPDF.PDF.1"),oAcro7&&(acrobat.installed=!0)}catch(e){}}return acrobat.installed}function handleChromeOrFirefoxOnMac(){return navigator.appVersion.indexOf("Mac")!=-1&&jQuery.browser.mozilla?"<p>Important: Your print or preview will open using your browser's file download feature. Select 'Open with Preview' to view or print it.</p>":navigator.appVersion.indexOf("Mac")!=-1&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1?"<p>Important: Your print or preview will open using your browser's file download feature. Click on the button at the bottom of the screen to view or print it in Mac Preview.</p>":null}function getEntityKey(){return{entityName:"Listing",appName:window.currentAppName,metadataName:window.currentAppName}}function getUserKey(){return{appName:window.currentAppName,userID:"_guest"}}function getConnectionKey(){return{appName:window.currentAppName,connectionName:window.currentAppName,metadataName:window.currentAppName}}function getSelectedKeys(){var e=jQuery(".data-list tbody tr").map(function(e,t){return jQuery(t).data("identifier")}),t=jQuery(".data-list tbody tr:has(:selected)").map(function(e,t){return jQuery(t).data("identifier")});return t&&t.length?t:e}function elementInViewport(e){if(!e||!e.getBoundingClientRect)return!1;var t=e.getBoundingClientRect(),n=document.documentElement;return t.bottom>=0&&t.right>=0&&t.top<=n.clientHeight&&t.left<=n.clientWidth}function getUniqueLocationsFromPins(e){var t={},n=e.getLength();for(var r=0;r<n;r++){var i=e.get(r).getLocation(),s=JSON.stringify(i);t[s]=i}var o=[];for(var u in t)o.push(t[u]);return o}function handlePrintClick(e){var t=jQuery(".reports .link-item"),n={download:!1,printPreviewCallback:printPreviewCallback,printCallback:printCallback,selectedListing:e,numListings:t.length,hasMap:document.getElementById("map"),showHelp:!1},r=new SDS.Controls.PrintLinkBox(n);r.showDialog()}function handleDownloadClick(e){var t=jQuery(".reports .link-item"),n={download:!0,downloadCallback:downloadCallback,selectedListing:e,numListings:t.length,hasMap:document.getElementById("map"),showHelp:!1},r=new SDS.Controls.PrintLinkBox(n);r.showDialog()}function getPrintData(e){var t=null,n=window.columnMap,r=jQuery(".reports .link-item");if(e.ThisListing){var i=r.filter("[data-identifier='"+e.CurMlNum+"']").get(0);t=[i]}else t=r;if(r.length==1||t[0]==null)t=r;var s=window.metadataMap,o=[];for(var u=0;u<t.length;u++)o.push(jQuery(t[u]).data("identifier"));var a=[],f=[],l=[];jQuery(".data-list thead th[data-metadata]").each(function(e,t){var n=jQuery(t).data("metadata");n.displayName=jQuery(t).text(),a.push(n),f.push({name:n.name,headerText:n.displayName,width:n.width,clusterPos:0,clusterLength:1}),l.push(n.name)});var c=SDS.Maps.Map.map,h={latitude:0,longitude:0},p=0;if(c){h=c.getCenter(),p=c.getZoomLevel(),h={longitude:h.lng?h.lng():h.longitude,latitude:h.lat?h.lat():h.latitude};var d=c.initPrint();if(typeof d=="undefined")return}return p<1?p=1:p>21&&(p=21),{listingCols:l,dataMap:{},selectedMlnums:o,colNames:l,colIds:l,colItms:f,sortOrder:[],mapCenter:h,mapZoom:p,viewNum:d}}function downloadCallback(e){var t=getPrintData(e);if(!t)return;pdfPrint.printLinkPage({criteriaName:"",mlsNums:t.selectedMlnums,columns:t.colIds,columnNames:t.colItms,sortOrder:[],pushpins:[],mapCenter:{x:t.mapCenter.longitude,y:t.mapCenter.latitude},mapZoom:Math.round(t.mapZoom,10),mapLocations:null,mapPlaces:null,mapView:t.viewNum,currentShape:null,link:window._link,includeMap:e.IncludeMap,keyColumnName:"ml_num",formId:window.formID,photoGalleryFormID:window.photoGalleryFormID},!0,!0)}function printPreviewCallback(e){var t=getPrintData(e);if(!t)return;pdfPrint.printLinkPage({criteriaName:"",mlsNums:t.selectedMlnums,columns:t.colIds,columnNames:t.colItms,sortOrder:[],pushpins:[],mapCenter:{x:t.mapCenter.longitude,y:t.mapCenter.latitude},mapZoom:Math.round(t.mapZoom,10),mapLocations:null,mapPlaces:null,mapView:t.viewNum,currentShape:null,link:window._link,includeMap:e.IncludeMap,keyColumnName:"ml_num",formId:window.formID,photoGalleryFormID:window.photoGalleryFormID},!0)}function printCallback(e){var t=getPrintData(e);if(!t)return;pdfPrint.printLinkPage({criteriaName:"",mlsNums:t.selectedMlnums,columns:t.colIds,columnNames:t.colItms,sortOrder:[],pushpins:[],mapCenter:{x:t.mapCenter.longitude,y:t.mapCenter.latitude},mapZoom:Math.round(t.mapZoom,10),mapLocations:null,mapPlaces:null,mapView:t.viewNum,currentShape:null,link:window._link,includeMap:e.IncludeMap,keyColumnName:"ml_num",formId:window.formID,photoGalleryFormID:window.photoGalleryFormID},!1)}function formatMoney(e,t,n,r){if(e==null||typeof e=="undefined")return"";var t=isNaN(t=Math.abs(t))?2:t,n=n==undefined?",":n,r=r==undefined?".":r,i=e<0?"-":"",s=parseInt(e=Math.abs(+e||0).toFixed(t))+"",o=(o=s.length)>3?o%3:0,u="$"+i+(o?s.substr(0,o)+r:"")+s.substr(o).replace(/(\d{3})(?=\d)/g,"$1"+r)+(t?n+Math.abs(e-s).toFixed(t).slice(2):"");return u.length>3&&u.slice(-3)==".00"&&(u=u.substring(0,u.length-3)),u}!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function g(e){var t="length"in e&&e.length,n=h.type(e);return"function"===n||h.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e}function S(e,t,n){if(h.isFunction(t))return h.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return h.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(E.test(t))return h.filter(t,e,n);t=h.filter(t,e)}return h.grep(e,function(e){return h.inArray(e,t)>=0!==n})}function A(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function _(e){var t=M[e]={};return h.each(e.match(O)||[],function(e,n){t[n]=!0}),t}function P(){T.addEventListener?(T.removeEventListener("DOMContentLoaded",H,!1),e.removeEventListener("load",H,!1)):(T.detachEvent("onreadystatechange",H),e.detachEvent("onload",H))}function H(){(T.addEventListener||"load"===event.type||"complete"===T.readyState)&&(P(),h.ready())}function q(e,t,n){if(void 0===n&&1===e.nodeType){var r="data-"+t.replace(I,"-$1").toLowerCase();if(n=e.getAttribute(r),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:F.test(n)?h.parseJSON(n):n}catch(i){}h.data(e,t,n)}else n=void 0}return n}function R(e){var t;for(t in e)if(("data"!==t||!h.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function U(e,t,r,i){if(h.acceptData(e)){var s,o,u=h.expando,a=e.nodeType,f=a?h.cache:e,l=a?e[u]:e[u]&&u;if(l&&f[l]&&(i||f[l].data)||void 0!==r||"string"!=typeof t)return l||(l=a?e[u]=n.pop()||h.guid++:u),f[l]||(f[l]=a?{}:{toJSON:h.noop}),("object"==typeof t||"function"==typeof t)&&(i?f[l]=h.extend(f[l],t):f[l].data=h.extend(f[l].data,t)),o=f[l],i||(o.data||(o.data={}),o=o.data),void 0!==r&&(o[h.camelCase(t)]=r),"string"==typeof t?(s=o[t],null==s&&(s=o[h.camelCase(t)])):s=o,s}}function z(e,t,n){if(h.acceptData(e)){var r,i,s=e.nodeType,o=s?h.cache:e,u=s?e[h.expando]:h.expando;if(o[u]){if(t&&(r=n?o[u]:o[u].data)){h.isArray(t)?t=t.concat(h.map(t,h.camelCase)):t in r?t=[t]:(t=h.camelCase(t),t=t in r?[t]:t.split(" ")),i=t.length;while(i--)delete r[t[i]];if(n?!R(r):!h.isEmptyObject(r))return}(n||(delete o[u].data,R(o[u])))&&(s?h.cleanData([e],!0):l.deleteExpando||o!=o.window?delete o[u]:o[u]=null)}}}function et(){return!0}function tt(){return!1}function nt(){try{return T.activeElement}catch(e){}}function rt(e){var t=it.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function wt(e,t){var n,r,i=0,s=typeof e.getElementsByTagName!==B?e.getElementsByTagName(t||"*"):typeof e.querySelectorAll!==B?e.querySelectorAll(t||"*"):void 0;if(!s)for(s=[],n=e.childNodes||e;null!=(r=n[i]);i++)!t||h.nodeName(r,t)?s.push(r):h.merge(s,wt(r,t));return void 0===t||t&&h.nodeName(e,t)?h.merge([e],s):s}function Et(e){J.test(e.type)&&(e.defaultChecked=e.checked)}function St(e,t){return h.nodeName(e,"table")&&h.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function xt(e){return e.type=(null!==h.find.attr(e,"type"))+"/"+e.type,e}function Tt(e){var t=vt.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function Nt(e,t){for(var n,r=0;null!=(n=e[r]);r++)h._data(n,"globalEval",!t||h._data(t[r],"globalEval"))}function Ct(e,t){if(1===t.nodeType&&h.hasData(e)){var n,r,i,s=h._data(e),o=h._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;i>r;r++)h.event.add(t,n,u[n][r])}o.data&&(o.data=h.extend({},o.data))}}function kt(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!l.noCloneEvent&&t[h.expando]){i=h._data(t);for(r in i.events)h.removeEvent(t,r,i.handle);t.removeAttribute(h.expando)}"script"===n&&t.text!==e.text?(xt(t).text=e.text,Tt(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),l.html5Clone&&e.innerHTML&&!h.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&J.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}function Ot(t,n){var r,i=h(n.createElement(t)).appendTo(n.body),s=e.getDefaultComputedStyle&&(r=e.getDefaultComputedStyle(i[0]))?r.display:h.css(i[0],"display");return i.detach(),s}function Mt(e){var t=T,n=At[e];return n||(n=Ot(e,t),"none"!==n&&n||(Lt=(Lt||h("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=(Lt[0].contentWindow||Lt[0].contentDocument).document,t.write(),t.close(),n=Ot(e,t),Lt.detach()),At[e]=n),n}function jt(e,t){return{get:function(){var n=e();if(null!=n)return n?void delete this.get:(this.get=t).apply(this,arguments)}}}function Vt(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Xt.length;while(i--)if(t=Xt[i]+n,t in e)return t;return r}function $t(e,t){for(var n,r,i,s=[],o=0,u=e.length;u>o;o++)r=e[o],r.style&&(s[o]=h._data(r,"olddisplay"),n=r.style.display,t?(s[o]||"none"!==n||(r.style.display=""),""===r.style.display&&V(r)&&(s[o]=h._data(r,"olddisplay",Mt(r.nodeName)))):(i=V(r),(n&&"none"!==n||!i)&&h._data(r,"olddisplay",i?n:h.css(r,"display"))));for(o=0;u>o;o++)r=e[o],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?s[o]||"":"none"));return e}function Jt(e,t,n){var r=Rt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function Kt(e,t,n,r,i){for(var s=n===(r?"border":"content")?4:"width"===t?1:0,o=0;4>s;s+=2)"margin"===n&&(o+=h.css(e,n+X[s],!0,i)),r?("content"===n&&(o-=h.css(e,"padding"+X[s],!0,i)),"margin"!==n&&(o-=h.css(e,"border"+X[s]+"Width",!0,i))):(o+=h.css(e,"padding"+X[s],!0,i),"padding"!==n&&(o+=h.css(e,"border"+X[s]+"Width",!0,i)));return o}function Qt(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,s=Pt(e),o=l.boxSizing&&"border-box"===h.css(e,"boxSizing",!1,s);if(0>=i||null==i){if(i=Ht(e,t,s),(0>i||null==i)&&(i=e.style[t]),Dt.test(i))return i;r=o&&(l.boxSizingReliable()||i===e.style[t]),i=parseFloat(i)||0}return i+Kt(e,t,n||(o?"border":"content"),r,s)+"px"}function Gt(e,t,n,r,i){return new Gt.prototype.init(e,t,n,r,i)}function on(){return setTimeout(function(){Yt=void 0}),Yt=h.now()}function un(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=X[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function an(e,t,n){for(var r,i=(sn[t]||[]).concat(sn["*"]),s=0,o=i.length;o>s;s++)if(r=i[s].call(n,t,e))return r}function fn(e,t,n){var r,i,s,o,u,a,f,c,p=this,d={},v=e.style,m=e.nodeType&&V(e),g=h._data(e,"fxshow");n.queue||(u=h._queueHooks(e,"fx"),null==u.unqueued&&(u.unqueued=0,a=u.empty.fire,u.empty.fire=function(){u.unqueued||a()}),u.unqueued++,p.always(function(){p.always(function(){u.unqueued--,h.queue(e,"fx").length||u.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[v.overflow,v.overflowX,v.overflowY],f=h.css(e,"display"),c="none"===f?h._data(e,"olddisplay")||Mt(e.nodeName):f,"inline"===c&&"none"===h.css(e,"float")&&(l.inlineBlockNeedsLayout&&"inline"!==Mt(e.nodeName)?v.zoom=1:v.display="inline-block")),n.overflow&&(v.overflow="hidden",l.shrinkWrapBlocks()||p.always(function(){v.overflow=n.overflow[0],v.overflowX=n.overflow[1],v.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],en.exec(i)){if(delete t[r],s=s||"toggle"===i,i===(m?"hide":"show")){if("show"!==i||!g||void 0===g[r])continue;m=!0}d[r]=g&&g[r]||h.style(e,r)}else f=void 0;if(h.isEmptyObject(d))"inline"===("none"===f?Mt(e.nodeName):f)&&(v.display=f);else{g?"hidden"in g&&(m=g.hidden):g=h._data(e,"fxshow",{}),s&&(g.hidden=!m),m?h(e).show():p.done(function(){h(e).hide()}),p.done(function(){var t;h._removeData(e,"fxshow");for(t in d)h.style(e,t,d[t])});for(r in d)o=an(m?g[r]:0,r,p),r in g||(g[r]=o.start,m&&(o.end=o.start,o.start="width"===r||"height"===r?1:0))}}function ln(e,t){var n,r,i,s,o;for(n in e)if(r=h.camelCase(n),i=t[r],s=e[n],h.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=h.cssHooks[r],o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}function cn(e,t,n){var r,i,s=0,o=rn.length,u=h.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;for(var t=Yt||on(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;a>o;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),1>s&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:h.extend({},t),opts:h.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Yt||on(),duration:n.duration,tweens:[],createTween:function(t,n){var r=h.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;for(ln(l,f.opts.specialEasing);o>s;s++)if(r=rn[s].call(f,e,l,f.opts))return r;return h.map(l,an,f),h.isFunction(f.opts.start)&&f.opts.start.call(e,f),h.fx.timer(h.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function Fn(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(O)||[];if(h.isFunction(n))while(r=s[i++])"+"===r.charAt(0)?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function In(e,t,n,r){function o(u){var a;return i[u]=!0,h.each(e[u]||[],function(e,u){var f=u(t,n,r);return"string"!=typeof f||s||i[f]?s?!(a=f):void 0:(t.dataTypes.unshift(f),o(f),!1)}),a}var i={},s=e===Hn;return o(t.dataTypes[0])||!i["*"]&&o("*")}function qn(e,t){var n,r,i=h.ajaxSettings.flatOptions||{};for(r in t)void 0!==t[r]&&((i[r]?e:n||(n={}))[r]=t[r]);return n&&h.extend(!0,e,n),e}function Rn(e,t,n){var r,i,s,o,u=e.contents,a=e.dataTypes;while("*"===a[0])a.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(o in u)if(u[o]&&u[o].test(i)){a.unshift(o);break}if(a[0]in n)s=a[0];else{for(o in n){if(!a[0]||e.converters[o+" "+a[0]]){s=o;break}r||(r=o)}s=s||r}return s?(s!==a[0]&&a.unshift(s),n[s]):void 0}function Un(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];s=l.shift();while(s)if(e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift())if("*"===s)s=a;else if("*"!==a&&a!==s){if(o=f[a+" "+s]||f["* "+s],!o)for(i in f)if(u=i.split(" "),u[1]===s&&(o=f[a+" "+u[0]]||f["* "+u[0]])){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}return{state:"success",data:t}}function Jn(e,t,n,r){var i;if(h.isArray(t))h.each(t,function(t,i){n||Wn.test(e)?r(e,i):Jn(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==h.type(t))r(e,t);else for(i in t)Jn(e+"["+i+"]",t[i],n,r)}function Yn(){try{return new e.XMLHttpRequest}catch(t){}}function Zn(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function ir(e){return h.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var n=[],r=n.slice,i=n.concat,s=n.push,o=n.indexOf,u={},a=u.toString,f=u.hasOwnProperty,l={},c="1.11.3",h=function(e,t){return new h.fn.init(e,t)},p=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,d=/^-ms-/,v=/-([\da-z])/gi,m=function(e,t){return t.toUpperCase()};h.fn=h.prototype={jquery:c,constructor:h,selector:"",length:0,toArray:function(){return r.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:r.call(this)},pushStack:function(e){var t=h.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return h.each(this,e,t)},map:function(e){return this.pushStack(h.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(r.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:s,sort:n.sort,splice:n.splice},h.extend=h.fn.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;for("boolean"==typeof o&&(f=o,o=arguments[u]||{},u++),"object"==typeof o||h.isFunction(o)||(o={}),u===a&&(o=this,u--);a>u;u++)if(null!=(i=arguments[u]))for(r in i)e=o[r],n=i[r],o!==n&&(f&&n&&(h.isPlainObject(n)||(t=h.isArray(n)))?(t?(t=!1,s=e&&h.isArray(e)?e:[]):s=e&&h.isPlainObject(e)?e:{},o[r]=h.extend(f,s,n)):void 0!==n&&(o[r]=n));return o},h.extend({expando:"jQuery"+(c+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===h.type(e)},isArray:Array.isArray||function(e){return"array"===h.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!h.isArray(e)&&e-parseFloat(e)+1>=0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==h.type(e)||e.nodeType||h.isWindow(e))return!1;try{if(e.constructor&&!f.call(e,"constructor")&&!f.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}if(l.ownLast)for(t in e)return f.call(e,t);for(t in e);return void 0===t||f.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?u[a.call(e)]||"object":typeof e},globalEval:function(t){t&&h.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(d,"ms-").replace(v,m)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=g(e);if(n){if(o){for(;s>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(o){for(;s>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(p,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(g(Object(e))?h.merge(n,"string"==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(o)return o.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,t){var n=+t.length,r=0,i=e.length;while(n>r)e[i++]=t[r++];if(n!==n)while(void 0!==t[r])e[i++]=t[r++];return e.length=i,e},grep:function(e,t,n){for(var r,i=[],s=0,o=e.length,u=!n;o>s;s++)r=!t(e[s],s),r!==u&&i.push(e[s]);return i},map:function(e,t,n){var r,s=0,o=e.length,u=g(e),a=[];if(u)for(;o>s;s++)r=t(e[s],s,n),null!=r&&a.push(r);else for(s in e)r=t(e[s],s,n),null!=r&&a.push(r);return i.apply([],a)},guid:1,proxy:function(e,t){var n,i,s;return"string"==typeof t&&(s=e[t],t=e,e=s),h.isFunction(e)?(n=r.call(arguments,2),i=function(){return e.apply(t||this,n.concat(r.call(arguments)))},i.guid=e.guid=e.guid||h.guid++,i):void 0},now:function(){return+(new Date)},support:l}),h.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){u["[object "+t+"]"]=t.toLowerCase()});var y=function(e){function ot(e,t,r,i){var s,u,f,l,c,d,g,y,S,x;if((t?t.ownerDocument||t:E)!==p&&h(t),t=t||p,r=r||[],l=t.nodeType,"string"!=typeof e||!e||1!==l&&9!==l&&11!==l)return r;if(!i&&v){if(11!==l&&(s=Z.exec(e)))if(f=s[1]){if(9===l){if(u=t.getElementById(f),!u||!u.parentNode)return r;if(u.id===f)return r.push(u),r}else if(t.ownerDocument&&(u=t.ownerDocument.getElementById(f))&&b(t,u)&&u.id===f)return r.push(u),r}else{if(s[2])return D.apply(r,t.getElementsByTagName(e)),r;if((f=s[3])&&n.getElementsByClassName)return D.apply(r,t.getElementsByClassName(f)),r}if(n.qsa&&(!m||!m.test(e))){if(y=g=w,S=t,x=1!==l&&e,1===l&&"object"!==t.nodeName.toLowerCase()){d=o(e),(g=t.getAttribute("id"))?y=g.replace(tt,"\\$&"):t.setAttribute("id",y),y="[id='"+y+"'] ",c=d.length;while(c--)d[c]=y+gt(d[c]);S=et.test(e)&&vt(t.parentNode)||t,x=d.join(",")}if(x)try{return D.apply(r,S.querySelectorAll(x)),r}catch(T){}finally{g||t.removeAttribute("id")}}}return a(e.replace(z,"$1"),t,r,i)}function ut(){function t(n,i){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=i}var e=[];return t}function at(e){return e[w]=!0,e}function ft(e){var t=p.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function lt(e,t){var n=e.split("|"),i=e.length;while(i--)r.attrHandle[n[i]]=t}function ct(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||L)-(~e.sourceIndex||L);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ht(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function pt(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function dt(e){return at(function(t){return t=+t,at(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function vt(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function mt(){}function gt(e){for(var t=0,n=e.length,r="";n>t;t++)r+=e[t].value;return r}function yt(e,t,n){var r=t.dir,i=n&&"parentNode"===r,s=x++;return t.first?function(t,n,s){while(t=t[r])if(1===t.nodeType||i)return e(t,n,s)}:function(t,n,o){var u,a,f=[S,s];if(o){while(t=t[r])if((1===t.nodeType||i)&&e(t,n,o))return!0}else while(t=t[r])if(1===t.nodeType||i){if(a=t[w]||(t[w]={}),(u=a[r])&&u[0]===S&&u[1]===s)return f[2]=u[2];if(a[r]=f,f[2]=e(t,n,o))return!0}}}function bt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function wt(e,t,n){for(var r=0,i=t.length;i>r;r++)ot(e,t[r],n);return n}function Et(e,t,n,r,i){for(var s,o=[],u=0,a=e.length,f=null!=t;a>u;u++)(s=e[u])&&(!n||n(s,r,i))&&(o.push(s),f&&t.push(u));return o}function St(e,t,n,r,i,s){return r&&!r[w]&&(r=St(r)),i&&!i[w]&&(i=St(i,s)),at(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||wt(t||"*",u.nodeType?[u]:u,[]),m=!e||!s&&t?v:Et(v,h,e,u,a),g=n?i||(s?e:d||r)?[]:o:m;if(n&&n(m,g,u,a),r){f=Et(g,p),r(f,[],u,a),l=f.length;while(l--)(c=f[l])&&(g[p[l]]=!(m[p[l]]=c))}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?H(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=Et(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):D.apply(o,g)})}function xt(e){for(var t,n,i,s=e.length,o=r.relative[e[0].type],u=o||r.relative[" "],a=o?1:0,l=yt(function(e){return e===t},u,!0),c=yt(function(e){return H(t,e)>-1},u,!0),h=[function(e,n,r){var i=!o&&(r||n!==f)||((t=n).nodeType?l(e,n,r):c(e,n,r));return t=null,i}];s>a;a++)if(n=r.relative[e[a].type])h=[yt(bt(h),n)];else{if(n=r.filter[e[a].type].apply(null,e[a].matches),n[w]){for(i=++a;s>i;i++)if(r.relative[e[i].type])break;return St(a>1&&bt(h),a>1&&gt(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(z,"$1"),n,i>a&&xt(e.slice(a,i)),s>i&&xt(e=e.slice(i)),s>i&&gt(e))}h.push(n)}return bt(h)}function Tt(e,t){var n=t.length>0,i=e.length>0,s=function(s,o,u,a,l){var c,h,d,v=0,m="0",g=s&&[],y=[],b=f,w=s||i&&r.find.TAG("*",l),E=S+=null==b?1:Math.random()||.1,x=w.length;for(l&&(f=o!==p&&o);m!==x&&null!=(c=w[m]);m++){if(i&&c){h=0;while(d=e[h++])if(d(c,o,u)){a.push(c);break}l&&(S=E)}n&&((c=!d&&c)&&v--,s&&g.push(c))}if(v+=m,n&&m!==v){h=0;while(d=t[h++])d(g,y,o,u);if(s){if(v>0)while(m--)g[m]||y[m]||(y[m]=M.call(a));y=Et(y)}D.apply(a,y),l&&!s&&y.length>0&&v+t.length>1&&ot.uniqueSort(a)}return l&&(S=E,f=b),g};return n?at(s):s}var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w="sizzle"+1*new Date,E=e.document,S=0,x=0,T=ut(),N=ut(),C=ut(),k=function(e,t){return e===t&&(c=!0),0},L=1<<31,A={}.hasOwnProperty,O=[],M=O.pop,_=O.push,D=O.push,P=O.slice,H=function(e,t){for(var n=0,r=e.length;r>n;n++)if(e[n]===t)return n;return-1},B="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",j="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",I=F.replace("w","w#"),q="\\["+j+"*("+F+")(?:"+j+"*([*^$|!~]?=)"+j+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+j+"*\\]",R=":("+F+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+q+")*)|.*)\\)|)",U=new RegExp(j+"+","g"),z=new RegExp("^"+j+"+|((?:^|[^\\\\])(?:\\\\.)*)"+j+"+$","g"),W=new RegExp("^"+j+"*,"+j+"*"),X=new RegExp("^"+j+"*([>+~]|"+j+")"+j+"*"),V=new RegExp("="+j+"*([^\\]'\"]*?)"+j+"*\\]","g"),$=new RegExp(R),J=new RegExp("^"+I+"$"),K={ID:new RegExp("^#("+F+")"),CLASS:new RegExp("^\\.("+F+")"),TAG:new RegExp("^("+F.replace("w","w*")+")"),ATTR:new RegExp("^"+q),PSEUDO:new RegExp("^"+R),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+j+"*(even|odd|(([+-]|)(\\d*)n|)"+j+"*(?:([+-]|)"+j+"*(\\d+)|))"+j+"*\\)|)","i"),bool:new RegExp("^(?:"+B+")$","i"),needsContext:new RegExp("^"+j+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+j+"*((?:-\\d)?\\d*)"+j+"*\\)|)(?=[^-]|$)","i")},Q=/^(?:input|select|textarea|button)$/i,G=/^h\d$/i,Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/[+~]/,tt=/'|\\/g,nt=new RegExp("\\\\([\\da-f]{1,6}"+j+"?|("+j+")|.)","ig"),rt=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},it=function(){h()};try{D.apply(O=P.call(E.childNodes),E.childNodes),O[E.childNodes.length].nodeType}catch(st){D={apply:O.length?function(e,t){_.apply(e,P.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}n=ot.support={},s=ot.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},h=ot.setDocument=function(e){var t,i,o=e?e.ownerDocument||e:E;return o!==p&&9===o.nodeType&&o.documentElement?(p=o,d=o.documentElement,i=o.defaultView,i&&i!==i.top&&(i.addEventListener?i.addEventListener("unload",it,!1):i.attachEvent&&i.attachEvent("onunload",it)),v=!s(o),n.attributes=ft(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ft(function(e){return e.appendChild(o.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=Y.test(o.getElementsByClassName),n.getById=ft(function(e){return d.appendChild(e).id=w,!o.getElementsByName||!o.getElementsByName(w).length}),n.getById?(r.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&v){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},r.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){return e.getAttribute("id")===t}}):(delete r.find.ID,r.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){var n="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}}),r.find.TAG=n.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if("*"===e){while(n=s[i++])1===n.nodeType&&r.push(n);return r}return s},r.find.CLASS=n.getElementsByClassName&&function(e,t){return v?t.getElementsByClassName(e):void 0},g=[],m=[],(n.qsa=Y.test(o.querySelectorAll))&&(ft(function(e){d.appendChild(e).innerHTML="<a id='"+w+"'></a><select id='"+w+"-\f]' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]="+j+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||m.push("\\["+j+"*(?:value|"+B+")"),e.querySelectorAll("[id~="+w+"-]").length||m.push("~="),e.querySelectorAll(":checked").length||m.push(":checked"),e.querySelectorAll("a#"+w+"+*").length||m.push(".#.+[+~]")}),ft(function(e){var t=o.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&m.push("name"+j+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")})),(n.matchesSelector=Y.test(y=d.matches||d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.msMatchesSelector))&&ft(function(e){n.disconnectedMatch=y.call(e,"div"),y.call(e,"[s!='']:x"),g.push("!=",R)}),m=m.length&&new RegExp(m.join("|")),g=g.length&&new RegExp(g.join("|")),t=Y.test(d.compareDocumentPosition),b=t||Y.test(d.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&1===r.nodeType&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},k=t?function(e,t){if(e===t)return c=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r?r:(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&r||!n.sortDetached&&t.compareDocumentPosition(e)===r?e===o||e.ownerDocument===E&&b(E,e)?-1:t===o||t.ownerDocument===E&&b(E,t)?1:l?H(l,e)-H(l,t):0:4&r?-1:1)}:function(e,t){if(e===t)return c=!0,0;var n,r=0,i=e.parentNode,s=t.parentNode,u=[e],a=[t];if(!i||!s)return e===o?-1:t===o?1:i?-1:s?1:l?H(l,e)-H(l,t):0;if(i===s)return ct(e,t);n=e;while(n=n.parentNode)u.unshift(n);n=t;while(n=n.parentNode)a.unshift(n);while(u[r]===a[r])r++;return r?ct(u[r],a[r]):u[r]===E?-1:a[r]===E?1:0},o):p},ot.matches=function(e,t){return ot(e,null,null,t)},ot.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&h(e),t=t.replace(V,"='$1']"),!(!n.matchesSelector||!v||g&&g.test(t)||m&&m.test(t)))try{var r=y.call(e,t);if(r||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(i){}return ot(t,p,null,[e]).length>0},ot.contains=function(e,t){return(e.ownerDocument||e)!==p&&h(e),b(e,t)},ot.attr=function(e,t){(e.ownerDocument||e)!==p&&h(e);var i=r.attrHandle[t.toLowerCase()],s=i&&A.call(r.attrHandle,t.toLowerCase())?i(e,t,!v):void 0;return void 0!==s?s:n.attributes||!v?e.getAttribute(t):(s=e.getAttributeNode(t))&&s.specified?s.value:null},ot.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ot.uniqueSort=function(e){var t,r=[],i=0,s=0;if(c=!n.detectDuplicates,l=!n.sortStable&&e.slice(0),e.sort(k),c){while(t=e[s++])t===e[s]&&(i=r.push(s));while(i--)e.splice(r[i],1)}return l=null,e},i=ot.getText=function(e){var t,n="",r=0,s=e.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=i(e)}else if(3===s||4===s)return e.nodeValue}else while(t=e[r++])n+=i(t);return n},r=ot.selectors={cacheLength:50,createPseudo:at,match:K,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(nt,rt),e[3]=(e[3]||e[4]||e[5]||"").replace(nt,rt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ot.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ot.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return K.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&$.test(n)&&(t=o(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(nt,rt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=T[e+" "];return t||(t=new RegExp("(^|"+j+")"+e+"("+j+"|$)"))&&T(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=ot.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i.replace(U," ")+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),u="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:1===c.nodeType)return!1;d=v="only"===e&&!d&&"nextSibling"}return!0}if(d=[o?m.firstChild:m.lastChild],o&&y){l=m[w]||(m[w]={}),f=l[e]||[],p=f[0]===S&&f[1],h=f[0]===S&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(1===c.nodeType&&++h&&c===t){l[e]=[S,p,h];break}}else if(y&&(f=(t[w]||(t[w]={}))[e])&&f[0]===S)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:1===c.nodeType)&&++h&&(y&&((c[w]||(c[w]={}))[e]=[S,h]),c===t))break;return h-=i,h===r||h%r===0&&h/r>=0}}},PSEUDO:function(e,t){var n,i=r.pseudos[e]||r.setFilters[e.toLowerCase()]||ot.error("unsupported pseudo: "+e);return i[w]?i(t):i.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?at(function(e,n){var r,s=i(e,t),o=s.length;while(o--)r=H(e,s[o]),e[r]=!(n[r]=s[o])}):function(e){return i(e,0,n)}):i}},pseudos:{not:at(function(e){var t=[],n=[],r=u(e.replace(z,"$1"));return r[w]?at(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)(s=o[u])&&(e[u]=!(t[u]=s))}):function(e,i,s){return t[0]=e,r(t,null,s,n),t[0]=null,!n.pop()}}),has:at(function(e){return function(t){return ot(e,t).length>0}}),contains:at(function(e){return e=e.replace(nt,rt),function(t){return(t.textContent||t.innerText||i(t)).indexOf(e)>-1}}),lang:at(function(e){return J.test(e||"")||ot.error("unsupported lang: "+e),e=e.replace(nt,rt).toLowerCase(),function(t){var n;do if(n=v?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===d},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return G.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:dt(function(){return[0]}),last:dt(function(e,t){return[t-1]}),eq:dt(function(e,t,n){return[0>n?n+t:n]}),even:dt(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:dt(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:dt(function(e,t,n){for(var r=0>n?n+t:n;--r>=0;)e.push(r);return e}),gt:dt(function(e,t,n){for(var r=0>n?n+t:n;++r<t;)e.push(r);return e})}},r.pseudos.nth=r.pseudos.eq;for(t in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=ht(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=pt(t);return mt.prototype=r.filters=r.pseudos,r.setFilters=new mt,o=ot.tokenize=function(e,t){var n,i,s,o,u,a,f,l=N[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=r.preFilter;while(u){(!n||(i=W.exec(u)))&&(i&&(u=u.slice(i[0].length)||u),a.push(s=[])),n=!1,(i=X.exec(u))&&(n=i.shift(),s.push({value:n,type:i[0].replace(z," ")}),u=u.slice(n.length));for(o in r.filter)!(i=K[o].exec(u))||f[o]&&!(i=f[o](i))||(n=i.shift(),s.push({value:n,type:o,matches:i}),u=u.slice(n.length));if(!n)break}return t?u.length:u?ot.error(e):N(e,a).slice(0)},u=ot.compile=function(e,t){var n,r=[],i=[],s=C[e+" "];if(!s){t||(t=o(e)),n=t.length;while(n--)s=xt(t[n]),s[w]?r.push(s):i.push(s);s=C(e,Tt(i,r)),s.selector=e}return s},a=ot.select=function(e,t,i,s){var a,f,l,c,h,p="function"==typeof e&&e,d=!s&&o(e=p.selector||e);if(i=i||[],1===d.length){if(f=d[0]=d[0].slice(0),f.length>2&&"ID"===(l=f[0]).type&&n.getById&&9===t.nodeType&&v&&r.relative[f[1].type]){if(t=(r.find.ID(l.matches[0].replace(nt,rt),t)||[])[0],!t)return i;p&&(t=t.parentNode),e=e.slice(f.shift().value.length)}a=K.needsContext.test(e)?0:f.length;while(a--){if(l=f[a],r.relative[c=l.type])break;if((h=r.find[c])&&(s=h(l.matches[0].replace(nt,rt),et.test(f[0].type)&&vt(t.parentNode)||t))){if(f.splice(a,1),e=s.length&&gt(f),!e)return D.apply(i,s),i;break}}}return(p||u(e,d))(s,t,!v,i,et.test(e)&&vt(t.parentNode)||t),i},n.sortStable=w.split("").sort(k).join("")===w,n.detectDuplicates=!!c,h(),n.sortDetached=ft(function(e){return 1&e.compareDocumentPosition(p.createElement("div"))}),ft(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||lt("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&ft(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||lt("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),ft(function(e){return null==e.getAttribute("disabled")})||lt(B,function(e,t,n){var r;return n?void 0:e[t]===!0?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),ot}(e);h.find=y,h.expr=y.selectors,h.expr[":"]=h.expr.pseudos,h.unique=y.uniqueSort,h.text=y.getText,h.isXMLDoc=y.isXML,h.contains=y.contains;var b=h.expr.match.needsContext,w=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,E=/^.[^:#\[\.,]*$/;h.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?h.find.matchesSelector(r,e)?[r]:[]:h.find.matches(e,h.grep(t,function(e){return 1===e.nodeType}))},h.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(h(e).filter(function(){for(t=0;i>t;t++)if(h.contains(r[t],this))return!0}));for(t=0;i>t;t++)h.find(e,r[t],n);return n=this.pushStack(i>1?h.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(S(this,e||[],!1))},not:function(e){return this.pushStack(S(this,e||[],!0))},is:function(e){return!!S(this,"string"==typeof e&&b.test(e)?h(e):e||[],!1).length}});var x,T=e.document,N=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=h.fn.init=function(e,t){var n,r;if(!e)return this;if("string"==typeof e){if(n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:N.exec(e),!n||!n[1]&&t)return!t||t.jquery?(t||x).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof h?t[0]:t,h.merge(this,h.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:T,!0)),w.test(n[1])&&h.isPlainObject(t))for(n in t)h.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}if(r=T.getElementById(n[2]),r&&r.parentNode){if(r.id!==n[2])return x.find(e);this.length=1,this[0]=r}return this.context=T,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):h.isFunction(e)?"undefined"!=typeof x.ready?x.ready(e):e(h):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),h.makeArray(e,this))};C.prototype=h.fn,x=h(T);var k=/^(?:parents|prev(?:Until|All))/,L={children:!0,contents:!0,next:!0,prev:!0};h.extend({dir:function(e,t,n){var r=[],i=e[t];while(i&&9!==i.nodeType&&(void 0===n||1!==i.nodeType||!h(i).is(n)))1===i.nodeType&&r.push(i),i=i[t];return r},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}}),h.fn.extend({has:function(e){var t,n=h(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(h.contains(this,n[t]))return!0})},closest:function(e,t){for(var n,r=0,i=this.length,s=[],o=b.test(e)||"string"!=typeof e?h(e,t||this.context):0;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:1===n.nodeType&&h.find.matchesSelector(n,e))){s.push(n);break}return this.pushStack(s.length>1?h.unique(s):s)},index:function(e){return e?"string"==typeof e?h.inArray(this[0],h(e)):h.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(h.unique(h.merge(this.get(),h(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),h.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return h.dir(e,"parentNode")},parentsUntil:function(e,t,n){return h.dir(e,"parentNode",n)},next:function(e){return A(e,"nextSibling")},prev:function(e){return A(e,"previousSibling")},nextAll:function(e){return h.dir(e,"nextSibling")},prevAll:function(e){return h.dir(e,"previousSibling")},nextUntil:function(e,t,n){return h.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return h.dir(e,"previousSibling",n)},siblings:function(e){return h.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return h.sibling(e.firstChild)},contents:function(e){return h.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:h.merge([],e.childNodes)}},function(e,t){h.fn[e]=function(n,r){var i=h.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=h.filter(r,i)),this.length>1&&(L[e]||(i=h.unique(i)),k.test(e)&&(i=i.reverse())),this.pushStack(i)}});var O=/\S+/g,M={};h.Callbacks=function(e){e="string"==typeof e?M[e]||_(e):h.extend({},e);var t,n,r,i,s,o,u=[],a=!e.once&&[],f=function(c){for(n=e.memory&&c,r=!0,s=o||0,o=0,i=u.length,t=!0;u&&i>s;s++)if(u[s].apply(c[0],c[1])===!1&&e.stopOnFalse){n=!1;break}t=!1,u&&(a?a.length&&f(a.shift()):n?u=[]:l.disable())},l={add:function(){if(u){var r=u.length;!function s(t){h.each(t,function(t,n){var r=h.type(n);"function"===r?e.unique&&l.has(n)||u.push(n):n&&n.length&&"string"!==r&&s(n)})}(arguments),t?i=u.length:n&&(o=r,f(n))}return this},remove:function(){return u&&h.each(arguments,function(e,n){var r;while((r=h.inArray(n,u,r))>-1)u.splice(r,1),t&&(i>=r&&i--,s>=r&&s--)}),this},has:function(e){return e?h.inArray(e,u)>-1:!!u&&!!u.length},empty:function(){return u=[],i=0,this},disable:function(){return u=a=n=void 0,this},disabled:function(){return!u},lock:function(){return a=void 0,n||l.disable(),this},locked:function(){return!a},fireWith:function(e,n){return!u||r&&!a||(n=n||[],n=[e,n.slice?n.slice():n],t?a.push(n):f(n)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!r}};return l},h.extend({Deferred:function(e){var t=[["resolve","done",h.Callbacks("once memory"),"resolved"],["reject","fail",h.Callbacks("once memory"),"rejected"],["notify","progress",h.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return h.Deferred(function(n){h.each(t,function(t,s){var o=h.isFunction(e[t])&&e[t];i[s[1]](function(){var e=o&&o.apply(this,arguments);e&&h.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s[0]+"With"](this===r?n.promise():this,o?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?h.extend(e,r):r}},i={};return r.pipe=r.then,h.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[1^e][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=r.call(arguments),i=n.length,s=1!==i||e&&h.isFunction(e.promise)?i:0,o=1===s?e:h.Deferred(),u=function(e,t,n){return function(i){t[e]=this,n[e]=arguments.length>1?r.call(arguments):i,n===a?o.notifyWith(t,n):--s||o.resolveWith(t,n)}},a,f,l;if(i>1)for(a=new Array(i),f=new Array(i),l=new Array(i);i>t;t++)n[t]&&h.isFunction(n[t].promise)?n[t].promise().done(u(t,l,n)).fail(o.reject).progress(u(t,f,a)):--s;return s||o.resolveWith(l,n),o.promise()}});var D;h.fn.ready=function(e){return h.ready.promise().done(e),this},h.extend({isReady:!1,readyWait:1,holdReady:function(e){e?h.readyWait++:h.ready(!0)},ready:function(e){if(e===!0?!--h.readyWait:!h.isReady){if(!T.body)return setTimeout(h.ready);h.isReady=!0,e!==!0&&--h.readyWait>0||(D.resolveWith(T,[h]),h.fn.triggerHandler&&(h(T).triggerHandler("ready"),h(T).off("ready")))}}}),h.ready.promise=function(t){if(!D)if(D=h.Deferred(),"complete"===T.readyState)setTimeout(h.ready);else if(T.addEventListener)T.addEventListener("DOMContentLoaded",H,!1),e.addEventListener("load",H,!1);else{T.attachEvent("onreadystatechange",H),e.attachEvent("onload",H);var n=!1;try{n=null==e.frameElement&&T.documentElement}catch(r){}n&&n.doScroll&&!function i(){if(!h.isReady){try{n.doScroll("left")}catch(e){return setTimeout(i,50)}P(),h.ready()}}()}return D.promise(t)};var B="undefined",j;for(j in h(l))break;l.ownLast="0"!==j,l.inlineBlockNeedsLayout=!1,h(function(){var e,t,n,r;n=T.getElementsByTagName("body")[0],n&&n.style&&(t=T.createElement("div"),r=T.createElement("div"),r.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(r).appendChild(t),typeof t.style.zoom!==B&&(t.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",l.inlineBlockNeedsLayout=e=3===t.offsetWidth,e&&(n.style.zoom=1)),n.removeChild(r))}),function(){var e=T.createElement("div");if(null==l.deleteExpando){l.deleteExpando=!0;try{delete e.test}catch(t){l.deleteExpando=!1}}e=null}(),h.acceptData=function(e){var t=h.noData[(e.nodeName+" ").toLowerCase()],n=+e.nodeType||1;return 1!==n&&9!==n?!1:!t||t!==!0&&e.getAttribute("classid")===t};var F=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,I=/([A-Z])/g;h.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?h.cache[e[h.expando]]:e[h.expando],!!e&&!R(e)},data:function(e,t,n){return U(e,t,n)},removeData:function(e,t){return z(e,t)},_data:function(e,t,n){return U(e,t,n,!0)},_removeData:function(e,t){return z(e,t,!0)}}),h.fn.extend({data:function(e,t){var n,r,i,s=this[0],o=s&&s.attributes;if(void 0===e){if(this.length&&(i=h.data(s),1===s.nodeType&&!h._data(s,"parsedAttrs"))){n=o.length;while(n--)o[n]&&(r=o[n].name,0===r.indexOf("data-")&&(r=h.camelCase(r.slice(5)),q(s,r,i[r])));h._data(s,"parsedAttrs",!0)}return i}return"object"==typeof e?this.each(function(){h.data(this,e)}):arguments.length>1?this.each(function(){h.data(this,e,t)}):s?q(s,e,h.data(s,e)):void 0},removeData:function(e){return this.each(function(){h.removeData(this,e)})}}),h.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=h._data(e,t),n&&(!r||h.isArray(n)?r=h._data(e,t,h.makeArray(n)):r.push(n)),r||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=h.queue(e,t),r=n.length,i=n.shift(),s=h._queueHooks(e,t),o=function(){h.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return h._data(e,n)||h._data(e,n,{empty:h.Callbacks("once memory").add(function(){h._removeData(e,t+"queue"),h._removeData(e,n)})})}}),h.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?h.queue(this[0],e):void 0===t?this:this.each(function(){var n=h.queue(this,e,t);h._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&h.dequeue(this,e)})},dequeue:function(e){return this.each(function(){h.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=h.Deferred(),s=this,o=this.length,u=function(){--r||i.resolveWith(s,[s])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(o--)n=h._data(s[o],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(u));return u(),i.promise(t)}});var W=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,X=["Top","Right","Bottom","Left"],V=function(e,t){return e=t||e,"none"===h.css(e,"display")||!h.contains(e.ownerDocument,e)},$=h.access=function(e,t,n,r,i,s,o){var u=0,a=e.length,f=null==n;if("object"===h.type(n)){i=!0;for(u in n)h.access(e,t,u,n[u],!0,s,o)}else if(void 0!==r&&(i=!0,h.isFunction(r)||(o=!0),f&&(o?(t.call(e,r),t=null):(f=t,t=function(e,t,n){return f.call(h(e),n)})),t))for(;a>u;u++)t(e[u],n,o?r:r.call(e[u],u,t(e[u],n)));return i?e:f?t.call(e):a?t(e[0],n):s},J=/^(?:checkbox|radio)$/i;!function(){var e=T.createElement("input"),t=T.createElement("div"),n=T.createDocumentFragment();if(t.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",l.leadingWhitespace=3===t.firstChild.nodeType,l.tbody=!t.getElementsByTagName("tbody").length,l.htmlSerialize=!!t.getElementsByTagName("link").length,l.html5Clone="<:nav></:nav>"!==T.createElement("nav").cloneNode(!0).outerHTML,e.type="checkbox",e.checked=!0,n.appendChild(e),l.appendChecked=e.checked,t.innerHTML="<textarea>x</textarea>",l.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,n.appendChild(t),t.innerHTML="<input type='radio' checked='checked' name='t'/>",l.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,l.noCloneEvent=!0,t.attachEvent&&(t.attachEvent("onclick",function(){l.noCloneEvent=!1}),t.cloneNode(!0).click()),null==l.deleteExpando){l.deleteExpando=!0;try{delete t.test}catch(r){l.deleteExpando=!1}}}(),function(){var t,n,r=T.createElement("div");for(t in{submit:!0,change:!0,focusin:!0})n="on"+t,(l[t+"Bubbles"]=n in e)||(r.setAttribute(n,"t"),l[t+"Bubbles"]=r.attributes[n].expando===!1);r=null}();var K=/^(?:input|select|textarea)$/i,Q=/^key/,G=/^(?:mouse|pointer|contextmenu)|click/,Y=/^(?:focusinfocus|focusoutblur)$/,Z=/^([^.]*)(?:\.(.+)|)$/;h.event={global:{},add:function(e,t,n,r,i){var s,o,u,a,f,l,c,p,d,v,m,g=h._data(e);if(g){n.handler&&(a=n,n=a.handler,i=a.selector),n.guid||(n.guid=h.guid++),(o=g.events)||(o=g.events={}),(l=g.handle)||(l=g.handle=function(e){return typeof h===B||e&&h.event.triggered===e.type?void 0:h.event.dispatch.apply(l.elem,arguments)},l.elem=e),t=(t||"").match(O)||[""],u=t.length;while(u--)s=Z.exec(t[u])||[],d=m=s[1],v=(s[2]||"").split(".").sort(),d&&(f=h.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=h.event.special[d]||{},c=h.extend({type:d,origType:m,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&h.expr.match.needsContext.test(i),namespace:v.join(".")},a),(p=o[d])||(p=o[d]=[],p.delegateCount=0,f.setup&&f.setup.call(e,r,v,l)!==!1||(e.addEventListener?e.addEventListener(d,l,!1):e.attachEvent&&e.attachEvent("on"+d,l))),f.add&&(f.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),h.event.global[d]=!0);e=null}},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,p,d,v,m,g=h.hasData(e)&&h._data(e);if(g&&(l=g.events)){t=(t||"").match(O)||[""],f=t.length;while(f--)if(u=Z.exec(t[f])||[],d=m=u[1],v=(u[2]||"").split(".").sort(),d){c=h.event.special[d]||{},d=(r?c.delegateType:c.bindType)||d,p=l[d]||[],u=u[2]&&new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=s=p.length;while(s--)o=p[s],!i&&m!==o.origType||n&&n.guid!==o.guid||u&&!u.test(o.namespace)||r&&r!==o.selector&&("**"!==r||!o.selector)||(p.splice(s,1),o.selector&&p.delegateCount--,c.remove&&c.remove.call(e,o));a&&!p.length&&(c.teardown&&c.teardown.call(e,v,g.handle)!==!1||h.removeEvent(e,d,g.handle),delete l[d])}else for(d in l)h.event.remove(e,d+t[f],n,r,!0);h.isEmptyObject(l)&&(delete g.handle,h._removeData(e,"events"))}},trigger:function(t,n,r,i){var s,o,u,a,l,c,p,d=[r||T],v=f.call(t,"type")?t.type:t,m=f.call(t,"namespace")?t.namespace.split("."):[];if(u=c=r=r||T,3!==r.nodeType&&8!==r.nodeType&&!Y.test(v+h.event.triggered)&&(v.indexOf(".")>=0&&(m=v.split("."),v=m.shift(),m.sort()),o=v.indexOf(":")<0&&"on"+v,t=t[h.expando]?t:new h.Event(v,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=m.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=r),n=null==n?[t]:h.makeArray(n,[t]),l=h.event.special[v]||{},i||!l.trigger||l.trigger.apply(r,n)!==!1)){if(!i&&!l.noBubble&&!h.isWindow(r)){for(a=l.delegateType||v,Y.test(a+v)||(u=u.parentNode);u;u=u.parentNode)d.push(u),c=u;c===(r.ownerDocument||T)&&d.push(c.defaultView||c.parentWindow||e)}p=0;while((u=d[p++])&&!t.isPropagationStopped())t.type=p>1?a:l.bindType||v,s=(h._data(u,"events")||{})[t.type]&&h._data(u,"handle"),s&&s.apply(u,n),s=o&&u[o],s&&s.apply&&h.acceptData(u)&&(t.result=s.apply(u,n),t.result===!1&&t.preventDefault());if(t.type=v,!i&&!t.isDefaultPrevented()&&(!l._default||l._default.apply(d.pop(),n)===!1)&&h.acceptData(r)&&o&&r[v]&&!h.isWindow(r)){c=r[o],c&&(r[o]=null),h.event.triggered=v;try{r[v]()}catch(g){}h.event.triggered=void 0,c&&(r[o]=c)}return t.result}},dispatch:function(e){e=h.event.fix(e);var t,n,i,s,o,u=[],a=r.call(arguments),f=(h._data(this,"events")||{})[e.type]||[],l=h.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,e)!==!1){u=h.event.handlers.call(this,e,f),t=0;while((s=u[t++])&&!e.isPropagationStopped()){e.currentTarget=s.elem,o=0;while((i=s.handlers[o++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,n=((h.event.special[i.origType]||{}).handle||i.handler).apply(s.elem,a),void 0!==n&&(e.result=n)===!1&&(e.preventDefault(),e.stopPropagation()))}return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,s,o=[],u=t.delegateCount,a=e.target;if(u&&a.nodeType&&(!e.button||"click"!==e.type))for(;a!=this;a=a.parentNode||this)if(1===a.nodeType&&(a.disabled!==!0||"click"!==e.type)){for(i=[],s=0;u>s;s++)r=t[s],n=r.selector+" ",void 0===i[n]&&(i[n]=r.needsContext?h(n,this).index(a)>=0:h.find(n,this,null,[a]).length),i[n]&&i.push(r);i.length&&o.push({elem:a,handlers:i})}return u<t.length&&o.push({elem:this,handlers:t.slice(u)}),o},fix:function(e){if(e[h.expando])return e;var t,n,r,i=e.type,s=e,o=this.fixHooks[i];o||(this.fixHooks[i]=o=G.test(i)?this.mouseHooks:Q.test(i)?this.keyHooks:{}),r=o.props?this.props.concat(o.props):this.props,e=new h.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=s.srcElement||T),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,o.filter?o.filter(e,s):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button,o=t.fromElement;return null==e.pageX&&null!=t.clientX&&(r=e.target.ownerDocument||T,i=r.documentElement,n=r.body,e.pageX=t.clientX+(i&&i.scrollLeft||n&&n.scrollLeft||0)-(i&&i.clientLeft||n&&n.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||n&&n.scrollTop||0)-(i&&i.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&o&&(e.relatedTarget=o===e.target?t.toElement:o),e.which||void 0===s||(e.which=1&s?1:2&s?3:4&s?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==nt()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===nt()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return h.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(e){return h.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=h.extend(new h.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?h.event.trigger(i,null,t):h.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},h.removeEvent=T.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]===B&&(e[r]=null),e.detachEvent(r,n))},h.Event=function(e,t){return this instanceof h.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?et:tt):this.type=e,t&&h.extend(this,t),this.timeStamp=e&&e.timeStamp||h.now(),void(this[h.expando]=!0)):new h.Event(e,t)},h.Event.prototype={isDefaultPrevented:tt,isPropagationStopped:tt,isImmediatePropagationStopped:tt,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=et,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=et,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=et,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},h.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){h.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;return(!i||i!==r&&!h.contains(r,i))&&(e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t),n}}}),l.submitBubbles||(h.event.special.submit={setup:function(){return h.nodeName(this,"form")?!1:void h.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,n=h.nodeName(t,"input")||h.nodeName(t,"button")?t.form:void 0;n&&!h._data(n,"submitBubbles")&&(h.event.add(n,"submit._submit",function(e){e._submit_bubble=!0}),h._data(n,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&h.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return h.nodeName(this,"form")?!1:void h.event.remove(this,"._submit")}}),l.changeBubbles||(h.event.special.change={setup:function(){return K.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(h.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),h.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),h.event.simulate("change",this,e,!0)})),!1):void h.event.add(this,"beforeactivate._change",function(e){var t=e.target;K.test(t.nodeName)&&!h._data(t,"changeBubbles")&&(h.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||h.event.simulate("change",this.parentNode,e,!0)}),h._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return h.event.remove(this,"._change"),!K.test(this.nodeName)}}),l.focusinBubbles||h.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){h.event.simulate(t,e.target,h.event.fix(e),!0)};h.event.special[t]={setup:function(){var r=this.ownerDocument||this,i=h._data(r,t);i||r.addEventListener(e,n,!0),h._data(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=h._data(r,t)-1;i?h._data(r,t,i):(r.removeEventListener(e,n,!0),h._removeData(r,t))}}}),h.fn.extend({on:function(e,t,n,r,i){var s,o;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=void 0);for(s in e)this.on(s,t,n,e[s],i);return this}if(null==n&&null==r?(r=t,n=t=void 0):null==r&&("string"==typeof t?(r=n,n=void 0):(r=n,n=t,t=void 0)),r===!1)r=tt;else if(!r)return this;return 1===i&&(o=r,r=function(e){return h().off(e),o.apply(this,arguments)},r.guid=o.guid||(o.guid=h.guid++)),this.each(function(){h.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,h(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=void 0),n===!1&&(n=tt),this.each(function(){h.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){h.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?h.event.trigger(e,t,n,!0):void 0}});var it="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",st=/ jQuery\d+="(?:null|\d+)"/g,ot=new RegExp("<(?:"+it+")[\\s/>]","i"),ut=/^\s+/,at=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ft=/<([\w:]+)/,lt=/<tbody/i,ct=/<|&#?\w+;/,ht=/<(?:script|style|link)/i,pt=/checked\s*(?:[^=]|=\s*.checked.)/i,dt=/^$|\/(?:java|ecma)script/i,vt=/^true\/(.*)/,mt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,gt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:l.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},yt=rt(T),bt=yt.appendChild(T.createElement("div"));gt.optgroup=gt.option,gt.tbody=gt.tfoot=gt.colgroup=gt.caption=gt.thead,gt.th=gt.td,h.extend({clone:function(e,t,n){var r,i,s,o,u,a=h.contains(e.ownerDocument,e);if(l.html5Clone||h.isXMLDoc(e)||!ot.test("<"+e.nodeName+">")?s=e.cloneNode(!0):(bt.innerHTML=e.outerHTML,bt.removeChild(s=bt.firstChild)),!(l.noCloneEvent&&l.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||h.isXMLDoc(e)))for(r=wt(s),u=wt(e),o=0;null!=(i=u[o]);++o)r[o]&&kt(i,r[o]);if(t)if(n)for(u=u||wt(e),r=r||wt(s),o=0;null!=(i=u[o]);o++)Ct(i,r[o]);else Ct(e,s);return r=wt(s,"script"),r.length>0&&Nt(r,!a&&wt(e,"script")),r=u=i=null,s},buildFragment:function(e,t,n,r){for(var i,s,o,u,a,f,c,p=e.length,d=rt(t),v=[],m=0;p>m;m++)if(s=e[m],s||0===s)if("object"===h.type(s))h.merge(v,s.nodeType?[s]:s);else if(ct.test(s)){u=u||d.appendChild(t.createElement("div")),a=(ft.exec(s)||["",""])[1].toLowerCase(),c=gt[a]||gt._default,u.innerHTML=c[1]+s.replace(at,"<$1></$2>")+c[2],i=c[0];while(i--)u=u.lastChild;if(!l.leadingWhitespace&&ut.test(s)&&v.push(t.createTextNode(ut.exec(s)[0])),!l.tbody){s="table"!==a||lt.test(s)?"<table>"!==c[1]||lt.test(s)?0:u:u.firstChild,i=s&&s.childNodes.length;while(i--)h.nodeName(f=s.childNodes[i],"tbody")&&!f.childNodes.length&&s.removeChild(f)}h.merge(v,u.childNodes),u.textContent="";while(u.firstChild)u.removeChild(u.firstChild);u=d.lastChild}else v.push(t.createTextNode(s));u&&d.removeChild(u),l.appendChecked||h.grep(wt(v,"input"),Et),m=0;while(s=v[m++])if((!r||-1===h.inArray(s,r))&&(o=h.contains(s.ownerDocument,s),u=wt(d.appendChild(s),"script"),o&&Nt(u),n)){i=0;while(s=u[i++])dt.test(s.type||"")&&n.push(s)}return u=null,d},cleanData:function(e,t){for(var r,i,s,o,u=0,a=h.expando,f=h.cache,c=l.deleteExpando,p=h.event.special;null!=(r=e[u]);u++)if((t||h.acceptData(r))&&(s=r[a],o=s&&f[s])){if(o.events)for(i in o.events)p[i]?h.event.remove(r,i):h.removeEvent(r,i,o.handle);f[s]&&(delete f[s],c?delete r[a]:typeof r.removeAttribute!==B?r.removeAttribute(a):r[a]=null,n.push(s))}}}),h.fn.extend({text:function(e){return $(this,function(e){return void 0===e?h.text(this):this.empty().append((this[0]&&this[0].ownerDocument||T).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=St(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=St(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,r=e?h.filter(e,this):this,i=0;null!=(n=r[i]);i++)t||1!==n.nodeType||h.cleanData(wt(n)),n.parentNode&&(t&&h.contains(n.ownerDocument,n)&&Nt(wt(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){1===e.nodeType&&h.cleanData(wt(e,!1));while(e.firstChild)e.removeChild(e.firstChild);e.options&&h.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return h.clone(this,e,t)})},html:function(e){return $(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e)return 1===t.nodeType?t.innerHTML.replace(st,""):void 0;if(!("string"!=typeof e||ht.test(e)||!l.htmlSerialize&&ot.test(e)||!l.leadingWhitespace&&ut.test(e)||gt[(ft.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(at,"<$1></$2>");try{for(;r>n;n++)t=this[n]||{},1===t.nodeType&&(h.cleanData(wt(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,h.cleanData(wt(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=i.apply([],e);var n,r,s,o,u,a,f=0,c=this.length,p=this,d=c-1,v=e[0],m=h.isFunction(v);if(m||c>1&&"string"==typeof v&&!l.checkClone&&pt.test(v))return this.each(function(n){var r=p.eq(n);m&&(e[0]=v.call(this,n,r.html())),r.domManip(e,t)});if(c&&(a=h.buildFragment(e,this[0].ownerDocument,!1,this),n=a.firstChild,1===a.childNodes.length&&(a=n),n)){for(o=h.map(wt(a,"script"),xt),s=o.length;c>f;f++)r=a,f!==d&&(r=h.clone(r,!0,!0),s&&h.merge(o,wt(r,"script"))),t.call(this[f],r,f);if(s)for(u=o[o.length-1].ownerDocument,h.map(o,Tt),f=0;s>f;f++)r=o[f],dt.test(r.type||"")&&!h._data(r,"globalEval")&&h.contains(u,r)&&(r.src?h._evalUrl&&h._evalUrl(r.src):h.globalEval((r.text||r.textContent||r.innerHTML||"").replace(mt,"")));a=n=null}return this}}),h.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){h.fn[e]=function(e){for(var n,r=0,i=[],o=h(e),u=o.length-1;u>=r;r++)n=r===u?this:this.clone(!0),h(o[r])[t](n),s.apply(i,n.get());return this.pushStack(i)}});var Lt,At={};!function(){var e;l.shrinkWrapBlocks=function(){if(null!=e)return e;e=!1;var t,n,r;return n=T.getElementsByTagName("body")[0],n&&n.style?(t=T.createElement("div"),r=T.createElement("div"),r.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(r).appendChild(t),typeof t.style.zoom!==B&&(t.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",t.appendChild(T.createElement("div")).style.width="5px",e=3!==t.offsetWidth),n.removeChild(r),e):void 0}}();var _t=/^margin/,Dt=new RegExp("^("+W+")(?!px)[a-z%]+$","i"),Pt,Ht,Bt=/^(top|right|bottom|left)$/;e.getComputedStyle?(Pt=function(t){return t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):e.getComputedStyle(t,null)},Ht=function(e,t,n){var r,i,s,o,u=e.style;return n=n||Pt(e),o=n?n.getPropertyValue(t)||n[t]:void 0,n&&(""!==o||h.contains(e.ownerDocument,e)||(o=h.style(e,t)),Dt.test(o)&&_t.test(t)&&(r=u.width,i=u.minWidth,s=u.maxWidth,u.minWidth=u.maxWidth=u.width=o,o=n.width,u.width=r,u.minWidth=i,u.maxWidth=s)),void 0===o?o:o+""}):T.documentElement.currentStyle&&(Pt=function(e){return e.currentStyle},Ht=function(e,t,n){var r,i,s,o,u=e.style;return n=n||Pt(e),o=n?n[t]:void 0,null==o&&u&&u[t]&&(o=u[t]),Dt.test(o)&&!Bt.test(t)&&(r=u.left,i=e.runtimeStyle,s=i&&i.left,s&&(i.left=e.currentStyle.left),u.left="fontSize"===t?"1em":o,o=u.pixelLeft+"px",u.left=r,s&&(i.left=s)),void 0===o?o:o+""||"auto"}),!function(){var t,n,r,i,s,o,u;if(t=T.createElement("div"),t.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",r=t.getElementsByTagName("a")[0],n=r&&r.style){n.cssText="float:left;opacity:.5",l.opacity="0.5"===n.opacity,l.cssFloat=!!n.cssFloat,t.style.backgroundClip="content-box",t.cloneNode(!0).style.backgroundClip="",l.clearCloneStyle="content-box"===t.style.backgroundClip,l.boxSizing=""===n.boxSizing||""===n.MozBoxSizing||""===n.WebkitBoxSizing,h.extend(l,{reliableHiddenOffsets:function(){return null==o&&a(),o},boxSizingReliable:function(){return null==s&&a(),s},pixelPosition:function(){return null==i&&a(),i},reliableMarginRight:function(){return null==u&&a(),u}});function a(){var t,n,r,a;n=T.getElementsByTagName("body")[0],n&&n.style&&(t=T.createElement("div"),r=T.createElement("div"),r.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(r).appendChild(t),t.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",i=s=!1,u=!0,e.getComputedStyle&&(i="1%"!==(e.getComputedStyle(t,null)||{}).top,s="4px"===(e.getComputedStyle(t,null)||{width:"4px"}).width,a=t.appendChild(T.createElement("div")),a.style.cssText=t.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",a.style.marginRight=a.style.width="0",t.style.width="1px",u=!parseFloat((e.getComputedStyle(a,null)||{}).marginRight),t.removeChild(a)),t.innerHTML="<table><tr><td></td><td>t</td></tr></table>",a=t.getElementsByTagName("td"),a[0].style.cssText="margin:0;border:0;padding:0;display:none",o=0===a[0].offsetHeight,o&&(a[0].style.display="",a[1].style.display="none",o=0===a[0].offsetHeight),n.removeChild(r))}}}(),h.swap=function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i};var Ft=/alpha\([^)]*\)/i,It=/opacity\s*=\s*([^)]*)/,qt=/^(none|table(?!-c[ea]).+)/,Rt=new RegExp("^("+W+")(.*)$","i"),Ut=new RegExp("^([+-])=("+W+")","i"),zt={position:"absolute",visibility:"hidden",display:"block"},Wt={letterSpacing:"0",fontWeight:"400"},Xt=["Webkit","O","Moz","ms"];h.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Ht(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":l.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,s,o,u=h.camelCase(t),a=e.style;if(t=h.cssProps[u]||(h.cssProps[u]=Vt(a,u)),o=h.cssHooks[t]||h.cssHooks[u],void 0===n)return o&&"get"in o&&void 0!==(i=o.get(e,!1,r))?i:a[t];if(s=typeof n,"string"===s&&(i=Ut.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(h.css(e,t)),s="number"),null!=n&&n===n&&("number"!==s||h.cssNumber[u]||(n+="px"),l.clearCloneStyle||""!==n||0!==t.indexOf("background")||(a[t]="inherit"),!(o&&"set"in o&&void 0===(n=o.set(e,n,r)))))try{a[t]=n}catch(f){}}},css:function(e,t,n,r){var i,s,o,u=h.camelCase(t);return t=h.cssProps[u]||(h.cssProps[u]=Vt(e.style,u)),o=h.cssHooks[t]||h.cssHooks[u],o&&"get"in o&&(s=o.get(e,!0,n)),void 0===s&&(s=Ht(e,t,r)),"normal"===s&&t in Wt&&(s=Wt[t]),""===n||n?(i=parseFloat(s),n===!0||h.isNumeric(i)?i||0:s):s}}),h.each(["height","width"],function(e,t){h.cssHooks[t]={get:function(e,n,r){return n?qt.test(h.css(e,"display"))&&0===e.offsetWidth?h.swap(e,zt,function(){return Qt(e,t,r)}):Qt(e,t,r):void 0},set:function(e,n,r){var i=r&&Pt(e);return Jt(e,n,r?Kt(e,t,r,l.boxSizing&&"border-box"===h.css(e,"boxSizing",!1,i),i):0)}}}),l.opacity||(h.cssHooks.opacity={get:function(e,t){return It.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=h.isNumeric(t)?"alpha(opacity="+100*t+")":"",s=r&&r.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===h.trim(s.replace(Ft,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||r&&!r.filter)||(n.filter=Ft.test(s)?s.replace(Ft,i):s+" "+i)}}),h.cssHooks.marginRight=jt(l.reliableMarginRight,function(e,t){return t?h.swap(e,{display:"inline-block"},Ht,[e,"marginRight"]):void 0}),h.each({margin:"",padding:"",border:"Width"},function(e,t){h.cssHooks[e+t]={expand:function(n){for(var r=0,i={},s="string"==typeof n?n.split(" "):[n];4>r;r++)i[e+X[r]+t]=s[r]||s[r-2]||s[0];return i}},_t.test(e)||(h.cssHooks[e+t].set=Jt)}),h.fn.extend({css:function(e,t){return $(this,function(e,t,n){var r,i,s={},o=0;if(h.isArray(t)){for(r=Pt(e),i=t.length;i>o;o++)s[t[o]]=h.css(e,t[o],!1,r);return s}return void 0!==n?h.style(e,t,n):h.css(e,t)},e,t,arguments.length>1)},show:function(){return $t(this,!0)},hide:function(){return $t(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){V(this)?h(this).show():h(this).hide()})}}),h.Tween=Gt,Gt.prototype={constructor:Gt,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(h.cssNumber[n]?"":"px")},cur:function(){var e=Gt.propHooks[this.prop];return e&&e.get?e.get(this):Gt.propHooks._default.get(this)},run:function(e){var t,n=Gt.propHooks[this.prop];return this.options.duration?this.pos=t=h.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Gt.propHooks._default.set(this),this}},Gt.prototype.init.prototype=Gt.prototype,Gt.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=h.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){h.fx.step[e.prop]?h.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[h.cssProps[e.prop]]||h.cssHooks[e.prop])?h.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Gt.propHooks.scrollTop=Gt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},h.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},h.fx=Gt.prototype.init,h.fx.step={};var Yt,Zt,en=/^(?:toggle|show|hide)$/,tn=new RegExp("^(?:([+-])=|)("+W+")([a-z%]*)$","i"),nn=/queueHooks$/,rn=[fn],sn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=tn.exec(t),s=i&&i[3]||(h.cssNumber[e]?"":"px"),o=(h.cssNumber[e]||"px"!==s&&+r)&&tn.exec(h.css(n.elem,e)),u=1,a=20;if(o&&o[3]!==s){s=s||o[3],i=i||[],o=+r||1;do u=u||".5",o/=u,h.style(n.elem,e,o+s);while(u!==(u=n.cur()/r)&&1!==u&&--a)}return i&&(o=n.start=+o||+r||0,n.unit=s,n.end=i[1]?o+(i[1]+1)*i[2]:+i[2]),n}]};h.Animation=h.extend(cn,{tweener:function(e,t){h.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,r=0,i=e.length;i>r;r++)n=e[r],sn[n]=sn[n]||[],sn[n].unshift(t)},prefilter:function(e,t){t?rn.unshift(e):rn.push(e)}}),h.speed=function(e,t,n){var r=e&&"object"==typeof e?h.extend({},e):{complete:n||!n&&t||h.isFunction(e)&&e,duration:e,easing:n&&t||t&&!h.isFunction(t)&&t};return r.duration=h.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in h.fx.speeds?h.fx.speeds[r.duration]:h.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){h.isFunction(r.old)&&r.old.call(this),r.queue&&h.dequeue(this,r.queue)},r},h.fn.extend({fadeTo:function(e,t,n,r){return this.filter(V).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=h.isEmptyObject(e),s=h.speed(t,n,r),o=function(){var t=cn(this,h.extend({},e),s);(i||h._data(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",s=h.timers,o=h._data(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&nn.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem!==this||null!=e&&s[i].queue!==e||(s[i].anim.stop(n),t=!1,s.splice(i,1));(t||!n)&&h.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=h._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=h.timers,o=r?r.length:0;for(n.finish=!0,h.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;o>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),h.each(["toggle","show","hide"],function(e,t){var n=h.fn[t];h.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(un(t,!0),e,r,i)}}),h.each({slideDown:un("show"),slideUp:un("hide"),slideToggle:un("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){h.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),h.timers=[],h.fx.tick=function(){var e,t=h.timers,n=0;for(Yt=h.now();n<t.length;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||h.fx.stop(),Yt=void 0},h.fx.timer=function(e){h.timers.push(e),e()?h.fx.start():h.timers.pop()},h.fx.interval=13,h.fx.start=function(){Zt||(Zt=setInterval(h.fx.tick,h.fx.interval))},h.fx.stop=function(){clearInterval(Zt),Zt=null},h.fx.speeds={slow:600,fast:200,_default:400},h.fn.delay=function(e,t){return e=h.fx?h.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},function(){var e,t,n,r,i;t=T.createElement("div"),t.setAttribute("className","t"),t.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",r=t.getElementsByTagName("a")[0],n=T.createElement("select"),i=n.appendChild(T.createElement("option")),e=t.getElementsByTagName("input")[0],r.style.cssText="top:1px",l.getSetAttribute="t"!==t.className,l.style=/top/.test(r.getAttribute("style")),l.hrefNormalized="/a"===r.getAttribute("href"),l.checkOn=!!e.value,l.optSelected=i.selected,l.enctype=!!T.createElement("form").enctype,n.disabled=!0,l.optDisabled=!i.disabled,e=T.createElement("input"),e.setAttribute("value",""),l.input=""===e.getAttribute("value"),e.value="t",e.setAttribute("type","radio"),l.radioValue="t"===e.value}();var hn=/\r/g;h.fn.extend({val:function(e){var t,n,r,i=this[0];if(arguments.length)return r=h.isFunction(e),this.each(function(n){var i;1===this.nodeType&&(i=r?e.call(this,n,h(this).val()):e,null==i?i="":"number"==typeof i?i+="":h.isArray(i)&&(i=h.map(i,function(e){return null==e?"":e+""})),t=h.valHooks[this.type]||h.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))});if(i)return t=h.valHooks[i.type]||h.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:(n=i.value,"string"==typeof n?n.replace(hn,""):null==n?"":n)}}),h.extend({valHooks:{option:{get:function(e){var t=h.find.attr(e,"value");return null!=t?t:h.trim(h.text(e))}},select:{get:function(e){for(var t,n,r=e.options,i=e.selectedIndex,s="select-one"===e.type||0>i,o=s?null:[],u=s?i+1:r.length,a=0>i?u:s?i:0;u>a;a++)if(n=r[a],!(!n.selected&&a!==i||(l.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&h.nodeName(n.parentNode,"optgroup"))){if(t=h(n).val(),s)return t;o.push(t)}return o},set:function(e,t){var n,r,i=e.options,s=h.makeArray(t),o=i.length;while(o--)if(r=i[o],h.inArray(h.valHooks.option.get(r),s)>=0)try{r.selected=n=!0}catch(u){r.scrollHeight}else r.selected=!1;return n||(e.selectedIndex=-1),i}}}}),h.each(["radio","checkbox"],function(){h.valHooks[this]={set:function(e,t){return h.isArray(t)?e.checked=h.inArray(h(e).val(),t)>=0:void 0}},l.checkOn||(h.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var pn,dn,vn=h.expr.attrHandle,mn=/^(?:checked|selected)$/i,gn=l.getSetAttribute,yn=l.input;h.fn.extend({attr:function(e,t){return $(this,h.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){h.removeAttr(this,e)})}}),h.extend({attr:function(e,t,n){var r,i,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return typeof e.getAttribute===B?h.prop(e,t,n):(1===s&&h.isXMLDoc(e)||(t=t.toLowerCase(),r=h.attrHooks[t]||(h.expr.match.bool.test(t)?dn:pn)),void 0===n?r&&"get"in r&&null!==(i=r.get(e,t))?i:(i=h.find.attr(e,t),null==i?void 0:i):null!==n?r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:(e.setAttribute(t,n+""),n):void h.removeAttr(e,t))},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(O);if(s&&1===e.nodeType)while(n=s[i++])r=h.propFix[n]||n,h.expr.match.bool.test(n)?yn&&gn||!mn.test(n)?e[r]=!1:e[h.camelCase("default-"+n)]=e[r]=!1:h.attr(e,n,""),e.removeAttribute(gn?n:r)},attrHooks:{type:{set:function(e,t){if(!l.radioValue&&"radio"===t&&h.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),dn={set:function(e,t,n){return t===!1?h.removeAttr(e,n):yn&&gn||!mn.test(n)?e.setAttribute(!gn&&h.propFix[n]||n,n):e[h.camelCase("default-"+n)]=e[n]=!0,n}},h.each(h.expr.match.bool.source.match(/\w+/g),function(e,t){var n=vn[t]||h.find.attr;vn[t]=yn&&gn||!mn.test(t)?function(e,t,r){var i,s;return r||(s=vn[t],vn[t]=i,i=null!=n(e,t,r)?t.toLowerCase():null,vn[t]=s),i}:function(e,t,n){return n?void 0:e[h.camelCase("default-"+t)]?t.toLowerCase():null}}),yn&&gn||(h.attrHooks.value={set:function(e,t,n){return h.nodeName(e,"input")?void(e.defaultValue=t):pn&&pn.set(e,t,n)}}),gn||(pn={set:function(e,t,n){var r=e.getAttributeNode(n);return r||e.setAttributeNode(r=e.ownerDocument.createAttribute(n)),r.value=t+="","value"===n||t===e.getAttribute(n)?t:void 0}},vn.id=vn.name=vn.coords=function(e,t,n){var r;return n?void 0:(r=e.getAttributeNode(t))&&""!==r.value?r.value:null},h.valHooks.button={get:function(e,t){var n=e.getAttributeNode(t);return n&&n.specified?n.value:void 0},set:pn.set},h.attrHooks.contenteditable={set:function(e,t,n){pn.set(e,""===t?!1:t,n)}},h.each(["width","height"],function(e,t){h.attrHooks[t]={set:function(e,n){return""===n?(e.setAttribute(t,"auto"),n):void 0}}})),l.style||(h.attrHooks.style={get:function(e){return e.style.cssText||void 0},set:function(e,t){return e.style.cssText=t+""}});var bn=/^(?:input|select|textarea|button|object)$/i,wn=/^(?:a|area)$/i;h.fn.extend({prop:function(e,t){return $(this,h.prop,e,t,arguments.length>1)},removeProp:function(e){return e=h.propFix[e]||e,this.each(function(){try{this[e]=void 0,delete this[e]}catch(t){}})}}),h.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,s,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return s=1!==o||!h.isXMLDoc(e),s&&(t=h.propFix[t]||t,i=h.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=h.find.attr(e,"tabindex");return t?parseInt(t,10):bn.test(e.nodeName)||wn.test(e.nodeName)&&e.href?0:-1}}}}),l.hrefNormalized||h.each(["href","src"],function(e,t){h.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),l.optSelected||(h.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),h.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){h.propFix[this.toLowerCase()]=this}),l.enctype||(h.propFix.enctype="encoding");var En=/[\t\r\n\f]/g;h.fn.extend({addClass:function(e){var t,n,r,i,s,o,u=0,a=this.length,f="string"==typeof e&&e;if(h.isFunction(e))return this.each(function(t){h(this).addClass(e.call(this,t,this.className))});if(f)for(t=(e||"").match(O)||[];a>u;u++)if(n=this[u],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(En," "):" ")){s=0;while(i=t[s++])r.indexOf(" "+i+" ")<0&&(r+=i+" ");o=h.trim(r),n.className!==o&&(n.className=o)}return this},removeClass:function(e){var t,n,r,i,s,o,u=0,a=this.length,f=0===arguments.length||"string"==typeof e&&e;if(h.isFunction(e))return this.each(function(t){h(this).removeClass(e.call(this,t,this.className))});if(f)for(t=(e||"").match(O)||[];a>u;u++)if(n=this[u],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(En," "):"")){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");o=e?h.trim(r):"",n.className!==o&&(n.className=o)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):this.each(h.isFunction(e)?function(n){h(this).toggleClass(e.call(this,n,this.className,t),t)}:function(){if("string"===n){var t,r=0,i=h(this),s=e.match(O)||[];while(t=s[r++])i.hasClass(t)?i.removeClass(t):i.addClass(t)}else(n===B||"boolean"===n)&&(this.className&&h._data(this,"__className__",this.className),this.className=this.className||e===!1?"":h._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,r=this.length;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(En," ").indexOf(t)>=0)return!0;return!1}}),h.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){h.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),h.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var Sn=h.now(),xn=/\?/,Tn=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;h.parseJSON=function(t){if(e.JSON&&e.JSON.parse)return e.JSON.parse(t+"");var n,r=null,i=h.trim(t+"");return i&&!h.trim(i.replace(Tn,function(e,t,i,s){return n&&t&&(r=0),0===r?e:(n=i||t,r+=!s-!i,"")}))?Function("return "+i)():h.error("Invalid JSON: "+t)},h.parseXML=function(t){var n,r;if(!t||"string"!=typeof t)return null;try{e.DOMParser?(r=new DOMParser,n=r.parseFromString(t,"text/xml")):(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(t))}catch(i){n=void 0}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||h.error("Invalid XML: "+t),n};var Nn,Cn,kn=/#.*$/,Ln=/([?&])_=[^&]*/,An=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,On=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Mn=/^(?:GET|HEAD)$/,_n=/^\/\//,Dn=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Pn={},Hn={},Bn="*/".concat("*");try{Cn=location.href}catch(jn){Cn=T.createElement("a"),Cn.href="",Cn=Cn.href}Nn=Dn.exec(Cn.toLowerCase())||[],h.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Cn,type:"GET",isLocal:On.test(Nn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Bn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":h.parseJSON,"text xml":h.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?qn(qn(e,h.ajaxSettings),t):qn(h.ajaxSettings,e)},ajaxPrefilter:Fn(Pn),ajaxTransport:Fn(Hn),ajax:function(e,t){function x(e,t,n,r){var f,g,y,w,S,x=t;2!==b&&(b=2,o&&clearTimeout(o),a=void 0,s=r||"",E.readyState=e>0?4:0,f=e>=200&&300>e||304===e,n&&(w=Rn(l,E,n)),w=Un(l,w,E,f),f?(l.ifModified&&(S=E.getResponseHeader("Last-Modified"),S&&(h.lastModified[i]=S),S=E.getResponseHeader("etag"),S&&(h.etag[i]=S)),204===e||"HEAD"===l.type?x="nocontent":304===e?x="notmodified":(x=w.state,g=w.data,y=w.error,f=!y)):(y=x,(e||!x)&&(x="error",0>e&&(e=0))),E.status=e,E.statusText=(t||x)+"",f?d.resolveWith(c,[g,x,E]):d.rejectWith(c,[E,x,y]),E.statusCode(m),m=void 0,u&&p.trigger(f?"ajaxSuccess":"ajaxError",[E,l,f?g:y]),v.fireWith(c,[E,x]),u&&(p.trigger("ajaxComplete",[E,l]),--h.active||h.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,r,i,s,o,u,a,f,l=h.ajaxSetup({},t),c=l.context||l,p=l.context&&(c.nodeType||c.jquery)?h(c):h.event,d=h.Deferred(),v=h.Callbacks("once memory"),m=l.statusCode||{},g={},y={},b=0,w="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!f){f={};while(t=An.exec(s))f[t[1].toLowerCase()]=t[2]}t=f[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?s:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return b||(e=y[n]=y[n]||e,g[e]=t),this},overrideMimeType:function(e){return b||(l.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>b)for(t in e)m[t]=[m[t],e[t]];else E.always(e[E.status]);return this},abort:function(e){var t=e||w;return a&&a.abort(t),x(0,t),this}};if(d.promise(E).complete=v.add,E.success=E.done,E.error=E.fail,l.url=((e||l.url||Cn)+"").replace(kn,"").replace(_n,Nn[1]+"//"),l.type=t.method||t.type||l.method||l.type,l.dataTypes=h.trim(l.dataType||"*").toLowerCase().match(O)||[""],null==l.crossDomain&&(n=Dn.exec(l.url.toLowerCase()),l.crossDomain=!(!n||n[1]===Nn[1]&&n[2]===Nn[2]&&(n[3]||("http:"===n[1]?"80":"443"))===(Nn[3]||("http:"===Nn[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=h.param(l.data,l.traditional)),In(Pn,l,t,E),2===b)return E;u=h.event&&l.global,u&&0===h.active++&&h.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!Mn.test(l.type),i=l.url,l.hasContent||(l.data&&(i=l.url+=(xn.test(i)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=Ln.test(i)?i.replace(Ln,"$1_="+Sn++):i+(xn.test(i)?"&":"?")+"_="+Sn++)),l.ifModified&&(h.lastModified[i]&&E.setRequestHeader("If-Modified-Since",h.lastModified[i]),h.etag[i]&&E.setRequestHeader("If-None-Match",h.etag[i])),(l.data&&l.hasContent&&l.contentType!==!1||t.contentType)&&E.setRequestHeader("Content-Type",l.contentType),E.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+Bn+"; q=0.01":""):l.accepts["*"]);for(r in l.headers)E.setRequestHeader(r,l.headers[r]);if(!l.beforeSend||l.beforeSend.call(c,E,l)!==!1&&2!==b){w="abort";for(r in{success:1,error:1,complete:1})E[r](l[r]);if(a=In(Hn,l,t,E)){E.readyState=1,u&&p.trigger("ajaxSend",[E,l]),l.async&&l.timeout>0&&(o=setTimeout(function(){E.abort("timeout")},l.timeout));try{b=1,a.send(g,x)}catch(S){if(!(2>b))throw S;x(-1,S)}}else x(-1,"No Transport");return E}return E.abort()},getJSON:function(e,t,n){return h.get(e,t,n,"json")},getScript:function(e,t){return h.get(e,void 0,t,"script")}}),h.each(["get","post"],function(e,t){h[t]=function(e,n,r,i){return h.isFunction(n)&&(i=i||r,r=n,n=void 0),h.ajax({url:e,type:t,dataType:i,data:n,success:r})}}),h._evalUrl=function(e){return h.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},h.fn.extend({wrapAll:function(e){if(h.isFunction(e))return this.each(function(t){h(this).wrapAll(e.call(this,t))});if(this[0]){var t=h(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&1===e.firstChild.nodeType)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return this.each(h.isFunction(e)?function(t){h(this).wrapInner(e.call(this,t))}:function(){var t=h(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=h.isFunction(e);return this.each(function(n){h(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){h.nodeName(this,"body")||h(this).replaceWith(this.childNodes)}).end()}}),h.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!l.reliableHiddenOffsets()&&"none"===(e.style&&e.style.display||h.css(e,"display"))},h.expr.filters.visible=function(e){return!h.expr.filters.hidden(e)};var zn=/%20/g,Wn=/\[\]$/,Xn=/\r?\n/g,Vn=/^(?:submit|button|image|reset|file)$/i,$n=/^(?:input|select|textarea|keygen)/i;h.param=function(e,t){var n,r=[],i=function(e,t){t=h.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=h.ajaxSettings&&h.ajaxSettings.traditional),h.isArray(e)||e.jquery&&!h.isPlainObject(e))h.each(e,function(){i(this.name,this.value)});else for(n in e)Jn(n,e[n],t,i);return r.join("&").replace(zn,"+")},h.fn.extend({serialize:function(){return h.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=h.prop(this,"elements");return e?h.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!h(this).is(":disabled")&&$n.test(this.nodeName)&&!Vn.test(e)&&(this.checked||!J.test(e))}).map(function(e,t){var n=h(this).val();return null==n?null:h.isArray(n)?h.map(n,function(e){return{name:t.name,value:e.replace(Xn,"\r\n")}}):{name:t.name,value:n.replace(Xn,"\r\n")}}).get()}}),h.ajaxSettings.xhr=void 0!==e.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&Yn()||Zn()}:Yn;var Kn=0,Qn={},Gn=h.ajaxSettings.xhr();e.attachEvent&&e.attachEvent("onunload",function(){for(var e in Qn)Qn[e](void 0,!0)}),l.cors=!!Gn&&"withCredentials"in Gn,Gn=l.ajax=!!Gn,Gn&&h.ajaxTransport(function(e){if(!e.crossDomain||l.cors){var t;return{send:function(n,r){var i,s=e.xhr(),o=++Kn;if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(i in e.xhrFields)s[i]=e.xhrFields[i];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(i in n)void 0!==n[i]&&s.setRequestHeader(i,n[i]+"");s.send(e.hasContent&&e.data||null),t=function(n,i){var u,a,f;if(t&&(i||4===s.readyState))if(delete Qn[o],t=void 0,s.onreadystatechange=h.noop,i)4!==s.readyState&&s.abort();else{f={},u=s.status,"string"==typeof s.responseText&&(f.text=s.responseText);try{a=s.statusText}catch(l){a=""}u||!e.isLocal||e.crossDomain?1223===u&&(u=204):u=f.text?200:404}f&&r(u,a,f,s.getAllResponseHeaders())},e.async?4===s.readyState?setTimeout(t):s.onreadystatechange=Qn[o]=t:t()},abort:function(){t&&t(void 0,!0)}}}}),h.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return h.globalEval(e),e}}}),h.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),h.ajaxTransport("script",function(e){if(e.crossDomain){var t,n=T.head||h("head")[0]||T.documentElement;return{send:function(r,i){t=T.createElement("script"),t.async=!0,e.scriptCharset&&(t.charset=e.scriptCharset),t.src=e.url,t.onload=t.onreadystatechange=function(e,n){(n||!t.readyState||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),t=null,n||i(200,"success"))},n.insertBefore(t,n.firstChild)},abort:function(){t&&t.onload(void 0,!0)}}}});var er=[],tr=/(=)\?(?=&|$)|\?\?/;h.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=er.pop()||h.expando+"_"+Sn++;return this[e]=!0,e}}),h.ajaxPrefilter("json jsonp",function(t,n,r){var i,s,o,u=t.jsonp!==!1&&(tr.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&tr.test(t.data)&&"data");return u||"jsonp"===t.dataTypes[0]?(i=t.jsonpCallback=h.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,u?t[u]=t[u].replace(tr,"$1"+i):t.jsonp!==!1&&(t.url+=(xn.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return o||h.error(i+" was not called"),o[0]},t.dataTypes[0]="json",s=e[i],e[i]=function(){o=arguments},r.always(function(){e[i]=s,t[i]&&(t.jsonpCallback=n.jsonpCallback,er.push(i)),o&&h.isFunction(s)&&s(o[0]),o=s=void 0}),"script"):void 0}),h.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||T;var r=w.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=h.buildFragment([e],t,i),i&&i.length&&h(i).remove(),h.merge([],r.childNodes))};var nr=h.fn.load;h.fn.load=function(e,t,n){if("string"!=typeof e&&nr)return nr.apply(this,arguments);var r,i,s,o=this,u=e.indexOf(" ");return u>=0&&(r=h.trim(e.slice(u,e.length)),e=e.slice(0,u)),h.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(s="POST"),o.length>0&&h.ajax({url:e,type:s,dataType:"html",data:t}).done(function(e){i=arguments,o.html(r?h("<div>").append(h.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){o.each(n,i||[e.responseText,t,e])}),this},h.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){h.fn[t]=function(e){return this.on(t,e)}}),h.expr.filters.animated=function(e){return h.grep(h.timers,function(t){return e===t.elem}).length};var rr=e.document.documentElement;h.offset={setOffset:function(e,t,n){var r,i,s,o,u,a,f,l=h.css(e,"position"),c=h(e),p={};"static"===l&&(e.style.position="relative"),u=c.offset(),s=h.css(e,"top"),a=h.css(e,"left"),f=("absolute"===l||"fixed"===l)&&h.inArray("auto",[s,a])>-1,f?(r=c.position(),o=r.top,i=r.left):(o=parseFloat(s)||0,i=parseFloat(a)||0),h.isFunction(t)&&(t=t.call(e,n,u)),null!=t.top&&(p.top=t.top-u.top+o),null!=t.left&&(p.left=t.left-u.left+i),"using"in t?t.using.call(e,p):c.css(p)}},h.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){h.offset.setOffset(this,e,t)});var t,n,r={top:0,left:0},i=this[0],s=i&&i.ownerDocument;if(s)return t=s.documentElement,h.contains(t,i)?(typeof i.getBoundingClientRect!==B&&(r=i.getBoundingClientRect()),n=ir(s),{top:r.top+(n.pageYOffset||t.scrollTop)-(t.clientTop||0),left:r.left+(n.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}):r},position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return"fixed"===h.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),h.nodeName(e[0],"html")||(n=e.offset()),n.top+=h.css(e[0],"borderTopWidth",!0),n.left+=h.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-h.css(r,"marginTop",!0),left:t.left-n.left-h.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||rr;while(e&&!h.nodeName(e,"html")&&"static"===h.css(e,"position"))e=e.offsetParent;return e||rr})}}),h.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n=/Y/.test(t);h.fn[e]=function(r){return $(this,function(e,r,i){var s=ir(e);return void 0===i?s?t in s?s[t]:s.document.documentElement[r]:e[r]:void(s?s.scrollTo(n?h(s).scrollLeft():i,n?i:h(s).scrollTop()):e[r]=i)},e,r,arguments.length,null)}}),h.each(["top","left"],function(e,t){h.cssHooks[t]=jt(l.pixelPosition,function(e,n){return n?(n=Ht(e,t),Dt.test(n)?h(e).position()[t]+"px":n):void 0})}),h.each({Height:"height",Width:"width"},function(e,t){h.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){h.fn[r]=function(r,i){var s=arguments.length&&(n||"boolean"!=typeof r),o=n||(r===!0||i===!0?"margin":"border");return $(this,function(t,n,r){var i;return h.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):void 0===r?h.css(t,n,o):h.style(t,n,r,o)},t,s?r:void 0,s,null)}})}),h.fn.size=function(){return this.length},h.fn.andSelf=h.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return h});var sr=e.jQuery,or=e.$;return h.noConflict=function(t){return e.$===h&&(e.$=or),t&&e.jQuery===h&&(e.jQuery=sr),h},typeof t===B&&(e.jQuery=e.$=h),h}),function(e,t,n){function i(n){var i=t.console;r[n]||(r[n]=!0,e.migrateWarnings.push(n),i&&i.warn&&!e.migrateMute&&(i.warn("JQMIGRATE: "+n),e.migrateTrace&&i.trace&&i.trace()))}function s(t,n,r,s){if(Object.defineProperty)try{Object.defineProperty(t,n,{configurable:!0,enumerable:!0,get:function(){return i(s),r},set:function(e){i(s),r=e}});return}catch(o){}e._definePropertyBroken=!0,t[n]=r}var r={};e.migrateWarnings=[],!e.migrateMute&&t.console&&t.console.log&&t.console.log("JQMIGRATE: Logging is active"),e.migrateTrace===n&&(e.migrateTrace=!0),e.migrateReset=function(){r={},e.migrateWarnings.length=0},document.compatMode==="BackCompat"&&i("jQuery is not compatible with Quirks Mode");var o=e("<input/>",{size:1}).attr("size")&&e.attrFn,u=e.attr,a=e.attrHooks.value&&e.attrHooks.value.get||function(){return null},f=e.attrHooks.value&&e.attrHooks.value.set||function(){return n},l=/^(?:input|button)$/i,c=/^[238]$/,h=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,p=/^(?:checked|selected)$/i;s(e,"attrFn",o||{},"jQuery.attrFn is deprecated"),e.attr=function(t,r,s,a){var f=r.toLowerCase(),d=t&&t.nodeType;if(a){u.length<4&&i("jQuery.fn.attr( props, pass ) is deprecated");if(t&&!c.test(d)&&(o?r in o:e.isFunction(e.fn[r])))return e(t)[r](s)}return r==="type"&&s!==n&&l.test(t.nodeName)&&t.parentNode&&i("Can't change the 'type' of an input or button in IE 6/7/8"),!e.attrHooks[f]&&h.test(f)&&(e.attrHooks[f]={get:function(t,r){var i,s=e.prop(t,r);return s===!0||typeof s!="boolean"&&(i=t.getAttributeNode(r))&&i.nodeValue!==!1?r.toLowerCase():n},set:function(t,n,r){var i;return n===!1?e.removeAttr(t,r):(i=e.propFix[r]||r,i in t&&(t[i]=!0),t.setAttribute(r,r.toLowerCase())),r}},p.test(f)&&i("jQuery.fn.attr('"+f+"') may use property instead of attribute")),u.call(e,t,r,s)},e.attrHooks.value={get:function(e,t){var n=(e.nodeName||"").toLowerCase();return n==="button"?a.apply(this,arguments):(n!=="input"&&n!=="option"&&i("jQuery.fn.attr('value') no longer gets properties"),t in e?e.value:null)},set:function(e,t){var n=(e.nodeName||"").toLowerCase();if(n==="button")return f.apply(this,arguments);n!=="input"&&n!=="option"&&i("jQuery.fn.attr('value', val) no longer sets properties"),e.value=t}};var d,v,m=e.fn.init,g=e.parseJSON,y=/^([^<]*)(<[\w\W]+>)([^>]*)$/;e.fn.init=function(t,n,r){var s;if(t&&typeof t=="string"&&!e.isPlainObject(n)&&(s=y.exec(e.trim(t)))&&s[0]){t.charAt(0)!=="<"&&i("$(html) HTML strings must start with '<' character"),s[3]&&i("$(html) HTML text after last tag is ignored"),s[0].charAt(0)==="#"&&(i("HTML string cannot start with a '#' character"),e.error("JQMIGRATE: Invalid selector string (XSS)")),n&&n.context&&(n=n.context);if(e.parseHTML)return m.call(this,e.parseHTML(s[2],n,!0),n,r)}return m.apply(this,arguments)},e.fn.init.prototype=e.fn,e.parseJSON=function(e){return!e&&e!==null?(i("jQuery.parseJSON requires a valid JSON string"),null):g.apply(this,arguments)},e.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e.browser||(d=e.uaMatch(navigator.userAgent),v={},d.browser&&(v[d.browser]=!0,v.version=d.version),v.chrome?v.webkit=!0:v.webkit&&(v.safari=!0),e.browser=v),s(e,"browser",e.browser,"jQuery.browser is deprecated"),e.sub=function(){function t(e,n){return new t.fn.init(e,n)}e.extend(!0,t,this),t.superclass=this,t.fn=t.prototype=this(),t.fn.constructor=t,t.sub=this.sub,t.fn.init=function(i,s){return s&&s instanceof e&&!(s instanceof t)&&(s=t(s)),e.fn.init.call(this,i,s,n)},t.fn.init.prototype=t.fn;var n=t(document);return i("jQuery.sub() is deprecated"),t},e.ajaxSetup({converters:{"text json":e.parseJSON}});var b=e.fn.data;e.fn.data=function(t){var r,s,o=this[0];if(o&&t==="events"&&arguments.length===1){r=e.data(o,t),s=e._data(o,t);if((r===n||r===s)&&s!==n)return i("Use of jQuery.fn.data('events') is deprecated"),s}return b.apply(this,arguments)};var w=/\/(java|ecma)script/i,E=e.fn.andSelf||e.fn.addBack;e.fn.andSelf=function(){return i("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()"),E.apply(this,arguments)},e.clean||(e.clean=function(t,n,r,s){n=n||document,n=!n.nodeType&&n[0]||n,n=n.ownerDocument||n,i("jQuery.clean() is deprecated");var o,u,a,f,l=[];e.merge(l,e.buildFragment(t,n).childNodes);if(r){a=function(e){if(!e.type||w.test(e.type))return s?s.push(e.parentNode?e.parentNode.removeChild(e):e):r.appendChild(e)};for(o=0;(u=l[o])!=null;o++)if(!e.nodeName(u,"script")||!a(u))r.appendChild(u),typeof u.getElementsByTagName!="undefined"&&(f=e.grep(e.merge([],u.getElementsByTagName("script")),a),l.splice.apply(l,[o+1,0].concat(f)),o+=f.length)}return l});var S=e.event.add,x=e.event.remove,T=e.event.trigger,N=e.fn.toggle,C=e.fn.live,k=e.fn.die,L="ajaxStart|ajaxStop|ajaxSend|ajaxComplete|ajaxError|ajaxSuccess",A=new RegExp("\\b(?:"+L+")\\b"),O=/(?:^|\s)hover(\.\S+|)\b/,M=function(t){return typeof t!="string"||e.event.special.hover?t:(O.test(t)&&i("'hover' pseudo-event is deprecated, use 'mouseenter mouseleave'"),t&&t.replace(O,"mouseenter$1 mouseleave$1"))};e.event.props&&e.event.props[0]!=="attrChange"&&e.event.props.unshift("attrChange","attrName","relatedNode","srcElement"),e.event.dispatch&&s(e.event,"handle",e.event.dispatch,"jQuery.event.handle is undocumented and deprecated"),e.event.add=function(e,t,n,r,s){e!==document&&A.test(t)&&i("AJAX events should be attached to document: "+t),S.call(this,e,M(t||""),n,r,s)},e.event.remove=function(e,t,n,r,i){x.call(this,e,M(t)||"",n,r,i)},e.fn.error=function(){var e=Array.prototype.slice.call(arguments,0);return i("jQuery.fn.error() is deprecated"),e.splice(0,0,"error"),arguments.length?this.bind.apply(this,e):(this.triggerHandler.apply(this,e),this)},e.fn.toggle=function(t,n){if(!e.isFunction(t)||!e.isFunction(n))return N.apply(this,arguments);i("jQuery.fn.toggle(handler, handler...) is deprecated");var r=arguments,s=t.guid||e.guid++,o=0,u=function(n){var i=(e._data(this,"lastToggle"+t.guid)||0)%o;return e._data(this,"lastToggle"+t.guid,i+1),n.preventDefault(),r[i].apply(this,arguments)||!1};u.guid=s;while(o<r.length)r[o++].guid=s;return this.click(u)},e.fn.live=function(t,n,r){return i("jQuery.fn.live() is deprecated"),C?C.apply(this,arguments):(e(this.context).on(t,this.selector,n,r),this)},e.fn.die=function(t,n){return i("jQuery.fn.die() is deprecated"),k?k.apply(this,arguments):(e(this.context).off(t,this.selector||"**",n),this)},e.event.trigger=function(e,t,n,r){return!n&&!A.test(e)&&i("Global events are undocumented and deprecated"),T.call(this,e,t,n||document,r)},e.each(L.split("|"),function(t,n){e.event.special[n]={setup:function(){var t=this;return t!==document&&(e.event.add(document,n+"."+e.guid,function(){e.event.trigger(n,null,t,!0)}),e._data(this,n,e.guid++)),!1},teardown:function(){return this!==document&&e.event.remove(document,n+"."+e._data(this,n)),!1}}})}(jQuery,window);var JSON;JSON||(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}();var Base=function(){};Base.extend=function(e,t){var n=Base.prototype.extend;Base._prototyping=!0;var r=new this;n.call(r,e),r.base=function(){},delete Base._prototyping;var i=r.constructor,s=r.constructor=function(){if(!Base._prototyping)if(this._constructing||this.constructor==s)this._constructing=!0,i.apply(this,arguments),delete this._constructing;else if(arguments[0]!=null)return(arguments[0].extend||n).call(arguments[0],r)};return s.ancestor=this,s.extend=this.extend,s.forEach=this.forEach,s.implement=this.implement,s.prototype=r,s.toString=this.toString,s.valueOf=function(e){return e=="object"?s:i.valueOf()},n.call(s,t),typeof s.init=="function"&&s.init(),s},Base.prototype={extend:function(e,t){if(arguments.length>1){var n=this[e];if(n&&typeof t=="function"&&(!n.valueOf||n.valueOf()!=t.valueOf())&&/\bbase\b/.test(t)){var r=t.valueOf();t=function(){var e=this.base||Base.prototype.base;this.base=n;var t=r.apply(this,arguments);return this.base=e,t},t.valueOf=function(e){return e=="object"?t:r},t.toString=Base.toString}this[e]=t}else if(e){var i=Base.prototype.extend;!Base._prototyping&&typeof this!="function"&&(i=this.extend||i);var s={toSource:null},o=["constructor","toString","valueOf"],u=Base._prototyping?0:1;while(a=o[u++])e[a]!=s[a]&&i.call(this,a,e[a]);for(var a in e)s[a]||i.call(this,a,e[a])}return this}},Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(e,t,n){for(var r in e)this.prototype[r]===undefined&&t.call(n,e[r],r,e)},implement:function(){for(var e=0;e<arguments.length;e++)typeof arguments[e]=="function"?arguments[e](this.prototype):this.prototype.extend(arguments[e]);return this},toString:function(){return String(this.valueOf())}}),function(e){function t(t){if(e("#"+e.facebox.settings.id+".facebox").length>0)return!0;e(document).trigger("init.facebox"),i();var n=e.facebox.settings.imageTypes.join("|");e.facebox.settings.imageTypesRegexp=new RegExp("."+n+"$","i"),t&&e.extend(e.facebox.settings,t),e("body").append(e(e.facebox.settings.faceboxHtml).attr("id",e.facebox.settings.id));var r=[new Image,new Image];r[0].src=e.facebox.settings.closeImage,r[1].src=e.facebox.settings.loadingImage,e("#"+e.facebox.settings.id+"").find(".b:first, .bl, .br, .tl, .tr").each(function(){r.push(new Image),r.slice(-1).src=e(this).css("background-image").replace(/url\((.+)\)/,"$1")}),e("#"+e.facebox.settings.id+" .close").click(e.facebox.close),e("#"+e.facebox.settings.id+" .close_image").attr("src",e.facebox.settings.closeImage)}function n(){var e,t;return self.pageYOffset?(t=self.pageYOffset,e=self.pageXOffset):document.documentElement&&document.documentElement.scrollTop?(t=document.documentElement.scrollTop,e=document.documentElement.scrollLeft):document.body&&(t=document.body.scrollTop,e=document.body.scrollLeft),new Array(e,t)}function r(){var e;return self.innerHeight?e=self.innerHeight:document.documentElement&&document.documentElement.clientHeight?e=document.documentElement.clientHeight:document.body&&(e=document.body.clientHeight),e}function i(){var t=e.facebox.settings;t.loadingImage=t.loading_image||t.loadingImage,t.closeImage=t.close_image||t.closeImage,t.imageTypes=t.image_types||t.imageTypes,t.faceboxHtml=t.facebox_html||t.faceboxHtml}function s(t,n){if(t.match(/#/)){var r=window.location.href.split("#")[0],i=t.replace(r,"");e.facebox.reveal(e(i).clone().show(),n)}else t.match(e.facebox.settings.imageTypesRegexp)?o(t,n):u(t,n)}function o(t,n){var r=new Image;r.onload=function(){e.facebox.reveal('<div class="image"><img src="'+r.src+'" /></div>',n)},r.src=t}function u(t,n){e.get(t,function(t){e.facebox.reveal(t,n)})}function a(){return e.facebox.settings.overlay==0||e.facebox.settings.opacity===null}function f(){if(a())return;e("body").addClass("overlay-visible"),e("#"+e.facebox.settings.id+"_overlay.facebox_overlay").length==0&&e("body").append('<div id="'+e.facebox.settings.id+'_overlay" class="facebox_overlay facebox_hide"></div>');var t=e.facebox.settings.id,n=e.facebox.settings.ziBase-1+(e(".facebox").length*2+e(".facebox_overlay:visible").length*2);return e("#"+t+"_overlay.facebox_overlay").attr("rel",t).hide().addClass("facebox_overlayBG").css("opacity",e.facebox.settings.opacity).css("z-index",n).click(function(){}).show(),!1}function l(t){if(a())return;var n,r;return t!=r?n=e("#"+t+"_overlay.facebox_overlay"):n=e("#facebox_overlay"),n.hide().removeClass("facebox_overlayBG").addClass("facebox_hide").remove(),e(".facebox_overlay").length==0&&e("body").removeClass("overlay-visible"),!1}e.facebox=function(t,n,r){var i;return r==i&&(ts=new Date,ts=ts.getTime(),r="facebox"+ts),e.facebox.settings.id=r,e.facebox.loading(),t.ajax?u(t.ajax):t.image?o(t.image):t.div?s(t.div):e.isFunction(t)?t.call(e):e.facebox.reveal(t,n),r},e.extend(e.facebox,{settings:{opacity:.8,overlay:!0,id:"facebox",loadingImage:"",closeImage:"",imageTypes:["png","jpg","jpeg","gif"],ziBase:100,faceboxHtml:'    <div class="facebox" style="display:none;">       <div class="facebox-popup">         <table>           <tbody>             <tr>               <td class="tl"/><td class="b"/><td class="tr"/>             </tr>             <tr>               <td class="b"/>               <td class="body">                 <div class="footer">                   <a href="#" class="close">                     <img src="" title="close" class="close_image" style="display:none;" />                     <div class="close_image_div"></div>                   </a>                 </div>                 <div class="content">                 </div>               </td>               <td class="b"/>             </tr>             <tr>               <td class="bl"/><td class="b"/><td class="br"/>             </tr>           </tbody>         </table>       </div>     </div>'},loading:function(){t();if(e("#"+e.facebox.settings.id+" .loading").length==1)return!0;f(),e("#"+e.facebox.settings.id+" .content").empty(),e("#"+e.facebox.settings.id+" .body").children().hide().end().append('<div class="loading"></div>'),e("#"+e.facebox.settings.id+"").css({top:(n()[1]+r()/10)/4,left:385.5}).show(),e(document).bind("keydown.facebox",function(t){return t.keyCode==27&&e.facebox.close(),!0}),e(document).trigger("loading.facebox",e.facebox.settings.id)},reveal:function(t,n){e(document).trigger("beforeReveal.facebox"),n&&e("#"+e.facebox.settings.id+" .content").addClass(n),e("#"+e.facebox.settings.id+" .content").append(t),e("#"+e.facebox.settings.id+" .loading").remove(),e("#"+e.facebox.settings.id+" .body").children().fadeIn(0);var r=e.facebox.settings.ziBase+(e(".facebox").length*2+e(".facebox:visible").length*2);e("#"+e.facebox.settings.id+"").css("z-index",r);var i=function(){e("#"+e.facebox.settings.id+"").css("left",e(window).width()/2-e("#"+e.facebox.settings.id+" table").width()/2-10)};i(),e(window).bind("resize",i),e(document).trigger("reveal.facebox").trigger("afterReveal.facebox")},close:function(){return e(document).trigger("close.facebox",e.facebox.settings.id),!1}}),e.fn.facebox=function(n){function r(){e.facebox.loading(!0);var t=this.rel.match(/facebox\[?\.(\w+)\]?/);return t&&(t=t[1]),s(this.href,t),!1}return t(n),this.click(r)},e(document).bind("close.facebox",function(t,n){e(document).unbind("keydown.facebox");var r,i=n==r?e(".facebox"):e("#"+n);i.fadeOut(0,function(){i.find(".content").removeClass().addClass("content"),l(n),i.find(".loading").remove()})})}(jQuery),window&&typeof window.console=="undefined"&&(window.console={}),window.console&&(typeof window.console.log=="function"&&(window.orig_log=window.console.log),window.console.log2=function(){typeof window.sds_debug_log=="undefined"&&(window.sds_debug_log=[]),window.sds_debug_log.push("<li>"),window.sds_debug_log.push('<span class="timestamp">'+(new Date).toTimeString()+"</span>");for(var e=0,t=arguments.length,n=arguments;e<t;++e)window.sds_debug_log.push("<span>"),window.sds_debug_log.push(n[e]),window.sds_debug_log.push("</span>");window.sds_debug_log.push("</li>"),window.orig_log&&window.orig_log.apply(this,arguments)},window.console.log=function(){});var SDS_Utility_registerNamespace=function(e){if(!/^[_A-Za-z]\w*(\.[_A-Za-z]\w*)*$/.test(e))throw"Malformed namespace.";if(typeof Type=="undefined"||Type==null||typeof Type.registerNamespace!="function"){var t=e.split("."),n=window;for(var r=0;r<t.length;r++){var i=t[r],s=n[i];if(typeof s=="undefined"||s===null)s={},n[i]=s;n=s}}else Type.registerNamespace(e)};SDS_Utility_registerNamespace("SDS.Utility"),SDS.Utility.registerNamespace=SDS_Utility_registerNamespace,delete SDS_Utility_registerNamespace,SDS.Utility.registerNamespace("SDS.Utility.Misc"),SDS.Utility.Misc.bind=function(e,t){return function(){var n=e.apply(t,arguments);return typeof n=="undefined"?!1:n}},Function.prototype.bind=Function.prototype.bind||function(e){return SDS.Utility.Misc.bind(this,e)},Function.prototype.delay=function(e,t,n){jQuery.isArray(t)||(n=t,t=[]);var r=this,i=function(){var e=r.apply(n,t);return typeof e=="undefined"?!1:e};return window.setTimeout(i.bind(this),e)},Function.prototype.interval=function(e,t,n,r){jQuery.isArray(n)||(r=n,n=[]);var i={intervalId:null,fn:null},s=function(){var e=jQuery.isFunction(t)?t.call(r,[]):t!==!1;if(!e)return window.clearInterval(i.intervalId),!1;var s=this,o=s.call(r,n);return typeof o=="undefined"?!1:o};return i.intervalId=window.setInterval(s.bind(this),e),i},SDS.Utility.Misc.toQueryString=function(e){if(typeof e=="undefined"||e==null||typeof e=="string"||parseFloat(e)===e)return"";var t=[];return SDS.Utility.Misc.toQueryStringImpl(e,"",t),t.join("&").split("%20").join("+")},SDS.Utility.Misc.toQueryStringImpl=function(e,t,n){if(typeof e=="string"||parseFloat(e)===e)n.push(encodeURIComponent(t)+"="+encodeURIComponent(e));else if(SDS.Utility.Misc.isArray(e))for(var r=0;r<e.length;r++)SDS.Utility.Misc.toQueryStringImpl(e[r],t+"."+(1+r),n);else for(var i in e){var s=e[i];if(s!==null&&s!==undefined&&typeof s!="function"){var o=t?t+"."+i:i;SDS.Utility.Misc.toQueryStringImpl(s,o,n)}}},SDS.Utility.Misc.isArray=function(e){if(!(typeof e.length!="undefined"&&parseInt(e.length)==e.length&&e.length>=0))return!1;if(e.length==0)return!0;try{var t=e[e.length-1];return!0}catch(n){return!1}},SDS.Utility.Misc.uniqueIdentifier=function(){var e=++SDS.Utility.Misc.uniqueIdentifier.value;return""+e+"-"+(new Date).getTime()},SDS.Utility.Misc.uniqueIdentifier.value=0,SDS.Utility.Misc.encodeHtml=function(e,t){if(typeof e=="undefined"||e==null)return null;if(!e.replace)return e;if(!t)return e.replace(/</g,"&lt;").replace(/>/g,"&gt;");var n="sds-utility-misc-escape-html-container",r=SDS.Utility.Misc.encodeHtml;r.valueContainer||(r.valueContainer=jQuery("head").append('<span class="'+n+'"></span>').children(":last"));var i=r.valueContainer.text(e).html();return r.valueContainer.text(""),i.split('"').join("&quot;").split("'").join("&#39;")},Array.prototype.remove=function(e,t){var n=this.slice((t||e)+1||this.length);return this.length=e<0?this.length+e:e,this.push.apply(this,n)},Array.prototype.equals=function(e){if(this.length!=e.length)return!1;for(var t=0;t<e.length;t++){if(this[t].equals){if(!this[t].equals(e[t]))return!1;continue}if(this[t]!=e[t])return!1}return!0},String.prototype.toTitleCase=function(e){function n(){return t.test(arguments[0])&&arguments[arguments.length-2]?arguments[0]:arguments[1].toUpperCase()+arguments[2]}var t=new RegExp(/^(a|about|after|an|and|at|by|for|from|in|into|nor|of|on|onto|over|the|to|up|with|within)$/);return e.toLowerCase().replace(/\b([a-z])(\w*)\b/g,n)},Array.prototype.single=function(){return this[0]},jQuery.fn.removeAll=function(){this.each(function(){var e=this.cloneNode(!1);this.parentNode.replaceChild(e,this),jQuery.support.noCloneEvent&&cloneCopyEvent($(this),$(e))})},jQuery("body").hasClass("msie")&&(jQuery.propHooks.disabled={set:function(e,t){var n=jQuery(e).data("select2");if(!n)return;t===!0?n.trigger("disable"):n.trigger("enable")}}),SDS.Utility.registerNamespace("SDS.Controls"),SDS.Controls.MessageBox=Base.extend({constructor:function(e,t){var n={buttons:[{Type:SDS.Controls.MessageBox.ButtonType.OK,Text:"OK"}],css:{border:"none",padding:"15px",backgroundColor:"#fff","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px",opacity:".95",color:"#000",cursor:"default"},autoFitToViewport:!1,overlayCSS:{cursor:"default"},modal:!0},r=jQuery("body").hasClass("mobile");this.options=jQuery.extend(n,t);var i;if(this.options.id==i){var s=(new Date).getTime();this.options.id="messagebox"+s}this.element=jQuery("#"+this.options.id+" .message-box").get(0),this.element!=null&&jQuery(this.element).remove(),this.element=document.createElement("DIV"),this.element=jQuery(this.element).addClass("message-box").get(0),this.content=e,jQuery(this.element).bind("click",SDS.Controls.MessageBox.ClickHandler),document.body.appendChild(this.element),jQuery(this.element).data("MessageBox",this);if(!r){var o=jQuery(".facebox:last");this.makeDraggable(o)}},show:function(){var e=this;jQuery(document).bind("reveal.facebox",function(){jQuery(".content",this.element).find("input[type=text]:first").focus()});var t=jQuery(this.element);t.html('<div class="content"><div></div></div>'),t.find(".content").find("div").append(this.content);if(this.options.title){var n=this.options&&this.options.enablePrint?'<a href="javascript:void(0);" class="facebox-footer-button message-box-print" style="float:right;"><img class="image" style="display:none;" title="print"/><div class="print-image-div"></div></a>':"";t.prepend('<div class="title">'+this.options.title+n+"</div>")}t.append('<div class="dialog-toolbar"></div>'),jQuery(this.options.buttons).each(function(e,n){var r=jQuery('<button class="image-button" value="'+(n.Type||n.type)+'" '+((n.OnClick||n.click)&&!jQuery.isFunction(n.OnClick||n.click)?'onclick="'+(n.OnClick||n.click)+'"':"")+"><span>"+(n.Text||n.text)+"</span></button>");jQuery.isFunction(n.OnClick||n.click)&&r.data("clickHandler",n.OnClick||n.click),t.find("div.dialog-toolbar").append(r)});var r=this.dialogId=jQuery.facebox(this.element,"",this.options.id),i=jQuery("#"+r);i.find(".facebox-popup .footer").hide();var s=i.find(".facebox-popup .body");s.removeClass(),s.addClass("body"),s.css("padding","0px"),i.css("top","10px"),!this.options.autoFitToViewport||this.resizeToViewport(),jQuery(".message-box-print").off("click").click(function(){e.printContent()})},printContent:function(){this.initPrint();var e=this.getPrintParams();SDS.Print.PdfPrint2.printHTML(e,null)},initPrint:function(e){var t=this,n=new SDS.Controls.Spinner({container:$get("show-selected-dialog"),text:"Please wait. . ."});n.show()},getPrintParams:function(){var e=jQuery(this.element).find(".content"),t=e.clone();t.find("> div").css({"max-height":null,"overflow-y":"visible"});var n=t.html();this.options.printOnlyContent&&(n=this.options.printOnlyContent+n),this.options.printCssClass&&(n='<div class="'+this.options.printCssClass+'">'+n+"</div>");var r=REModel.Session.getAuth(),i=new REModel.EntityContext(r.appName,r.appName,"Listing",r.appName),s=i.getEntityKey(),o={divClass:"",html:n,renderEntity:s.entityName,entityKey:s,userKey:r,orientation:0,keyColumnName:"n/a",connectionKey:i.getConnectionKey()};return o},makeDraggable:function(e){var t=this;e.on("mousedown",function(e){t.dragStart(e,this)}),e.on("mouseup",function(e){t.dragStop(e,this)})},dragStop:function(e,t){this.isDragging=!1,jQuery(window).die("mouseout, mousemove, mouseover")},isHandle:function(e,t){switch(e.tagName.toLowerCase()){case"div":case"p":case"span":case"h1":case"h2":case"h3":case"h4":case"h5":case"hr":return t?!0:this.isHandle(e.parentElement,!0);default:return!1}},dragStart:function(e,t){var n=this;if(!this.isHandle(e.target))return;jQuery(e.target).scroll(function(){n.isDragging=!1}),this.isDragging=!0;var n=this,r=jQuery(t),i=r.offset(),s=i.left,o=i.top;return this.dragOffset={left:e.clientX-s,top:e.clientY-o},jQuery(window).on("mouseout mousemove mouseover",function(e){n.dragMove(e,t)}),this.pauseEvent(e)},pauseEvent:function(e){return e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.returnValue=!1,!1},dragMove:function(e,t){if(!this.isDragging)return;var n=jQuery(t),r=n.offset(),i=r.left,s=r.top,o=n.outerWidth(),u=n.outerHeight(),a=e.clientX,f=e.clientY,l=a-this.dragOffset.left,c=f-this.dragOffset.top,h=jQuery(document).width(),p=jQuery(document).height();c<0&&(c=0),c+u>p&&(c=p-u),l<0&&(l=0),l+o>h&&(l=h-o);if(i==l&&s==c)return;return t.style.position="absolute",t.style.top=c+"px",t.style.left=l+"px",this.pauseEvent(e)},getDialog:function(){return this.dialogId?jQuery("#"+this.dialogId):null},resizeToViewport:function(){var e=this.getDialog();if(!e)return;var t=e,n=jQuery(window).height()-jQuery("#MasterHeader").height()-105,r=t.find(".message-box > .content > div > div"),i=r.height(),s=t.height();if(s>n){var o=i/s*n;r.height(o).css("overflow-y","auto").css("overflow-x","hidden")}},hide:function(){jQuery(document).trigger("close.facebox",this.options.id)}},{ButtonType:{Yes:3,No:2,OK:1,Cancel:0},Button:{Yes:{Text:"Yes",Type:3},No:{Text:"No",Type:2},OK:{Text:"OK",Type:1},Cancel:{Text:"Cancel",Type:0}},ClickHandler:function(e,t){t=t?t:{};var n=jQuery(t.target||e.target),r=SDS.Controls.MessageBox;if(!n.is("button")&&!n.parent().is("button")||n.hasClass("mceIcon")||n.hasClass("disabled")||n.parent().is("button")&&n.parent().hasClass("disabled"))return;var i=n.parents("div.message-box"),s=i.data("MessageBox"),o={};jQuery(":input, :checkbox, :radio, select",i).each(function(e,t){var n=jQuery(t);if(n.length>0&&(n.attr("id")||n.attr("name"))){var i=n.attr("id")||n.attr("name"),s=n.attr("value");if(n.is(":checkbox"))if(!n.val())s=n.is(":checked");else{if(!t.checked)return;s=n.val(),s=s=="on"?!0:s=="off"?!1:s}else if(n.is(":radio")){if(!n.is(":checked"))return;s=n.val()}else n.is("[type=file]")?s=n:s=n.val();r.addValueToMap(o,i,s)}});var u=n.data("clickHandler");u||(u=n.parent().data("clickHandler")),jQuery.isFunction(u)?u(o)!=0&&jQuery(document).trigger("close.facebox",s.options.id):jQuery(document).trigger("close.facebox",s.options.id)},addValueToMap:function(e,t,n){var r=e[t];if(typeof r!="undefined")if(jQuery.isArray(r)){if(jQuery.inArray(n,r)>-1)return;e[t].push(n)}else{if(n==r)return;e[t]=[],e[t].push(r),e[t].push(n)}else e[t]=n}}),SDS.Utility.registerNamespace("SDS.Controls"),SDS.Controls.PageBox=Base.extend({constructor:function(e,t,n){this.title=e,this.content=t;var r={bodyClass:"body",id:null};this.options=jQuery.extend(r,n)},show:function(){var e=jQuery.facebox(this.content,"",this.options.id),t=this.dialog=jQuery("#"+e),n=t.find(".facebox-popup .body");n.find(".page-box-title").length?n.find(".page-box-title").html(this.title):n.prepend('<div class="page-box-title">'+this.title+"</div>");var r=t.find(".facebox-popup .body");r.css("padding",""),r.removeClass(),r.addClass("body"),r.addClass(this.options.bodyClass),t.find("a.close").bind("click",function(){jQuery(document).trigger("close.facebox",e)}),t.css("top",jQuery(window).scrollTop()+"px"),this.options.fullscreen&&(this.onResize(),jQuery(window).on("resize",jQuery.proxy(this.onResize,this)))},onResize:function(){if(this.options.fullscreen){var e=Math.max(684,jQuery(window).width()-43),t=Math.max(450,jQuery(window).height()-93);this.dialog.css({top:"0px",bottom:"0px",left:"0px",right:"0px",position:"absolute"}),this.dialog.find(".facebox-popup").css({top:"0px",bottom:"0px",left:"0px",right:"0px",position:"absolute"}),jQuery("#PhotosContainer").css({width:e,height:t})}}}),SDS.Utility.registerNamespace("SDS.Controls"),SDS.Controls.PrintLinkBox=SDS.Controls.MessageBox.extend({printBoxOptions:null,constructor:function(e){this.printBoxOptions=e;var t=[];e.download?t.push({Text:"Download",Type:SDS.Controls.MessageBox.ButtonType.OK,OnClick:e.downloadCallback}):(t.push({Text:"Print Preview",Type:SDS.Controls.MessageBox.ButtonType.OK,OnClick:e.printPreviewCallback}),t.push({Text:"Print",Type:SDS.Controls.MessageBox.ButtonType.OK,OnClick:e.printCallback})),t.push({Text:"Cancel",Type:SDS.Controls.MessageBox.ButtonType.Cancel});var n="Print Options";e.download&&(n="Download");var r={buttons:t,id:e.download?"download-dialog":"print-dialog",title:n};jQuery("#PrintMessageBox").remove(),jQuery(".results-container").addClass("print-hidden"),jQuery("#PrintViewContainer").addClass("print-hidden").empty();var i=[],s="print";e.download&&(s="download"),i.push('<div id="PrintMessageBox">'),i.push('<div class="print-link-container send-options-container">'),i.push("   <h4>What would you like to "),i.push(s),i.push("?</h4>"),i.push("<div>"),i.push('   <ul class="content-selection">'),i.push("<li><label "),e.selectedListing||i.push('disabled="disabled"'),i.push('><input type="radio" name="content" value="this-listing" id="ThisListing" '),e.selectedListing?i.push('checked="checked"'):i.push('disabled="disabled"'),i.push(' /><span class="send-label">This Listing</span></label></li>'),e.numListings>1&&(i.push('<li><label><input type="radio" name="content" value="all-listings" id="AllListings" '),e.selectedListing||i.push('checked="checked"'),i.push(' /><span class="send-label">All '+e.numListings+" Listing"+(e.numListings==1?"":"s")+"</span></label></li>")),i.push("</ul></div>"),e.hasMap&&i.push('<div><label style="color:#000;font-weight:normal;"><input type="checkbox" id="IncludeMap" checked="checked"><span>Include map as first page</span></label></div>'),i.push('<input type="hidden" id="CurMlNum" value="'+e.selectedListing+'"/>');var o=i.join("");this.base(o,r)},initialized:!1,form:null,close:function(e,t){this.hide(),this.dispose()},initialize:function(e){this.initialized=!0,e.call(this)},showDialog:function(){if(this.initialized){this.show();var e=jQuery("#"+this.options.id+"_overlay");e.removeClass("facebox_overlay"),e.css("position","fixed"),e.css("height","100%"),e.css("width","100%"),e.css("left","0px"),e.css("top","0px"),jQuery(document).bind("close.facebox",function(){var e=jQuery("#"+this.options.id+"_overlay");e.addClass("facebox_overlay"),e.remove()}.bind(this));var t=jQuery("#"+this.options.id);t.css("top",jQuery(window).scrollTop()+10+"px");if(this.printBoxOptions.showHelp){var n=this.printBoxOptions.helpPath?"'"+this.printBoxOptions.helpPath+"'":"";t.find(".dialog-toolbar").prepend('<div class="print-link-help actions-container" style="position:absolute;left:10px;bottom:22px;width:50px"><a onclick="SDS.Controls.PrintLinkBox.showHelp('+n+');return false;" class="help">Help</a></div>')}}else this.initialize(this.showDialog)},dispose:function(){this.initialized=null}},{showHelp:function(e){HelpUtility.showHelp(null,"Listing",e)}}),SDS.Controls.Spinner=Base.extend({constructor:function(e,t,n){typeof e=="object"?(t=e.text,n=jQuery.extend(e.options||n||{},{url:"../../Images/SpinnerWhite.gif",width:32,height:32}),e=e.container):e=$get(e);var r=this;this._container=e,this._text=t,this._handler=null,this._handled=!1,this._delay=typeof n.delay!="undefined"?n.delay:500,this._force=n.force===!0,this._force&&(this._delay=0),this._element=document.createElement("DIV"),this._label=document.createElement("DIV"),this._iframe=document.createElement("IFRAME"),this._img=document.createElement("IMG"),jQuery(this._element).addClass("spinner-container").css({position:"absolute"}),jQuery(this._label).addClass("spinner-label"),jQuery(this._iframe).attr("marginwidth","0").attr("marginheight","0").attr("frameborder","0").attr("scrolling","no").attr("width",n.width).attr("height",n.height),jQuery(this._img).attr("width",n.width).attr("height",n.height).attr("src",n.url),this._element.appendChild(this._label),this._element.appendChild(this._img)},setText:function(e){this._text=e},show:function(){var e=this;jQuery(this._label).html(this._text),jQuery(this._element).css("visibility","hidden");var t={top:0,left:0};try{this._container&&this._container.parentNode&&(this._force?t=jQuery(this._container).append(this._element).position():t=jQuery(this._container.parentNode&&this._container.tagName.toLowerCase()!="body"&&this._container.parentNode||this._container).append(this._element).position())}catch(n){t={top:0,left:0}}var r=jQuery(this._container).height(),i=jQuery(this._container).width(),s=jQuery(this._element).height(),o=jQuery(this._element).width(),u=t.top+(r-s)/2,a=t.left+(i-o)/2;this._timeout&&clearTimeout(this._timeout);if(this._delay>0){var f=this;this._timeout=setTimeout(function(){jQuery(f._element).css({position:"absolute",top:u,left:"50%","margin-left":"-64px",visibility:"visible"}).show()},this._delay)}else jQuery(this._element).css({position:"absolute",top:u,left:"50%","margin-left":"-64px",visibility:"visible"}).show();if(!this._handler){var l=e;this._handler=function(){l.show()}}this._handled||jQuery(window).resize(this._handler),e=null},hide:function(){this._timeout&&clearTimeout(this._timeout),jQuery(this._element).hide(),this._handled=!1,jQuery(window).unbind("resize",this._handler)}},{BAR:{url:"../../Images/Spinner-Bar-Blue.gif",width:220,height:19},CIRCLE:{url:"../../Images/SpinnerWhite.gif",width:32,height:32}}),REModel={},REModel.Services={},REModel.Session={getAuth:function(){return{appName:window.currentAppName,userID:"_guest"}}},"SDS"in window||(window.SDS={}),SDS.BingMap=Base.extend({constructor:function(e){window.__bingMapInstance=this,SDS.BingMap.Instances.push(this),this.instanceIndex=SDS.BingMap.Instances.length,this.container=e.container,this.mapContainer=document.createElement("div"),this.mapContainer.className="bing-map-container mapcontainer-"+this.instanceIndex,this.mapContainer.id="bing-map-"+this.instanceIndex,this.toolbarContainer=document.createElement("div"),this.toolbarContainer.className="bing-map-toolbar-container drawingtoolbar-"+this.instanceIndex,this.culture=e.culture||"en-us",this.mapControlSource=e.mapControlSource||"//www.bing.com/api/maps/mapcontrol?mkt="+this.culture+"&onscriptload=SDS.BingMap.MapReady",this.key=e.key,this.location=e.location,this.zoom=e.zoom||14,this.zoomForSingleListing=e.zoomForSingleListing,this.initialType=e.initialType||"auto",this.modulePath=e.modulePath||"../../",this.showDashboard=typeof e.showDashboard!="undefined"?e.showDashboard:!0,this.showMapTypeSelector=typeof e.showMapTypeSelector!="undefined"?e.showMapTypeSelector:!0,this.showScalebar=typeof e.showScalebar!="undefined"?e.showScalebar:!0,this.changeHandler=e.changeHandler||null,this.loadHandler=e.loadHandler||null,this.clickHandler=e.clickHandler||null,this.resizeHandler=e.resizeHandler||null,this.mapShapeChangeHandler=e.mapShapeChangeHandler||null,this.viewChangeStartHandler=e.viewChangeStartHandler||null,this.clearShapeHandler=e.clearShapeHandler||null,this.showLegendHandler=e.showLegendHandler||null,this.drawingModeChangeHandler=e.drawingModeChangeHandler||null,this.features=e.features||{},this.mapService=e.mapService,"getElement"in this.container?this.container=this.container.getElement():typeof this.element=="string"&&(this.container=jQuery(this.container)),this.container.appendChild(this.mapContainer),this.container.appendChild(this.toolbarContainer),this.wktShapes=[],this.deferred=e.deferred||!1,this.deferred||this.initMSMaps();if(this.features.logUsage)try{(new REModel.Services.LogService).logMapAccess("newobject"),(new REModel.Services.LogService).logMapAccess(this.key,"credentials")}catch(t){"console"in window&&console.log&&console.log(t)}this.requiredModules={},this.changeCount=0},show:function(){!this.mapInitialized&&this.deferred&&this.initMSMaps()},createMap:function(e){function i(e){function n(){return JSON.stringify(t.map.getBounds())}e||(e=n());var r=n();e!==r?setTimeout(function(){Object.keys(__bingMapInstance.layers).map(function(e){return __bingMapInstance.layers[e]}).filter(function(e){return e.updatePositions}).forEach(function(e){e.updatePositions()})},100):setTimeout(function(){i(e)},100)}var t=this;$parent=jQuery(this.mapContainer).parent(),$parent.outerWidth()==0&&$parent.css("position")=="absolute"&&$parent.css({top:"0px",bottom:"0px",left:"0px",right:"0px"}),this.availableMapTypes={aerial:Microsoft.Maps.MapTypeId.aerial,road:Microsoft.Maps.MapTypeId.road,birdseye:Microsoft.Maps.MapTypeId.birdseye,auto:Microsoft.Maps.MapTypeId.auto},this.map=new Microsoft.Maps.Map(this.mapContainer,{credentials:this.key,center:new Microsoft.Maps.Location(this.location.latitude,this.location.longitude),zoom:this.zoom,enableHighDpi:!0,enableSearchLogo:!1,enableClickableLogo:!1,disableKeyboardInput:typeof this.features.keyboardInput!="undefined"?!this.features.keyboardInput:!0,tileBuffer:2,useInertia:!1,culture:this.culture,showDashboard:this.showDashboard,showMapTypeSelector:this.showMapTypeSelector,showScalebar:this.showScalebar,mapTypeId:this.availableMapTypes[this.initialType||"auto"],navigationBarMode:Microsoft.Maps.NavigationBarMode.compact,showLocateMeButton:!0,disableStreetsideAutoCoverage:!this.showMapTypeSelector}),function s(){var e=jQuery("#MicrosoftNav");e.length?(e.css("left","60px").css("width","300px"),e.find("#RadialMenu").css("left",-60)):setTimeout(s,100)}();if(this.clickHandler){var n;function r(e){n=e}jQuery(document).on("keydown",r).on("keyup",r),Microsoft.Maps.Events.addHandler(this.map,"click",function(e){e.targetType=="map"&&(e.originalEvent=n,t.clickHandler(e))})}this.resizeHandler&&Microsoft.Maps.Events.addHandler(this.map,"viewchangeend",function(e){t.resizeHandler(e)}),t.viewChangeStartHandler&&Microsoft.Maps.Events.addHandler(this.map,"viewchangestart",function(e){t.viewChangeStartHandler()}),Microsoft.Maps.Events.addHandler(this.map,"maptypechanged",function(e){var n=t.map.getImageryId();t.mapTypeChange(n),n==="Streetside"?(jQuery("#ShowLegend, .drawingToolsToolbar").hide(),function r(){var e=jQuery("a.streetsideReportAProblemText");if(!e.length)return setTimeout(r,100);e.prop("href",e.prop("href").replace(/https:\/\/.+?\//,"https://www.bing.com/"))}()):jQuery("#ShowLegend, .drawingToolsToolbar").show()}),Microsoft.Maps.Events.addHandler(this.map,"viewchangeend",function(e){t.mapInitialized||(t.mapInitialized=!0,t.mapLoaded());if(t.hidden&&jQuery(t.container).is(":visible")){t.hidden=!1;return}if(!jQuery(t.container).is(":visible")){t.hidden=!0;return}t.mapChanged()}),this.requiredModules.CustomInfoboxModule&&(this.infobox=new CustomInfobox(this.map,{arrowColor:"#fff",arrowLength:20,arrowWidth:30,borderColor:"#fff",color:"#fff",minHeight:50,minWidth:385,offset:{x:12,y:12},orientation:0,showArrow:!0,showCloseButton:!1,tether:!1})),this.layers={},this.features.drawing&&(this.addLayer("editDecoration"),this.addLayer("shapeLayer")),this.addLayer("customTileLayer"),this.addLayer("standardShapeLayer"),this.addLayer("placesLayer",undefined,undefined,!0),this.addLayer("pinLayer",undefined,undefined,!0),this.addLayer("infoLayer"),this.addLayer("locationsLayer",undefined,undefined,!0),this.features.drawing&&(this.addLayer("edittingLayer"),this.addDrawingTools(this.features.drawing,e)),jQuery("#MapSplitPane").on("pageResize",function(){i()})},createPinLayerCluster:function(){var e=this;return e.pinLayerCluster=new ClusteredEntityCollection(e.map,{singlePinCallback:function(t){var n=t.Latitude,r=t.Longitude,i=e.createPushpin(t.options);return i},clusteredPinCallback:function(t,n){var r=e.createClusteredPin(t,n,{width:24,height:24,draggable:!1,textOffset:new Microsoft.Maps.Point(0,4)});return r.cluster=t,r}}),e.pinLayerCluster.GetLayer()},createClusteredPin:function(e,t,n){n.cssClass=n.typeName||"map-overlapping-marker";var r=new Microsoft.Maps.Pushpin(t,{htmlContent:n.htmlContent||this.getPinHtml(n),width:n.width,height:n.height,draggable:n.draggable}),i=[];for(var s=0,o=e.length;s<o;s++){var u=e[s];u.options.data.pinHtml=this.getPinHtml(u.options),i.push(u.options.data)}r.data=i;var n=e[0].options;return this.pushPinBindEvents(r,n),r},getPinHtml:function(e){var t=e.iconCssBase||"map-pushpin",n=e.cssClass||"",r=e.label||"",i=e.width||24,s=e.height||24;return'<div class="'+t+" "+n+'" style="pointer-events: all; width: '+i+"px;height: "+s+'px;"><div class="text">'+r+"</div></div>"},clear:function(e){if(!this.layers)return;if(!e)for(var t in this.layers)this.layers[e].clear();else this.layers[e]&&this.layers[e].clear&&this.layers[e].clear()},clearShapes:function(e){this.drawingTools&&this.drawingTools.clear(e)},clearPushpins:function(){this.clear("pinLayer"),this.features.clusters&&(this.clusterablePins=[],this.pinLayerCluster.SetData([]))},removePushpin:function(e,t){this.layers[t||"pinLayer"].remove(e)},addPushpin:function(e){var t=this;if(this.features.clusters){this.clusterablePins=this.clusterablePins||[];var n=e.location;this.clusterablePins.push({Name:"",Latitude:e.location[0],Longitude:e.location[1],options:e}),clearTimeout(this.setClusterPinsTimeout),this.setClusterPinsTimeout=setTimeout(function(){t.pinLayerCluster.SetData(t.clusterablePins)},1)}else{var r=this.createPushpin(e);e.layer||this.layers.pinLayer.push(r)}},createPushpin:function(e,t){var n=this;typeof e=="undefined"&&(e={});if(e.basic){var r=new Microsoft.Maps.Pushpin(e.location,{draggable:e.draggable});this.layers.pinLayer.push(r);return}var i=e.location||null,s=e.data,o=e.infoboxContent||null;e.title&&e.body&&(o='<div class="VE_Pushpin_Popup_Title">'+e.title+"</div>"+'<div class="VE_Pushpin_Popup_Body">'+e.body+"</div>");var u=typeof e.draggable!="undefined"?e.draggable:!1;if(!i)return;i.length&&i.length==2?i=new Microsoft.Maps.Location(i[0],i[1]):i.latitude&&i.longitude&&(i=new Microsoft.Maps.Location(i.latitude,i.longitude)),s||(s={});var r=new HtmlPushpin(i,e.htmlContent||this.getPinHtml(e),new Microsoft.Maps.Point(24,24));return r._element.className="MapPushpinBase",r._element.pin=r,r.getLocation=function(){return this.location},r.getHtmlContent=function(){return this._element.innerHTML},o&&(r.content=o,e.infoboxHandleClick&&(r.infoboxHandleClick=e.infoboxHandleClick)),s&&(r.data=[s]),e.layer&&this.layers[e.layer].push(r),this.pushPinBindEvents(r,e),r},addLayer:function(e,t,n,r){e==="listingsLayer"&&(r=!0),this.layerIndexMap||(this.layerIndexMap={});if(!this.layers[e]||n){var i;return e=="pinLayer"&&this.features.clusters?i=this.createPinLayerCluster():r?i=new HtmlPushpinLayer:(i=new Microsoft.Maps.Layer(e),i.push=i.add,i.getLength=function(){return i.getPrimitives().length},i.get=function(e){return i.getPrimitives()[e]}),this.layers[e]=i,typeof t!="undefined"?(this.map.layers.insert(i,t),this.layerIndexMap[e]=t,this.map.layers[t]):((e!="pinLayer"||!this.features.clusters)&&this.map.layers.insert(i),this.layerIndexMap[e]=this.map.layers.length-1,this.map.layers[this.map.layers.length-1])}},pushPinBindEvents:function(e,t){function r(e,t,n){e.parentElement?jQuery(e).on(t,function(e){e.target=e.currentTarget.pin,n(e)}):setTimeout(function(){r(e,t,n)},0)}var n=this;if(e.content)r(e._element,"click",function(e){return n.displayInfobox(e),e.preventDefault&&e.preventDefault(),e.originalEvent&&(e.originalEvent.returnValue=!1),!1}),r(e._element,"mouseover",function(e){n.displayInfobox(e)}),r(e._element,"mouseout",function(e){n.hideInfobox(e)});else{var i=t.click||null,s=t.mouseover||null,o=t.mouseout||null;i&&r(e._element,"click",function(e){return i(e),e.preventDefault&&e.preventDefault(),e.originalEvent&&(e.originalEvent.returnValue=!1),!1}),s&&r(e._element,"mouseover",function(e){s(e)}),o&&r(e._element,"mouseout",function(e){o(e)})}},addPolyline:function(e,t){t||(t={strokeThickness:5,strokeColor:new Microsoft.Maps.Color(175,36,80,128)}),e=e.reduce(function(e,t){return e.push(t),e},[]),e.length&&e.length>0&&this.layers.standardShapeLayer.push(new Microsoft.Maps.Polyline(e,t?t:null))},displayInfobox:function(e){var t=this,n=null;if(this.isDrawing)return;e.targetType=="pushpin"?n=e.target:"content"in e?n=e:e.target&&(n=e.target);if(n){if(jQuery("#MasterDynamicBody.hide-listings-map").length>0&&n._htmlContent&&n._htmlContent.indexOf("show-when-listing-hidden")==-1)return;this.__hideTimeout&&window.clearTimeout(this.__hideTimeout),this.infobox.show(n.getLocation(),n.content,function(e){t.infoboxVisible=!0,jQuery(e).off("mouseover").off("mouseout").off("click").on("mouseover",function(){t.__hideTimeout&&window.clearTimeout(t.__hideTimeout)}).on("mouseout",function(){t.hideInfobox()}),n.infoboxHandleClick&&jQuery(e).on("click",function(e){n.infoboxHandleClick(e,n)})})}},hideInfobox:function(e){this.infoboxVisible=!1;var t=this;this.__hideTimeout&&window.clearTimeout(this.__hideTimeout),this.__hideTimeout=window.setTimeout(function(){t.infobox.hide()},250)},toggleDrawingTools:function(e){e?jQuery(".drawingtoolbar-"+this.instanceIndex).show():jQuery(".drawingtoolbar-"+this.instanceIndex).hide()},reinitMap:function(){var e=[];for(layerName in this.layers)e.push(this.getLayerDataByName(layerName));this.layers={},this.layerIndexMap={},jQuery(".drawingToolsToolbar",".drawingtoolbar-"+this.instanceIndex).remove(),this.location=this.map.getCenter(),this.zoom=this.map.getZoom(),this.initialType=this.map.getMapTypeId(),this.createMap(!0),this.restoreLayers(e)},getLayerDataByName:function(e){var t=[],n=this.layerIndexMap[e],r=this.map.entities.get(n);for(var i=0,s=r.getLength();i<s;i++)t.push(r.removeAt(i));return{index:n,name:e,entities:t}},restoreLayers:function(e){e.sort(function(e,t){return e.index>t.index?1:e.index<t.index?-1:0});for(var t=0;t<e.length;t++){var n=this.layers[e[t].name];if(n)for(var r=0;r<e[t].entities.length;r++)e[t].entities[r]&&n.push(e[t].entities[r])}},addDrawingTools:function(e,t){var n=this;if(this._drawingToolsAdded&&!t)return;this._drawingToolsAdded=!0,e=="hidden"&&(this.hidden=!0,jQuery(".drawingtoolbar-"+this.instanceIndex).hide()),this.drawingTools=new DrawingTools.DrawingManager(this.map,{toolbarContainer:jQuery(".drawingtoolbar-"+n.instanceIndex).get(0),toolbarOptions:{drawingModes:["polygon","circle","rectangle","edit","erase","excludeshape","unionshapes"],styleTools:[]},shapeLayer:this.layers.shapeLayer,edittingLayer:this.layers.edittingLayer,editDecorationLayer:this.layers.editDecoration,defaultUnits:this.features.defaultUnits||"mi",shapeOptions:{strokeThickness:1,strokeColor:new Microsoft.Maps.Color(200,36,80,128),fillColor:new Microsoft.Maps.Color(51,66,139,202)},events:{drawingModeChanged:function(e){n.drawingModeChanged(e)},drawingChanged:function(e){n.drawingChanged("changed",e)},drawingErased:function(e){n.drawingCleared()},drawingStarted:function(e){},drawingEnded:function(e){n.drawingChanged("ended",e)}}}),this.mapService&&(this.drawingTools.unionHandler=function(e){var t=n.getShapes(),r=WKTModule.Write(e),i=[];for(var s=0,o=t.length;s<o;s++)t[s]!=r&&i.push(t[s]);n.mapService.unionShapes(r,i,function(e){if(e&&e.length>0){n.drawingTools.clear();var t=n.drawingTools.getShapeLayer();for(var r=0,i=e.length;r<i;r++){var s=WKTModule.Read(e[r]);s.setOptions(n.drawingTools.getShapeOptions()),t.push(s)}n.mapChanged(!0)}})},this.drawingTools.excludeHandler=function(e){var t=n.getShapes(),r=WKTModule.Write(e),i=[];for(var s=0,o=t.length;s<o;s++)t[s]!=r&&i.push(t[s]);n.mapService.excludeShapes(r,i,function(e){if(e&&e.length>0){n.drawingTools.clear();var t=n.drawingTools.getShapeLayer();for(var r=0,i=e.length;r<i;r++){var s=WKTModule.Read(e[r]);s.setOptions(n.drawingTools.getShapeOptions()),t.push(s)}n.mapChanged(!0)}})})},drawingChanged:function(e,t){this.mapShapeChangeHandler?this.mapShapeChangeHandler(this.getShapes()):this.mapChanged(!0)},drawingCleared:function(){this.clearPushpins(),this.clearShapeHandler&&this.clearShapeHandler()},drawingModeChanged:function(e){this.previousDrawingMode!=e&&(this.previousDrawingMode=e,this.drawingModeChangeHandler&&this.drawingModeChangeHandler(e)),e=="polygon"||e=="circle"||e=="rectangle"||e=="edit"?this.isDrawing=!0:this.isDrawing=!1},getShapes:function(e){if(!this.drawingTools)return[];var t=[],n=this.drawingTools.getShapeLayer(),r=n.getPrimitives().length;for(var i=0;i<r;i++){var s=n.getPrimitives()[i];s&&s.getLocations().length>3&&t.push(e?s:WKTModule.Write(s))}return t},hasShapes:function(){if(!this.drawingTools)return!1;var e=this.drawingTools.getShapeLayer();return e.getPrimitives().length>0},counter:0,shouldLoad:!1,mapLoaded:function(){if(this.layers.pinLayer.container===null){var e=this,t=Object.keys(this.layers).map(function(t){return e.layers[t]});return++this.counter,!this.shouldLoad&&this.counter>20&&t.some(function(e){return HtmlPushpinLayer.prototype.isPrototypeOf(e)&&e.container!==null})&&(t.filter(function(e){return HtmlPushpinLayer.prototype.isPrototypeOf(e)&&e.container===null&&!e._map}).forEach(function(t){return t.attachMap(e.map)}),this.shouldLoad=!0),setTimeout(function(){e.mapLoaded()},100)}this.loadHandler&&this.loadHandler(),this.addCustomMapControls()},addCustomMapControls:function(){var e=this,t=jQuery("#MicrosoftNav");t.length>0?(this.features.mapArt&&this.addMapArtButtons(),this.showLegendHandler&&this.addLegendButton(),jQuery(".NavBar_modeSelectorControlContainer:not(.adjusted)").on("mouseover",function(e){var t=this;if(!jQuery(e.target).parent().hasClass("NavBar_modeSelectorControlContainer"))return;jQuery(this).addClass("adjusted"),window.setTimeout(function(){jQuery(".NavBar_itemContainer.NavBar_itemContainer_be",t).attr("href","javascript:void(0);")},100)})):window.setTimeout(function(){e.addCustomMapControls()},200)},addLegendButton:function(){var e=this,t=jQuery("#MicrosoftNav"),n=t.parent();n&&(e.legendButton=jQuery('<span class="NavBar_button NavBar_typeButton" id="ShowLegend" style="width: 60px;background: #fff;display: block;text-align: center;border-bottom: 2px solid #555;padding: 6px 0 6px 0;cursor: pointer;float:left; pointer-events: all;">Legend</span>'),n.prepend(e.legendButton),jQuery(e.legendButton).on("click",function(){e.showLegend()}))},showLegend:function(){this.showLegendHandler&&this.showLegendHandler()},addMapArtButtons:function(){var e=this;jQuery(this.mapContainer).addClass("hasMapArt"),this.mapServer=location.href.toLowerCase().indexOf("/live")==0?"http://dev2.stratusmls.com/":"http://www.torontomls.net/";var t=[{name:"art",label:"MapArt",index:0,tileURL:this.mapServer+"Maps/MapArt/Layer_MapArt/{quadkey}.png"},{name:"grid",label:"Grid",index:1,tileURL:this.mapServer+"Maps/MapArt/Layer_GridLayer/{quadkey}.png"},{name:"area",label:"Areas",index:2,tileURL:this.mapServer+"BingCommunitiesMap/BingMapData/Layer_Areas/{quadkey}.png"},{name:"muni",label:"Municipalities",index:3,tileURL:this.mapServer+"BingCommunitiesMap/BingMapData/Layer_Municipalities/{quadkey}.png"},{name:"comm",label:"Communities",index:4,tileURL:this.mapServer+"BingCommunitiesMap/BingMapData/Layer_Communities/{quadkey}.png"}],n=jQuery(".NavBar_modeSelectorControlContainer");if(n.length>0){var r=jQuery('<span class="NavBar_separator"/>'),i=jQuery('<li class="button_artmenu NavBar_button">Map Layers<a class="NavBar_dropIconContainer" href="#"><span class="NavBar_dropIcon"></span></a></li>'),s=jQuery('<ul style="display:none; max-width: 150px; position: absolute; z-index: 1" class="MicrosoftMap_NavBar_typeMenu MicrosoftMap_NavBar_artMenu"></ul>');i.append(s),e.layers.customTileLayer.setOptions({visible:!1}),e.mapArtLayers={};for(var o=0,u=t.length;o<u;o++){$menuItem=jQuery('<li data-name="'+t[o].name+'" id="NavBar_button" class="NavBar_menuitem '+t[o].name+'"><a class="NavBar_button NavBar_itemContainer NavBar_itemContainer_auto">'+t[o].label+"</a></li>"),$menuItem.on("click",function(){var n=jQuery(this).data("name");e.showHideMapArt(jQuery.grep(t,function(e){return n==e.name})[0])}),s.append($menuItem);var a=new Microsoft.Maps.TileSource({uriConstructor:t[o].tileURL}),f=new Microsoft.Maps.TileLayer({mercator:a});f.setOptions({visible:!1,zIndex:t[o].index}),e.mapArtLayers[t[o].name]=f,e.layers.customTileLayer.push(f)}n.append(r),n.append(i),i.on("mouseover",function(e){s.show()}).on("mouseout",function(e){s.hide()}).on("click",function(){s.is(":visible")?s.hide():s.show()})}},showHideMapArt:function(e){this.layers.customTileLayer.getVisible()||this.layers.customTileLayer.setOptions({visible:!0});var t=this.mapArtLayers[e.name].getVisible();jQuery(".NavBar_menuitem."+e.name).toggleClass("active",!t),this.mapArtLayers[e.name].setOptions({visible:!t,zIndex:e.index})},mapChanged:function(e){var t=this;this.changeCount++;if(this.changeCount==1)return;e&&(this.wktShapes=this.getShapes()),SDS.BingMap.__searchTimeout&&clearTimeout(SDS.BingMap.__searchTimeout),SDS.BingMap.__searchTimeout=window.setTimeout(function(){t.bounds=t.map.getBounds(),t.northwest=t.bounds.getNorthwest(),t.southeast=t.bounds.getSoutheast(),t.center=t.bounds.center,t.changeHandler&&t.changeHandler({bounds:{northwest:[t.northwest.latitude,t.northwest.longitude],southeast:[t.southeast.latitude,t.southeast.longitude],center:[t.southeast.latitude,t.southeast.longitude]},zoom:t.map.getZoom(),shapes:t.wktShapes}),Microsoft.Maps.Events.invoke(t.map,"viewchange",{})},500)},mapTypeChange:function(e){if(this.drawingTools){var t=(e||"").indexOf("Birdseye")!=-1?"Birdseye":e;if(t!=this._prevMapType){this._prevMapType=t;var n={};t=="Birdseye"||t=="Aerial"?(n={strokeThickness:1,strokeColor:new Microsoft.Maps.Color(200,255,255,255),fillColor:new Microsoft.Maps.Color(100,255,255,255)},t=="Birdseye"?this.layers.customTileLayer.getVisible()&&(this.layers.customTileLayer.setOptions({visible:!1}),this.enableMapArtWhenAvailable=!0):this.enableMapArtWhenAvailable&&this.layers.customTileLayer.setOptions({visible:!0})):(n={strokeThickness:1,strokeColor:new Microsoft.Maps.Color(200,36,80,128),fillColor:new Microsoft.Maps.Color(51,66,139,202)},this.enableMapArtWhenAvailable&&this.layers.customTileLayer.setOptions({visible:!0})),this.drawingTools.setShapeOptions(n)}}jQuery("#ShowLegend").css("background",e!=="Road"?"rgba(0,0,0,0.6)":"#fff").css("color",e!=="Road"?"#fff":"#000")},initMSMaps:function(){var e=this;if(!("Microsoft"in window)||!("Microsoft.Maps"in window))jQuery.ajaxSetup({cache:!0}),jQuery.getScript(this.mapControlSource,function(){e._loadInterval=window.setInterval(function(){"Microsoft"in window&&Microsoft.Maps&&Microsoft.Maps.Map&&Microsoft.Maps.loadModule&&(window.clearInterval(e._loadInterval),e.loadModules())},100)}),jQuery.ajaxSetup({cache:!1})},loadModules:function(){function t(t){Microsoft.Maps.loadModule(t,{callback:function(){e.modulesLoaded(t)}})}var e=this;this.requiredModules["Microsoft.Maps.AdvancedShapes"]=!1,this.requiredModules.CustomInfoboxModule=!1,this.requiredModules.HtmlPushpinLayerModule=!1,this.features.clusters&&(this.requiredModules.ClientSideClusteringModule=!1),this.features.drawing&&(this.requiredModules.WKTModule=!1,this.requiredModules.DrawingToolsModule=!1),this.features.directions&&(this.requiredModules["Microsoft.Maps.Directions"]=!1),t("Microsoft.Maps.AdvancedShapes"),Microsoft.Maps.registerModule("HtmlPushpinLayerModule",this.modulePath+"External/BingMaps/V7/HTMLPushPins/HtmlPushpinLayerModule.js"),t("HtmlPushpinLayerModule"),this.features.drawing&&(Microsoft.Maps.registerModule("DrawingToolsModule",this.modulePath+"External/BingMaps/V7/DrawingTools/DrawingToolsModule.js?c=3.43.61"),t("DrawingToolsModule"),Microsoft.Maps.registerModule("WKTModule",this.modulePath+"External/BingMaps/V7/WellKnownText/WKTModule.js"),t("WKTModule")),Microsoft.Maps.registerModule("CustomInfoboxModule",this.modulePath+"External/BingMaps/V7/CustomInfoBox/V7CustomInfobox.js?v=3.43.7"),t("CustomInfoboxModule"),this.features.clusters&&(Microsoft.Maps.registerModule("ClientSideClusteringModule",this.modulePath+"External/BingMaps/V7/ClientSideClustering/V7ClientSideClustering.js?v=3.43.6"),t("ClientSideClusteringModule")),this.features.directions&&t("Microsoft.Maps.Directions")},modulesLoaded:function(e){this.requiredModules[e]=!0;for(var t in this.requiredModules)if(this.requiredModules[t]===!1)return!1;this._modulesLoaded||(this._modulesLoaded=!0,this.createMap(),this.getCredentials(function(){return}))},getBounds:function(){return this.map.getBounds()},getBoundingRectangle:function(e){var t=this.map.getBounds(),n=t.getNorthwest(),r=t.getSoutheast(),i=[];return i.push([n.longitude,n.latitude]),i.push([r.longitude,n.latitude]),i.push([r.longitude,r.latitude]),i.push([n.longitude,r.latitude]),i.push([n.longitude,n.latitude]),e?[i[0].join(" "),i[1].join(" "),i[2].join(" "),i[3].join(" "),i[4].join(" ")].join(", "):i},getCenter:function(){return this.map.getCenter()},getZoomLevel:function(){return this.map.getZoom()},getMapStyle:function(){return this.map.getMapTypeId()},setCenter:function(e,t,n){var r=this;if(!this.map){this._setCenterTimeout&&window.clearTimeout(this._setCenterTimeout),this._setCenterTimeout=window.setTimeout(function(){r.setCenter(e,t,n)},100);return}var i=this.map.getOptions();i.zoom=this.map.getZoom(),e&&(i.center=new Microsoft.Maps.Location(e.latitude,e.longitude),delete i.bounds),t&&!isNaN(parseFloat(t))&&(i.zoom=parseFloat(t)),n&&(i.mapTypeId=n),this.map.setView(i)},setCenterFromGeocodeResults:function(e,t){if(e&&e.resourceSets&&e.resourceSets.length>0&&e.resourceSets[0].resources&&e.resourceSets[0].resources.length>0){var n=e.resourceSets[0].resources[0].point.coordinates,r={latitude:n[0],longitude:n[1]};this.setCenter(r,t)}},SetScaleBarDistanceUnit:function(e){},getCredentials:function(e){var t=this;if(this.sessionID){e();return}this.map.getCredentials(function(n){t.sessionID=n,e()})},getDirections:function(e,t,n){var r=this;t=t||{};if(!this.map)return;if(!this.sessionID){this.getCredentials(function(){r.getDirections(e,t,n)});return}t.travelMode||(t.travelMode="Driving"),t.optimize||(t.optimize="time"),t.tl||(t.tl=344978e-11);var i="http://dev.virtualearth.net/REST/V1/Routes/Driving",s=jQuery.extend({},t);for(var o=0;o<e.length;o++){var u="wp."+o;e[o].length&&e[o].length==2?s[u]=e[o][0]+","+e[o][1]:s[u]=e[o]}var a=i+"?key="+this.sessionID+"&routePathOutput=Points&o=json";for(var f in s)a+="&"+f+"="+encodeURIComponent(s[f]);jQuery.getJSON(a+"&jsonp=?",function(e){n(e)})},geocode:function(e,t,n,r){var i=this;this.geocodeResults||(this.geocodeResults={});if(t&&this.geocodeResults[e]){this.setCenterFromGeocodeResults(this.geocodeResults[e],r),n&&n(this.geocodeResults[e]);return}this.getCredentials(function(){var s="http://dev.virtualearth.net/REST/v1/Locations?query="+encodeURI(e)+"&output=json&key="+i.sessionID;jQuery.getJSON(s+"&jsonp=?",function(s){s&&(i.geocodeResults[e]=s),t&&i.setCenterFromGeocodeResults(s,r),n&&n(s)})})},find:function(e,t,n){function r(e){return[e[2],e[3],e[0],e[1]]}function s(t){return["http://spatial.virtualearth.net/REST/v1/data/f22876ec257b474b82fe2ffcb8393150/NavteqNA/NavteqPOIs?spatialFilter=bbox(",r(t).join(),")&$format=json&key=",__bingMapInstance.key,"&$filter=EntityTypeID eq ",i[e.what]||-1,"&jsonp=?"].join("")}var i={Winery:2084,ATM:3578,"Train Station":4013,"Commuter Rail Station":4100,"Bus Station":4170,"Named Place":4444,"Ferry Terminal":4482,Marina:4493,Airport:4581,"Business Facility":5e3,"Grocery Store":5400,"Auto Dealerships":5511,"Petrol/Gasoline Station":5540,"Motorcycle Dealership":5571,Restaurant:5800,"Historical Monument":5999,Bank:6e3,Shopping:6512,Hotel:7011,"Ski Resort":7012,"Tourist Information":7389,"Rental Car Agency":7510,"Parking Lot":7520,"Parking Garage/House":7521,"Park & Ride":7522,"Auto Service & Maintenance":7538,Cinema:7832,"Rest Area":7897,"Performing Arts":7929,"Sports Complex":7940,"Park/Recreation Area":7947,Casino:7985,"Convention/Exhibition Centre":7990,"Golf Course":7992,"Civic/Community Centre":7994,"Amusement Park":7996,"Tourist Attraction":7999,Hospital:8060,"Higher Education":8200,School:8211,Library:8231,Museum:8410,"Automobile Club":8699,"City Hall":9121,"Court House":9211,"Police Station":9221,Campground:9517,"Truck Stop/Plaza":9522,"Post Office":9530,"Convenience Store":9535,"Clothing Store":9537,"Department Store":9545,"Home Specialty Store":9560,Pharmacy:9565,"Specialty Store":9567,"Sporting Goods Store":9568,"Highway Exit":9592,"Transportation Service":9593,"Weigh Station":9710,"Cargo Centre":9714,"Military Base":9715,"Animal Park":9718,"Home Improvement & Hardware Store":9986,"Consumer Electronics Store":9987,"Office Supply & Services Store":9988,Bookstore:9995,"Coffee Shop":9996,Hamlet:9998,"Border Crossing":9999};i.Gas=5540,i.Parks=7947,i.Restaurants=5800,i.Pizza=5800,i.Sushi=5800,i.Schools=8211,i.Supermarkets=5400,jQuery.getJSON(s(e.bounds.bounds),function(n){n.d.searchResults=n.d.results.filter(function(t){return(e.what!=="Pizza"||t.Name.toLowerCase().indexOf("pizz")!==-1)&&(e.what!=="Sushi"||t.Name.toLowerCase().indexOf("sushi")!==-1)}),n.d.searchResults.forEach(function(e){e.location=[e.Latitude,e.Longitude],e.name=e.DisplayName,e.address=e.AddressLine,e.city=e.Locality.split(",")[0],e.state=e.AdminDistrict,e.phone=e.Phone.replace(/(\d{3})-(\d{3})(\d{4})/,"($1) $2-$3")}),t(n.d)})},setShapes:function(e){},shapeFromWKT:function(e){return WKTModule.Read(e)},setPolygon:function(e){if(typeof e=="string"){var t=e;t.indexOf("((")==-1&&(t="POLYGON(("+t+"))");var n=this.shapeFromWKT(t);n!=null&&this.drawingTools.addShape(n)}else{if(!e[0].latitude){var r=jQuery.map(e,function(e,t){return new Microsoft.Maps.Location(e[0],e[1])});this.drawingTools.addPolygon(r);return}this.drawingTools.addPolygon(e)}},setRadius:function(e,t){},getShapeBounds:function(){var e=this.getShapes(!0);if(e&&e.length&&e.length>0){var t=[];for(var n=0,r=e.length;n<r;n++)t=t.concat(e[n].getLocations());return Microsoft.Maps.LocationRect.fromLocations(t)}return null},setBoundsFromPushpins:function(){var e=this.layers.pinLayer,t=e.getLength(),n=this,r=this.map.getWidth();if(!r||r<10){window.setTimeout(function(){n.setBoundsFromPushpins()},100);return}this.clusterablePins=this.clusterablePins||[];if(t>0||this.clusterablePins.length>0){var i=[];for(var s=0;s<t;s++){var o=e.get(s).getLocation();o.latitude&&i.push(e.get(s).getLocation())}for(var s=0,u=this.clusterablePins.length;s<u;s++){var a=this.clusterablePins[s];a.Latitude&&i.push(new Microsoft.Maps.Location(a.Latitude,a.Longitude))}var f=Microsoft.Maps.LocationRect.fromLocations(i);if(f){var l={},c=this.zoomForSingleListing&&this.zoomForSingleListing();i.length==1&&c?(l.zoom=c,l.center=f.center):l.bounds=f,this.map.setView(l)}}},setBoundsFromShapes:function(){var e=this.getShapeBounds();e&&this.map.setView({bounds:e})},setBoundsFromBoundingBox:function(e){var t=Microsoft.Maps.LocationRect.fromLocations(new Microsoft.Maps.Location(e[0],e[1]),new Microsoft.Maps.Location(e[2],e[3]));this.map.setView({bounds:t})},initPrint:function(){var e=0,t=this.map.getMapTypeId();switch(t){case Microsoft.Maps.MapTypeId.aerial:e=3;break;case"b":case Microsoft.Maps.MapTypeId.birdseye:alert("Printing from Bird's Eye maps is not supported. You must change to Automatic or Road Maps before printing.");return;case Microsoft.Maps.MapTypeId.hybrid:case Microsoft.Maps.MapTypeId.auto:this.map.setMapType(Microsoft.Maps.MapTypeId.road)}return e}},{Instances:[],MapReady:function(){return!0},PushpinIcons:{red:"Images/Icons/PNG/24/84.png",magenta:"Images/Icons/PNG/24/150.png",cyan:"Images/Icons/PNG/24/152.png",green:"Images/Icons/PNG/24/86.png",blue:"Images/Icons/PNG/24/88.png",yellow:"Images/Icons/PNG/24/82.png",gray:"Images/Icons/PNG/24/151.png"}}),"SDS"in window||(window.SDS={}),SDS.BingMapIFrame=Base.extend({constructor:function(e){window.__bingMapInstance=this,SDS.BingMap.Instances.push(this),this.instanceIndex=SDS.BingMap.Instances.length,this.container=e.container,this.changeHandler=e.changeHandler||null,this.loadHandler=e.loadHandler||null,this.clickHandler=e.clickHandler||null,this.resizeHandler=e.resizeHandler||null,this.mapShapeChangeHandler=e.mapShapeChangeHandler||null,this.viewChangeStartHandler=e.viewChangeStartHandler||null,this.clearShapeHandler=e.clearShapeHandler||null,this.drawingModeChangeHandler=e.drawingModeChangeHandler||null,this.features=e.features,this.init=e,window.SDSBingMapInitialization=e,this.modulePath=e.modulePath||"../../",this.initIFrame()},initIFrame:function(){this.iframeID="sds-bingmap-frame-"+this.instanceIndex,jQuery(this.container.$getElement?this.container.$getElement():this.container).append('<iframe name="'+this.iframeID+'" id="'+this.iframeID+'" src="'+this.modulePath+'Controls/Map/BingMapIFrame.html" width="100%" height="100%" style="display:none" onload="this.style.display=\'block\';" allowTransparency="true" frameborder="0" marginheight="0" marginwidth="0" style=""></iframe>')},getInstance:function(){return this.iframe||(this.iframe=jQuery("#"+this.iframeID).get(0).contentWindow.SDSBingMapInstance),this.iframe},clear:function(e){this.getInstance().clear(e)},clearShapes:function(e){this.getInstance().clearShapes(e)},clearPushpins:function(){this.getInstance().clearPushpins()},removePushpin:function(e,t){this.getInstance().removePushpin(e,t)},addPushpin:function(e){this.getInstance().addPushpin(e)},createPushpin:function(e,t){this.getInstance().createPushpin(e,t)},addLayer:function(e,t,n){this.getInstance().addLayer(e,t,n)},addPolyline:function(e,t){this.getInstance().addPolyline(e,t)},toggleDrawingTools:function(e){this.getInstance().toggleDrawingTools(e)},getShapes:function(e){return this.getInstance().getShapes()},hasShapes:function(){return this.getInstance().hasShapes()},mapLoaded:function(){this.loadHandler&&this.loadHandler()},mapChanged:function(e){this.changeHandler&&this.changeHandler(e)},drawingChanged:function(e,t){this.mapShapeChangeHandler?this.mapShapeChangeHandler(this.getShapes()):this.mapChanged(!0)},drawingCleared:function(){this.clearPushpins(),this.clearShapeHandler&&this.clearShapeHandler()},drawingModeChanged:function(){this.drawingModeChangeHandler&&this.drawingModeChangeHandler()},getBounds:function(){return this.getInstance().getBounds()},getBoundingRectangle:function(e){return this.getInstance().getBoundingRectangle(e)},getCenter:function(){return this.getInstance().getCenter()},getZoomLevel:function(){return this.getInstance().getZoomLevel()},getMapStyle:function(){return this.getInstance().getMapStyle()},setCenter:function(e,t,n){this.getInstance().setCenter(e,t,n)},setCenterFromGeocodeResults:function(e,t){this.getInstance().setCenterFromGeocodeResults(e,t)},SetScaleBarDistanceUnit:function(e){this.getInstance().SetScaleBarDistanceUnit(e)},getCredentials:function(e){throw new Exception("cannot get credentials on iframe instance")},getDirections:function(e,t,n){this.getInstance().getDirections(e,t,n)},geocode:function(e,t,n,r){this.getInstance().geocode(e,t,n,r)},find:function(e,t,n){this.getInstance().find(e,t,n)},setShapes:function(e){this.getInstance().setShapes(e)},shapeFromWKT:function(e){this.getInstance().shapeFromWKT(e)},setPolygon:function(e){this.getInstance().setPolygon(e)},setRadius:function(e,t){this.getInstance().setRadius(polygonPointsArray)},getShapeBounds:function(){return this.getInstance().getShapeBounds()},setBoundsFromPushpins:function(){this.getInstance().setBoundsFromPushpins()},setBoundsFromShapes:function(){this.getInstance().setBoundsFromShapes()},setBoundsFromBoundingBox:function(e){this.getInstance().setBoundsFromBoundingBox(e)},getDirections:function(e,t,n){this.getInstance().getDirections(e,t,n)},geocode:function(e,t,n,r){this.getInstance().geocode(e,t,n,r)},displayInfobox:function(e){this.getInstance().displayInfobox(e)}}),"SDS"in window||(window.SDS={}),SDS.GoogleMap=Base.extend({constructor:function(e){window.__bingMapInstance=this,SDS.GoogleMap.Instances.push(this),this.instanceIndex=SDS.GoogleMap.Instances.length,this.container=e.container,this.mapContainer=document.createElement("div"),this.mapContainer.className="google-map-container mapcontainer-"+this.instanceIndex,this.mapContainer.id="google-map-"+this.instanceIndex,this.toolbarContainer=document.createElement("div"),this.toolbarContainer.className="google-map-toolbar-container drawingtoolbar-"+this.instanceIndex,this.clientID=e.clientID||REModel.Session.getSetting("Google.Maps.ClientID"),this.channelID=e.channelID||REModel.Session.getSetting("Google.Maps.Channel"),this.culture=e.culture||"en-us",this.mapControlSource=e.mapControlSource||"https://maps.googleapis.com/maps/api/js?client="+this.clientID+"&channel="+this.channelID+"&libraries=drawing,geometry,places&v=3.26&callback=SDS.GoogleMap.MapReady",this.key=e.key,this.location=e.location,this.zoom=e.zoom||14,this.zoomForSingleListing=e.zoomForSingleListing,this.initialType=e.initialType||"auto",this.modulePath=e.modulePath||"../../",this.showDashboard=typeof e.showDashboard!="undefined"?e.showDashboard:!0,this.showMapTypeSelector=typeof e.showMapTypeSelector!="undefined"?e.showMapTypeSelector:!0,this.showScalebar=typeof e.showScalebar!="undefined"?e.showScalebar:!0,this.changeHandler=e.changeHandler||null,this.loadHandler=e.loadHandler||null,this.clickHandler=e.clickHandler||null,this.resizeHandler=e.resizeHandler||null,this.mapShapeChangeHandler=e.mapShapeChangeHandler||null,this.viewChangeStartHandler=e.viewChangeStartHandler||null,this.clearShapeHandler=e.clearShapeHandler||null,this.showLegendHandler=e.showLegendHandler||null,this.drawingModeChangeHandler=e.drawingModeChangeHandler||null,this.features=e.features||{},this.mapService=e.mapService,"getElement"in this.container?this.container=this.container.getElement():typeof this.element=="string"&&(this.container=jQuery(this.container)),this.container.appendChild(this.mapContainer),this.container.appendChild(this.toolbarContainer),this.wktShapes=[],this.deferred=e.deferred||!1,this.deferred||this.initMaps();if(this.features.logUsage)try{(new REModel.Services.LogService).logMapAccess("newobject"),(new REModel.Services.LogService).logMapAccess(this.key,"credentials")}catch(t){_log(t)}this.requiredModules={},this.auth=REModel.Session.getAuth()||{},this.changeCount=0},show:function(){!this.mapInitialized&&this.deferred&&this.initMaps()},createMap:function(e){var t=this;$parent=jQuery(this.mapContainer).parent(),$parent.outerWidth()==0&&$parent.css("position")=="absolute"&&$parent.css({top:"0px",bottom:"0px",left:"0px",right:"0px"}),this.availableMapTypes={};var n=this.location;typeof this.location.latitude!="undefined"&&(n=new google.maps.LatLng(this.location.latitude,this.location.longitude)),this.map=new google.maps.Map(this.mapContainer,{center:n,zoom:this.zoom,contextMenu:!0,streetViewControl:!0,scaleControl:!0,tilt:0}),this.clickHandler&&this.map.addListener("click",function(e){t.clickHandler(e)}),this.resizeHandler&&this.map.addListener("resize",function(e){t.resizeHandler(e)}),t.viewChangeStartHandler&&this.map.addListener("bounds_changed",function(e){t.viewChangeStartHandler()}),this.map.addListener("maptypeid_changed",function(e){t.mapTypeChange(t.map.getMapTypeId())}),this.map.addListener("idle",function(e){t.mapInitialized||(t.mapInitialized=!0,t.mapLoaded());if(t.hidden&&jQuery(t.container).is(":visible")){t.hidden=!1;return}if(!jQuery(t.container).is(":visible")){t.hidden=!0;return}t.mapChanged()}),this.infobox=new InfoBox({closeBoxURL:"",infoBoxClearance:new google.maps.Size(1,1),enableEventPropagation:!1,disableAutoPan:!0}),this.layers={},this.features.drawing,this.addLayer("standardShapeLayer"),this.addLayer("placesLayer"),this.addLayer("pinLayer"),this.addLayer("infoLayer"),this.addLayer("locationsLayer"),this.features.drawing&&this.addDrawingTools(this.features.drawing,e)},getPinHtml:function(e){var t=e.iconCssBase||"map-pushpin",n=e.cssClass||"",r=e.label||"",i=e.width||24,s=e.height||24;return'<div class="'+t+" "+n+'" style="pointer-events: all; width: '+i+"px;height: "+s+'px;"><div class="text">'+r+"</div></div>"},clear:function(e){if(!this.layers)return;if(e&&!this.layers[e])return;if(!e)for(var t in this.layers)this.clear(e);else if(this.layers[e]&&this.layers[e].clear)this.layers[e].clear();else{e=="pinLayer"&&this.markerClusterer&&(this.markerClusterer.setMap(null),this.markerClusterer=null);for(var n=0,r=this.layers[e].length;n<r;n++)this.layers[e][n].setMap(null);this.layers[e]=[]}},clearShapes:function(){this.drawingTools&&this.drawingTools.clearShapes()},clearPushpins:function(){this.clear("pinLayer")},removePushpin:function(e,t){e.setMap(null),this.layers[t||"pinLayer"].length==1&&(this.layers[t||"pinLayer"]=[])},addPushpin:function(e){var t=this,n=this.createPushpin(e);this.features.clusters&&(this.markerClusterer||(this.markerClusterer=new MarkerClusterer(this.map,this.layers.pinLayer,{gridSize:35,clusterClass:"map-pushpin map-overlapping-marker icon-24",imageSizes:[24,24,24,24,24],styles:[],zoomOnClick:!1,ignoreHidden:!0,zIndex:20}),this.pushPinBindEvents(this.markerClusterer,e)),this.markerClusterer.addMarker(n)),this.layers.pinLayer.push(n)},createPushpin:function(e,t){var n=this;typeof e=="undefined"&&(e={});var r=e.location||null;if(e.basic){var i=new google.maps.Marker({map:n.map,position:{lat:r[0],lng:r[1]},draggable:e.draggable});return i}var s=e.data,o=e.infoboxContent||null;e.title&&e.body&&(o='<div class="VE_Pushpin_Popup_Title">'+e.title+"</div>"+'<div class="VE_Pushpin_Popup_Body">'+e.body+"</div>");var u=typeof e.draggable!="undefined"?e.draggable:!1;if(!r)return;s||(s={});var i=new RichMarker({map:n.map,position:new google.maps.LatLng(r[0],r[1]),draggable:e.draggable,flat:!0,anchor:RichMarkerPosition.MIDDLE,contextMenu:!0,content:e.htmlContent||this.getPinHtml(e),zIndex:20});return o&&(i.infoboxContent=o,e.infoboxHandleClick&&(i.infoboxHandleClick=e.infoboxHandleClick)),e.infoboxLoader&&(i.infoboxLoader=e.infoboxLoader),s&&(i.data=[s]),e.layer&&(this.layers[e.layer]||(this.layers[e.layer]=[]),this.layers[e.layer].push(i)),this.pushPinBindEvents(i,e),i},addLayer:function(e,t,n){this.layerIndexMap||(this.layerIndexMap={}),this.layers[e]=[]},pushPinBindEvents:function(e,t){var n=this;if(e.infoboxContent)google.maps.event.addListener(e,"click",function(t){n.displayInfobox(t||e)}),google.maps.event.addListener(e,"mouseover",function(t){n.displayInfobox(t||e)}),google.maps.event.addListener(e,"mouseout",function(t){n.hideInfobox(t||e)});else{var r=t.click||null,i=t.mouseover||null,s=t.mouseout||null;r&&google.maps.event.addListener(e,"click",function(t){r(t||e)}),i&&google.maps.event.addListener(e,"mouseover",function(t){i(t||e)}),s&&google.maps.event.addListener(e,"mouseout",function(t){s(t||e)})}},addPolyline:function(e,t){t=t||{},t.geodesic=!0,t.strokeColor=t.strokeColor||"#245080",t.strokeWeight=t.strokeWeight||5,t.strokeOpacity=t.strokeOpacity||.7;if(e.length&&e.length>0){t.path=e;var n=new google.maps.Polyline(t);this.layers.standardShapeLayer.push(n),n.setMap(this.map)}},displayInfobox:function(e){var t=this;if(this.isDrawing||this.drawingTools&&this.drawingTools.isEditing)return;if(e){if(jQuery("#MasterDynamicBody.hide-listings-map").length>0&&e._htmlContent&&e._htmlContent.indexOf("show-when-listing-hidden")==-1)return;this.__hideTimeout&&window.clearTimeout(this.__hideTimeout);if(e.infoboxLoader){e.infoboxLoader(function(n){e.infoboxContent=n,t.displayInfobox(e)}),e.infoboxLoader=null;return}var n=(new Date).getTime(),r=e.infoboxContent||e.content,i=jQuery('<div class="infobox-content"></div>').append(r),s=jQuery('<div class="infobox-container" id="ib'+n+'"><div class="infobox-arrow"></div></div>').append(i),o=jQuery('<div class="prerender" style="position: absolute; left: -1000px; top: -1000px;"></div').append(s).appendTo("body"),u=o.width(),a=o.height();!e.getPosition&&e.getCenter&&(e.getPosition=e.getCenter);var f=this.getLatLngPosition(e.getCenter?e.getCenter():e.position),l=f.quadrant,c=24;switch(l){case 0:jQuery(".infobox-arrow",o).addClass("top-left"),f.y-=c/2,f.x+=c/2;break;case 1:jQuery(".infobox-arrow",o).addClass("top-right"),f.y-=c/2,f.x-=u+c/2;break;case 2:jQuery(".infobox-arrow",o).addClass("bottom-left"),f.y-=a-c/2,f.x+=c/2;break;case 3:jQuery(".infobox-arrow",o).addClass("bottom-right"),f.y-=a-c/2,f.x-=u+c/2}this.infobox.setVisible(!1),this.infobox.setContent(o.html()),this.infobox.open(t.map,e),this.infobox.setPosition(this.pointToLatLng(f)),this.infobox.setVisible(!0),this.map.setOptions({scrollwheel:!1}),o.remove(),window.setTimeout(function(){var r="#ib"+n;jQuery(r).off("mouseover").off("mouseout").off("click").on("mouseover",function(){t.__hideTimeout&&window.clearTimeout(t.__hideTimeout)}).on("mouseout",function(){t.hideInfobox()}),e.infoboxHandleClick&&jQuery(r).on("click",function(t){e.infoboxHandleClick(t,e)})},10)}},getLatLngPosition:function(e){var t=this.map.getProjection().fromLatLngToPoint(this.map.getBounds().getNorthEast()),n=this.map.getProjection().fromLatLngToPoint(this.map.getBounds().getSouthWest()),r=Math.pow(2,this.map.getZoom()),i=this.map.getProjection().fromLatLngToPoint(e),s=new google.maps.Point((i.x-n.x)*r,(i.y-t.y)*r),o=Math.abs((t.x-n.x)*r),u=Math.abs((t.y-n.y)*r),a=0;return s.y<=u/2?a=s.x<=o/2?0:1:a=s.x<=o/2?2:3,{map:{width:o,height:u},x:s.x,y:s.y,quadrant:a}},pointToLatLng:function(e){var t=this.map.getProjection().fromLatLngToPoint(this.map.getBounds().getNorthEast()),n=this.map.getProjection().fromLatLngToPoint(this.map.getBounds().getSouthWest()),r=Math.pow(2,this.map.getZoom()),i=new google.maps.Point(e.x/r+n.x,e.y/r+t.y);return this.map.getProjection().fromPointToLatLng(i)},hideInfobox:function(e){this.infoboxVisible=!1;var t=this;this.__hideTimeout&&window.clearTimeout(this.__hideTimeout),this.__hideTimeout=window.setTimeout(function(){t.infobox.hide(),t.map.setOptions({scrollwheel:!0})},250)},toggleDrawingTools:function(e){e?jQuery(".drawingtoolbar-"+this.instanceIndex).show():jQuery(".drawingtoolbar-"+this.instanceIndex).hide()},reinitMap:function(){var e=[];for(layerName in this.layers)e.push(this.getLayerDataByName(layerName));this.layers={},this.layerIndexMap={},jQuery(".drawingToolsToolbar",".drawingtoolbar-"+this.instanceIndex).remove(),this.location=this.map.getCenter(),this.zoom=this.map.getZoom(),this.initialType=this.map.getMapTypeId(),this.createMap(!0),this.restoreLayers(e)},getLayerDataByName:function(e){var t=[],n=this.layerIndexMap[e],r=this.map.entities.get(n);for(var i=0,s=r.getLength();i<s;i++)t.push(r.removeAt(i));return{index:n,name:e,entities:t}},restoreLayers:function(e){e.sort(function(e,t){return e.index>t.index?1:e.index<t.index?-1:0});for(var t=0;t<e.length;t++){var n=this.layers[e[t].name];if(n)for(var r=0;r<e[t].entities.length;r++)e[t].entities[r]&&n.push(e[t].entities[r])}},addDrawingTools:function(e,t){var n=this;if(this._drawingToolsAdded&&!t)return;this._drawingToolsAdded=!0,this.drawingTools=new SDS.GoogleMap.DrawingTools({map:this.map,modulePath:this.modulePath,changed:function(e){n.drawingChanged("changed",e)},drawingModeChanged:function(e){n.drawingModeChanged(e)},drawingCleared:function(){n.drawingCleared()},defaultUnits:this.features.defaultUnits||"mi",unionHandler:this.mapService?function(e){var t=n.getShapes(),r=[];for(var i=0,s=t.length;i<s;i++)t[i]!=e&&r.push(t[i]);n.mapService.unionShapes(e,r,function(e){if(e&&e.length>0){n.drawingTools.clearShapes();for(var t=0,r=e.length;t<r;t++)n.drawingTools.addShape(e[t]);n.mapChanged(!0)}})}:!1,excludeHandler:this.mapService?function(e){var t=n.getShapes(),r=[];for(var i=0,s=t.length;i<s;i++)t[i]!=e&&r.push(t[i]);n.mapService.excludeShapes(e,r,function(e){if(e&&e.length>0){n.drawingTools.clearShapes();for(var t=0,r=e.length;t<r;t++)n.drawingTools.addShape(e[t]);n.mapChanged(!0)}})}:!1})},drawingChanged:function(e,t){this.mapShapeChangeHandler?this.mapShapeChangeHandler(t):this.mapChanged(!0)},drawingCleared:function(){this.clearPushpins(),this.clearShapeHandler&&this.clearShapeHandler()},drawingModeChanged:function(e){e=(e||"").toLowerCase(),e=="polygon"||e=="circle"||e=="rectangle"?this.isDrawing=!0:this.isDrawing=!1,this.drawingModeChangeHandler&&this.drawingModeChangeHandler(e)},getShapes:function(){return!this.drawingTools||!this.drawingTools.shapes?[]:this.drawingTools.shapes},hasShapes:function(){return this.getShapes().length>0},mapLoaded:function(){this.loadHandler&&this.loadHandler(),this.addCustomMapControls()},addCustomMapControls:function(){var e=this;if(this.showLegendHandler||this.features.mapArt){var t=jQuery('<ul class="legend-control custom"></ul>');if(this.showLegendHandler){var n=jQuery('<li class="legend" title="Display Legend"><span>Legend</span></li>');t.append(n),n.on("click",function(){e.showLegendHandler()})}if(this.features.mapArt){this.mapServer=location.href.toLowerCase().indexOf("/live")==0?"http://dev2.stratusmls.com/":"http://www.torontomls.net/",this.customLayers=[{name:"art",label:"MapArt",index:0,tileURL:this.mapServer+"Maps/MapArt/Layer_MapArt/{quadkey}.png"},{name:"grid",label:"Grid",index:1,tileURL:this.mapServer+"Maps/MapArt/Layer_GridLayer/{quadkey}.png"},{name:"area",label:"Areas",index:2,tileURL:this.mapServer+"BingCommunitiesMap/BingMapData/Layer_Areas/{quadkey}.png"},{name:"muni",label:"Municipalities",index:3,tileURL:this.mapServer+"BingCommunitiesMap/BingMapData/Layer_Municipalities/{quadkey}.png"},{name:"comm",label:"Communities",index:4,tileURL:this.mapServer+"BingCommunitiesMap/BingMapData/Layer_Communities/{quadkey}.png"}];var r=jQuery('<li class="art-container menu" title="Display MapArt"><span>Map Layers</span></li>'),i=jQuery('<ul class="art-control custom"></ul>');for(var s=0;s<this.customLayers.length;s++)jQuery('<li data-name="'+this.customLayers[s].name+'" title="Display '+this.customLayers[s].label+'"><span>'+this.customLayers[s].label+"</span></li>").appendTo(i).click(function(){e.showMapArt(jQuery(this).data("name")),jQuery(this).toggleClass("selected")});r.append(i),t.append(r)}this.map.controls[google.maps.ControlPosition.TOP_LEFT].push(t.get(0))}},showLegend:function(){this.showLegendHandler&&this.showLegendHandler()},_tileToQuadKey:function(e,t,n){var r="";for(var i=n;i>0;i--){var s=1<<i-1,o=0;(e&s)!=0&&o++,(t&s)!=0&&(o+=2),r+=o}return r},showMapArt:function(e){var t=this;for(var n=0;n<this.map.overlayMapTypes.length;n++)this.map.overlayMapTypes.setAt(n,null);for(var n=0;n<this.customLayers.length;n++)this.customLayers[n].name==e&&(this.customLayers[n].enabled=!this.customLayers[n].enabled),this.customLayers[n].enabled&&this.insertMapOverlay(this.customLayers[n]),this.map.overlayMapTypes.length<this.customLayers[n].index&&this.map.overlayMapTypes.insertAt(this.customLayers[n].index,null)},insertMapOverlay:function(e){var t=this,n=new google.maps.ImageMapType({getTileUrl:function(n,r){return e.tileURL.replace("{quadkey}",t._tileToQuadKey(n.x,n.y,r))},tileSize:new google.maps.Size(256,256),name:e.name});this.map.overlayMapTypes.insertAt(e.index,n)},triggerResize:function(){jQuery(this.mapContainer).is(":visible")&&google.maps.event.trigger(this.map,"resize")},mapChanged:function(e){var t=this;this.changeCount++;if(this.changeCount==1)return;SDS.GoogleMap.__searchTimeout&&clearTimeout(SDS.GoogleMap.__searchTimeout),SDS.GoogleMap.__searchTimeout=window.setTimeout(function(){t.bounds=t.map.getBounds(),t.northeast=t.bounds.getNorthEast(),t.southwest=t.bounds.getSouthWest(),t.center=t.bounds.getCenter(),t.changeHandler&&t.changeHandler({bounds:{northwest:[t.northeast.lat(),t.southwest.lng()],southeast:[t.southwest.lat(),t.northeast.lng()],center:[t.center.lat(),t.center.lng()]},zoom:t.map.getZoom(),shapes:t.getShapes()})},500)},mapTypeChange:function(e){if(this.drawingTools){if(!("Microsoft"in window))return;var t=(e||"").indexOf("Birdseye")!=-1?"Birdseye":e;if(t!=this._prevMapType){this._prevMapType=t;var n={};t=="Birdseye"||t=="Aerial"?(n={strokeThickness:1,strokeColor:new Microsoft.Maps.Color(200,255,255,255),fillColor:new Microsoft.Maps.Color(100,255,255,255)},t=="Birdseye"?this.layers.customTileLayer.getVisible()&&(this.layers.customTileLayer.setOptions({visible:!1}),this.enableMapArtWhenAvailable=!0):this.enableMapArtWhenAvailable&&this.layers.customTileLayer.setOptions({visible:!0})):(n={strokeThickness:1,strokeColor:new Microsoft.Maps.Color(200,36,80,128),fillColor:new Microsoft.Maps.Color(51,66,139,202)},this.enableMapArtWhenAvailable&&this.layers.customTileLayer.setOptions({visible:!0})),this.drawingTools.setShapeOptions(n)}}},initMaps:function(){var e=this,t="3.54.2";this.scriptResources=[{name:"googlemapsapi",src:this.mapControlSource,loaded:function(){return"google"in window&&google.maps&&google.maps.Map}},{name:"infobox",src:this.modulePath+"External/GoogleMaps/infobox.js?c="+t,loaded:function(){return typeof InfoBox!="undefined"}},{name:"richmarker",src:this.modulePath+"External/GoogleMaps/richmarker.js?c="+t,loaded:function(){return typeof RichMarkerPosition!="undefined"}},{name:"markerclusterer",src:this.modulePath+"External/GoogleMaps/markerclusterer.js?c="+t,loaded:function(){return typeof MarkerClusterer!="undefined"}}],this.mapResourcesLoaded()?this.createMap():(jQuery.ajaxSetup({cache:!0}),jQuery.getScript(this.scriptResources[0].src,function(){e._mapLoadInterval=window.setInterval(function(){e.scriptResources[0].loaded()&&(window.clearInterval(e._mapLoadInterval),e.loadResources())},150)}),jQuery.ajaxSetup({cache:!1}),this._loadInterval=window.setInterval(function(){e.mapResourcesLoaded()&&(window.clearInterval(e._loadInterval),e.createMap())},150))},loadResources:function(){for(var e=1,t=this.scriptResources.length;e<t;e++)jQuery.ajaxSetup({cache:!0}),jQuery.getScript(this.scriptResources[e].src,function(){}),jQuery.ajaxSetup({cache:!1})},mapResourcesLoaded:function(){var e=!0;if(this.scriptResources)for(var t=0,n=this.scriptResources.length;t<n;t++)if(!this.scriptResources[t].loaded()){e=!1;break}return e},getBounds:function(){return this.map.getBounds()},getBoundingRectangle:function(e){var t=this.map.getBounds(),n=t.getNorthEast(),r=t.getSouthWest(),i=new google.maps.LatLng(n.lat(),r.lng()),s=new google.maps.LatLng(r.lat(),n.lng()),o=[];return o.push([i.lng(),i.lat()]),o.push([s.lng(),i.lat()]),o.push([s.lng(),s.lat()]),o.push([i.lng(),s.lat()]),o.push([i.lng(),i.lat()]),e?[o[0].join(" "),o[1].join(" "),o[2].join(" "),o[3].join(" "),o[4].join(" ")].join(", "):o},getCenter:function(){return this.map.getBounds().getCenter()},getZoomLevel:function(){return this.map.getZoom()},getMapStyle:function(){return this.map.getMapTypeId()},setCenter:function(e,t,n){var r=this;if(!this.map){this._setCenterTimeout&&window.clearTimeout(this._setCenterTimeout),this._setCenterTimeout=window.setTimeout(function(){r.setCenter(e,t,n)},100);return}var i={};e&&(i.center=e.lat?e:new google.maps.LatLng(e.latitude,e.longitude)),t&&!isNaN(parseFloat(t))&&(i.zoom=parseFloat(t)),n&&_log("not implemented setCenter, mapTypeID ",mapTypeID),i.center&&this.map.setCenter(i.center),i.zoom&&this.map.setZoom(i.zoom)},setCenterFromGeocodeResults:function(e,t){if(e&&e.resourceSets&&e.resourceSets.length>0&&e.resourceSets[0].resources&&e.resourceSets[0].resources.length>0){var n=e.resourceSets[0].resources[0].point.coordinates,r={latitude:n[0],longitude:n[1]};this.setCenter(r,t)}},SetScaleBarDistanceUnit:function(e){},getCredentials:function(e){var t=this;return _log("not implemented","getCredentials"),""},getDirections:function(e,t,n){var r=this,i={};t=t||{},t.optimize||(t.optimize="time");if(!this.map)return;this.directionsService||(this.directionsService=new google.maps.DirectionsService),i.travelMode="DRIVING",i.provideRouteAlternatives=!1,i.drivingOptions={departureTime:new Date,trafficModel:t.optimize=="timeWithTraffic"?"bestguess":"optimistic"},i.unitSystem=t.distanceUnit?t.distanceUnit.toLowerCase()=="kilometer"?google.maps.UnitSystem.METRIC:google.maps.UnitSystem.IMPERIAL:google.maps.UnitSystem.IMPERIAL,i.waypoints=[];for(var s=0;s<e.length;s++)s==0?i.origin=e[s].length&&e[s].length==2?e[s][0]+","+e[s][1]:e[s]:s==e.length-1?i.destination=e[s].length&&e[s].length==2?e[s][0]+","+e[s][1]:e[s]:i.waypoints.push({location:t.destination=e[s].length&&e[s].length==2?e[s][0]+","+e[s][1]:e[s],stopover:!0});i.origin=i.origin.replace(/(^.*)\s([a-z]{1}\d{1}[a-z]{1})(?:[\s]?)(\d{1}[a-z]{1}\d{1})$/gim,"$1 $2"),i.destination=i.destination.replace(/(^.*)\s([a-z]{1}\d{1}[a-z]{1})(?:[\s]?)(\d{1}[a-z]{1}\d{1})$/gim,"$1 $2"),this.directionsService.route(i,function(e,t){if(t!=="OK"){n({errorDetails:t});return}n(e)})},geocode:function(e,t,n,r){var i=this;this.geocoder||(this.geocoder=new google.maps.Geocoder),this.geocodeResults||(this.geocodeResults={});if(t&&this.geocodeResults[e]){this.setCenter(this.geocodeResults[e].location,r),n&&n(this.geocodeResults[e].results);return}var s=this.auth.appName=="TREB"?"CA":"US";this.auth.appName=="TREB"&&(s="CA",e=e.replace(/([a-z]\d[a-z])(\d[a-z]\d)/gi,"$1 $2")),this.geocoder.geocode({address:e,region:s},function(s,o){o=="OK"&&(s&&s.length>0&&(i.geocodeResults[e]={location:s[0].geometry.location,results:s},t&&i.setCenter(s[0].geometry.location,r)),n&&n(s))})},find:function(e,t,n){var r=this;this.placesService||(this.placesService=new google.maps.places.PlacesService(this.map)),this.placesService.nearbySearch({keyword:e.what,bounds:this.map.getBounds()},function(e,r){r==google.maps.places.PlacesServiceStatus.OK?t(e):n("Unspecified Error Occured")})},getPlaceDetails:function(e,t){this.placesService.getDetails(e,function(e,n){if(n!==google.maps.places.PlacesServiceStatus.OK){t(n);return}var r='<span style="font-weight: bold; display: block; max-width: 250px; text-overflow: ellipsis; overflow: hidden; white-space: nowrap;">'+e.name+"</span>"+(e.adr_address?e.adr_address+"<br/>":"")+(e.formatted_phone_number?e.formatted_phone_number+"</br>":"")+(e.website?'<a href="'+e.website+'" target="_blank" style="display: block; max-width: 250px; text-overflow: ellipsis; overflow: hidden; white-space: nowrap;">'+e.website+"</a>":"");t(r)})},setShapes:function(e){},setPolygon:function(e){if(typeof e=="string"){var t=e;t.indexOf("((")==-1&&(t="POLYGON(("+t+"))"),this.drawingTools.addShape(t)}else{var t=[];e.forEach(function(e){e.lat?t.push([e.lng(),e.lat()].join(" ")):t.push(e[1]+" "+e[0])}),this.drawingTools.addShape("POLYGON(("+t.join(",")+"))")}},setRadius:function(e,t){},getShapeBounds:function(){return this.drawingTools.getShapeBounds()},setBoundsFromPushpins:function(){var e=this.layers.pinLayer,t=(e||[]).length,n=this,r=jQuery(this.map.getDiv()).width();if(!r||r<10){window.setTimeout(function(){n.setBoundsFromPushpins()},100);return}this.clusterablePins=this.clusterablePins||[];if(t>0||this.clusterablePins.length>0){var i=[],s=new google.maps.LatLngBounds;for(var o=0;o<t;o++){var u=e[o].position;u.lat()&&(i.push(u),s.extend(u))}for(var o=0,a=this.clusterablePins.length;o<a;o++){var f=this.clusterablePins[o];f.position&&(i.push(f.position),s.extend(f.position))}if(s){var l=this.zoomForSingleListing&&this.zoomForSingleListing();i.length==1&&l?this.setCenter(i[0],l):this.setBounds(s)}}},setBoundsFromShapes:function(){var e=this.getShapeBounds();e&&this.setBounds(e)},setBoundsFromBoundingBox:function(e){var t=new google.maps.LatLngBounds;t.extend(new google.maps.LatLng(e[0],e[1])),t.extend(new google.maps.LatLng(e[2],e[3])),this.setBounds(t)},setBounds:function(e){this.map.fitBounds(e)},initPrint:function(){var e=0,t=this.map.getMapTypeId();return t=="roadmap"?e=0:t=="hybrid"?e=1:t=="satellite"&&(e=2),e}},{Instances:[],MapReady:function(){return!0},PushpinIcons:{red:"Images/Icons/PNG/24/84.png",magenta:"Images/Icons/PNG/24/150.png",cyan:"Images/Icons/PNG/24/152.png",green:"Images/Icons/PNG/24/86.png",blue:"Images/Icons/PNG/24/88.png",yellow:"Images/Icons/PNG/24/82.png",gray:"Images/Icons/PNG/24/151.png"}}),"SDS"in window||(window.SDS={}),SDS.GoogleMapIFrame=Base.extend({constructor:function(e){window.__bingMapInstance=this,SDS.BingMap.Instances.push(this),this.instanceIndex=SDS.BingMap.Instances.length,this.container=e.container,this.changeHandler=e.changeHandler||null,this.loadHandler=e.loadHandler||null,this.clickHandler=e.clickHandler||null,this.resizeHandler=e.resizeHandler||null,this.mapShapeChangeHandler=e.mapShapeChangeHandler||null,this.viewChangeStartHandler=e.viewChangeStartHandler||null,this.clearShapeHandler=e.clearShapeHandler||null,this.drawingModeChangeHandler=e.drawingModeChangeHandler||null,this.features=e.features,this.init=e,window.SDSBingMapInitialization=e,this.modulePath=e.modulePath||"../../",this.initIFrame()},initIFrame:function(){this.iframeID="sds-bingmap-frame-"+this.instanceIndex,jQuery(this.container.$getElement?this.container.$getElement():this.container).append('<iframe name="'+this.iframeID+'" id="'+this.iframeID+'" src="'+this.modulePath+'Controls/Map/BingMapIFrame.html" width="100%" height="100%" style="display:none" onload="this.style.display=\'block\';" allowTransparency="true" frameborder="0" marginheight="0" marginwidth="0" style=""></iframe>')},getInstance:function(){return this.iframe||(this.iframe=jQuery("#"+this.iframeID).get(0).contentWindow.SDSBingMapInstance),this.iframe},clear:function(e){this.getInstance().clear(e)},clearShapes:function(e){this.getInstance().clearShapes(e)},clearPushpins:function(){this.getInstance().clearPushpins()},removePushpin:function(e,t){this.getInstance().removePushpin(e,t)},addPushpin:function(e){this.getInstance().addPushpin(e)},createPushpin:function(e,t){this.getInstance().createPushpin(e,t)},addLayer:function(e,t,n){this.getInstance().addLayer(e,t,n)},addPolyline:function(e,t){this.getInstance().addPolyline(e,t)},toggleDrawingTools:function(e){this.getInstance().toggleDrawingTools(e)},getShapes:function(e){return this.getInstance().getShapes()},hasShapes:function(){return this.getInstance().hasShapes()},mapLoaded:function(){this.loadHandler&&this.loadHandler()},mapChanged:function(e){this.changeHandler&&this.changeHandler(e)},drawingChanged:function(e,t){this.mapShapeChangeHandler?this.mapShapeChangeHandler(t):this.mapChanged(!0)},drawingCleared:function(){this.clearPushpins(),this.clearShapeHandler&&this.clearShapeHandler()},drawingModeChanged:function(){this.drawingModeChangeHandler&&this.drawingModeChangeHandler()},getBounds:function(){return this.getInstance().getBounds()},getBoundingRectangle:function(e){return this.getInstance().getBoundingRectangle(e)},getCenter:function(){return this.getInstance().getCenter()},getZoomLevel:function(){return this.getInstance().getZoomLevel()},getMapStyle:function(){return this.getInstance().getMapStyle()},setCenter:function(e,t,n){this.getInstance().setCenter(e,t,n)},setCenterFromGeocodeResults:function(e,t){this.getInstance().setCenterFromGeocodeResults(e,t)},SetScaleBarDistanceUnit:function(e){this.getInstance().SetScaleBarDistanceUnit(e)},getCredentials:function(e){throw new Exception("cannot get credentials on iframe instance")},getDirections:function(e,t,n){this.getInstance().getDirections(e,t,n)},geocode:function(e,t,n,r){this.getInstance().geocode(e,t,n,r)},find:function(e,t,n){this.getInstance().find(e,t,n)},setShapes:function(e){this.getInstance().setShapes(e)},setPolygon:function(e){this.getInstance().setPolygon(e)},setRadius:function(e,t){this.getInstance().setRadius(polygonPointsArray)},getShapeBounds:function(){return this.getInstance().getShapeBounds()},setBoundsFromPushpins:function(){this.getInstance().setBoundsFromPushpins()},setBoundsFromShapes:function(){this.getInstance().setBoundsFromShapes()},setBoundsFromBoundingBox:function(e){this.getInstance().setBoundsFromBoundingBox(e)},setBounds:function(e){this.getInstance().setBounds(e)},getDirections:function(e,t,n){this.getInstance().getDirections(e,t,n)},geocode:function(e,t,n,r){this.getInstance().geocode(e,t,n,r)},displayInfobox:function(e){this.getInstance().displayInfobox(e)}}),SDS.GoogleMap.DrawingTools=Base.extend({constructor:function(e){var t=this;this.map=e.map,this.modulePath=e.modulePath,this.changed=e.changed||function(e){_log(e)},this.drawingCleared=e.drawingCleared||function(){},this.drawingModeChangeHandler=e.drawingModeChanged,this.defaultUnits=e.defaultUnits,this.shapeFormat=e.format||"WKT",this.drawing=!1,this._shapes=[],this.shapeOptions={fillColor:"#245080",draggable:!1,editable:!0,strokeWeight:1},this.drawingManager=new google.maps.drawing.DrawingManager({drawingControl:!1,circleOptions:this.shapeOptions,polygonOptions:this.shapeOptions,rectangleOptions:this.shapeOptions}),this.unionHandler=e.unionHandler,this.excludeHandler=e.excludeHandler,this.drawingManager.setMap(this.map),this.map.data.addListener("setgeometry",function(e){t._shapesChanged()}),this._createControls()},clearShapes:function(e){var t=this;jQuery(".clear, .exclude, .union",this.drawingToolsElement).addClass("disabled"),this._clearDrawingMode();if(!this._shapes||this._shapes.length==0)return;this.map.data.forEach(function(e){t.map.data.remove(e)});for(var n=0,r=this._shapes.length;n<r;n++)this._shapes[n].setMap&&(this._shapes[n]._radiusBorderMarker&&(this._shapes[n]._radiusBorderMarker.setMap(null),this._shapes[n]._radiusCenterMarker.setMap(null)),this._shapes[n].setMap(null));this._shapes=[],e||(this._shapesChanged(),this.drawingCleared&&this.drawingCleared())},getSelectedShape:function(e){var t=this;if(this._selected){if(this._selected.setMap){var n=this._overlayToPolygon(t._selected);return e(Terraformer.WKT.convert(n))}this._selected.toGeoJson(function(t){e(Terraformer.WKT.convert(t.geometry))})}},getShapes:function(e){var t=this;this.shapes=[],this.map.data.toGeoJson(function(n){var r=[];if(t.shapeFormat=="WKT"){for(var i=0,s=n.features.length;i<s;i++){if((n.features[i].geometry.type||"").toLowerCase()=="polygon"&&n.features[i].geometry.coordinates[0].length<=3)continue;r.push(Terraformer.WKT.convert(n.features[i].geometry))}for(var i=0,s=t._shapes.length;i<s;i++){if(!t._shapes[i].setMap)continue;var o=t._overlayToPolygon(t._shapes[i]);if((o.type||"").toLowerCase()=="polygon"&&o.coordinates[0].length<=3)continue;r.push(Terraformer.WKT.convert(o))}}else{for(var i=0,s=n.features.length;i<s;i++)r.push(n.features[i].geometry);for(var i=0,s=t._shapes.length;i<s;i++){if(!t._shapes[i].setMap)continue;r.push(t._overlayToPolygon(t._shapes[i]))}}return t.shapes=r,e(r)})},addShape:function(e){try{if(typeof e=="object")this._addGeoJson(e);else if(e.indexOf("{")!="-1")this._addGeoJson(JSON.parse(e));else{var t=Terraformer.WKT.parse(e);this._addGeoJson(t)}}catch(n){_log(n)}},_createControls:function(){var e=this,t="background-image: url('"+this.modulePath+"External/GoogleMaps/DrawingTools_ToolbarIcons.png'); background-repeat: no-repeat",n=jQuery('<ul class="drawing-controls custom"></ul>'),r=jQuery('<li class="polygon" data-type="POLYGON" style="'+t+'" title="Draw a polygon"><span>P</span></li>'),i=jQuery('<li class="circle" data-type="CIRCLE" style="'+t+'" title="Draw a circle"><span>C</span></li>'),s=jQuery('<li class="rectangle" data-type="RECTANGLE" style="'+t+'" title="Draw a rectangle"><span>R</span></li>'),o=jQuery('<li class="clear disabled" data-type="clear" style="'+t+'" title="Erase all shapes"><span>E</span></li>');n.append(r),n.append(i),n.append(s),n.append(jQuery('<li class="separator"><span>S></span></li>')),this.unionHandler&&(n.append(jQuery('<li class="union disabled" data-type="union" style="'+t+'" title="Select a shape to combine with any intersecting shapes"><span>U</span></li>')),n.append(jQuery('<li class="exclude disabled" data-type="exclude" style="'+t+'" title="Select a shape to exclude from any intersecting shapes"><span>E</span></li>')),n.append(jQuery('<li class="separator"><span>S></span></li>'))),n.append(o),this.drawingToolsElement=n.get(0),this.drawingToolsElement.index=1,jQuery("li",n).on("click",function(){e._toggleDrawingMode(jQuery(this).data("type"))}),this.map.controls[google.maps.ControlPosition.TOP_RIGHT].push(this.drawingToolsElement),this.map.data.setStyle(function(e){return e,{fillColor:"#245080",draggable:!1,editable:!0,strokeWeight:1,clickable:!1}})},_clearDrawingMode:function(){this.map.data.setDrawingMode(null),this.drawingManager.setDrawingMode(null),google.maps.event.clearListeners(this.map.data,"addfeature"),google.maps.event.clearListeners(this.drawingManager,"overlaycomplete"),this.map.setOptions({draggable:!0}),this.map.setOptions({draggableCursor:""});if(this.__drawHandles)for(var e=0;e<this.__drawHandles.length;e++)google.maps.event.removeListener(this.__drawHandles[e]);if(this.__selectHandles)for(var e=0;e<this.__selectHandles.length;e++)google.maps.event.removeListener(this.__selectHandles[e]);this._selected&&delete this._selected.selected,jQuery(".selected",this.drawingToolsElement).removeClass("selected")},_unionOrExclude:function(e){var t=this,n=this._drawingMode;this.getSelectedShape(function(e){t._clearDrawingMode(),n=="exclude"?t.excludeHandler(e):t.unionHandler(e)})},overlayOrFeatureClicked:function(e){(this._drawingMode=="union"||this._drawingMode=="exclude")&&this._unionOrExclude(e)},drawingModeChanged:function(e){var t=this._drawingMode;this._drawingMode=e||"",this._drawingMode!=t&&(t=="union"||t=="exclude"?(this._shapes.forEach(function(e){e.setMap&&e.setOptions({clickable:!1})}),this.map.data.setStyle(function(e){return{clickable:!1,fillColor:"#245080",draggable:!1,editable:!0,strokeWeight:1}})):t=="circle"&&this.map.setOptions({draggable:!0})),this.drawingModeChangeHandler&&this.drawingModeChangeHandler((e||"").toLowerCase())},_toggleDrawingMode:function(e){var t=this;this.__drawHandles||(this.__drawHandles=[]),this._clearDrawingMode(),this.drawingModeChanged((e||"").toLowerCase()),jQuery(".selected",this.drawingToolsElement).removeClass("selected");if(e&&jQuery("."+e.toLowerCase(),this.drawingToolsElement).hasClass("disabled"))return;if(e=="clear")return this.clearShapes();if(e=="union"||e=="exclude"){jQuery("."+e.toLowerCase(),this.drawingToolsElement).addClass("selected"),this._shapes.forEach(function(e){e.setMap&&e.setOptions({clickable:!0})}),this.map.data.setStyle(function(e){return{clickable:!0,fillColor:"#245080",draggable:!1,editable:!0,strokeWeight:1}});return}e=="RECTANGLE"?(this.drawingManager.setDrawingMode(google.maps.drawing.OverlayType[e]),this.map.data.setDrawingMode(null),this.__drawHandles.push(google.maps.event.addListener(this.drawingManager,"overlaycomplete",function(e){t._featureAdded(e)})),jQuery("."+e.toLowerCase(),this.drawingToolsElement).addClass("selected")):e=="CIRCLE"?(jQuery("."+e.toLowerCase(),this.drawingToolsElement).addClass("selected"),this.map.setOptions({draggable:!1}),this.map.setOptions({draggableCursor:"url(https://maps.gstatic.com/mapfiles/crosshair.cur), auto"}),this.__drawHandles.push(google.maps.event.addListenerOnce(t.map,"mousedown",function(e){t.__circle=new google.maps.Circle({fillColor:"#245080",draggable:!1,editable:!1,strokeWeight:1,clickable:!1,map:t.map,radius:1,center:e.latLng,zIndex:1}),t.__drawHandles.push(t.map.addListener("mousemove",function(e){var n=google.maps.geometry.spherical.computeDistanceBetween(t.__circle.getCenter(),e.latLng);t.__circle.setRadius(n),t._displayRadius(t.__circle,e.latLng,n)}))})),t.__drawHandles.push(google.maps.event.addListenerOnce(t.map,"mouseup",function(e){t.map.setOptions({draggableCursor:""}),t._displayRadius(null),t._clearDrawingMode(),t._circleAdded(t.__circle)}))):e=="POLYGON"?(this.drawingManager.setDrawingMode(null),this.map.data.setDrawingMode("Polygon"),this.__drawHandles.push(this.map.data.addListener("addfeature",function(e){t._featureAdded(e)})),jQuery("."+e.toLowerCase(),this.drawingToolsElement).addClass("selected")):this._clearDrawingMode()},_getRadiusLabelContent:function(e){var t=this.defaultUnits=="mi"?(e*621371e-9).toFixed(1)+"mi":(e/1e3).toFixed(2)+"km";return'<div class="radius-marker" style="vertical-align: middle; background-color: #fff; width: 70px; line-height: 24px; height: 24px; overflow: hidden; border: solid 1px #DDD; border-radius: 3px; text-align: center;">'+t+"</div>"},_decorateCircle:function(e){var t=this;if(e.getCenter){this._radiusLabel||(this._radiusLabel=new InfoBox({closeBoxURL:"",pane:"floatPane",enableEventPropagation:!0,disableAutoPan:!0,pixelOffset:new google.maps.Size(-35,-35)}));var n=e.getCenter(),r=new google.maps.LatLng(n.lat(),e.getBounds().getNorthEast().lng());e._radiusPolyline=new google.maps.Polyline({strokeColor:"#245080",strokeWeight:1,strokeOpacity:.7,path:[n,r],map:this.map}),e._radiusPolyline.setVisible(!1),e._radiusCenterMarker=new google.maps.Marker({position:n,icon:{path:google.maps.SymbolPath.CIRCLE,scale:5,strokeWeight:1,fillColor:"white",fillOpacity:1},zIndex:3,draggable:!0,map:this.map}),e._radiusBorderMarker=new google.maps.Marker({position:r,icon:{path:google.maps.SymbolPath.CIRCLE,scale:5,strokeWeight:1,fillColor:"white",fillOpacity:1},zIndex:3,draggable:!0,map:this.map,enableEventPropagation:!0}),e._radiusCenterMarker.parent=e,e._radiusBorderMarker.parent=e,e._radiusCenterMarker.addListener("drag",function(n){this.parent.setCenter(n.latLng),this.parent.dragging=!0,t.isEditing=!0;var r=e.getBounds(),i=new google.maps.LatLng(n.latLng.lat(),r.getNorthEast().lng());this.parent._radiusBorderMarker.setPosition(i)}),e._radiusBorderMarker.addListener("drag",function(n){this.parent.dragging=!0,t.isEditing=!0;var r=google.maps.geometry.spherical.computeDistanceBetween(this.parent.getCenter(),n.latLng);this.parent.setRadius(r),this.parent._radiusPolyline.setPath([e.getCenter(),n.latLng]),this.parent._radiusPolyline.setVisible(!0),t._radiusLabel.setPosition(n.latLng),t._radiusLabel.setContent(t._getRadiusLabelContent(r)),t._radiusLabel.getVisible()||(t._radiusLabel.setVisible(!0),t._radiusLabel.open(t.map,e._radiusBorderMarker))}),e._radiusCenterMarker.addListener("dragend",function(){this.parent.dragging=!1,t.isEditing=!1,t._shapesChanged()}),e._radiusBorderMarker.addListener("dragend",function(e){this.parent.dragging=!1,t.isEditing=!1,this.parent.setRadius(google.maps.geometry.spherical.computeDistanceBetween(this.parent.getCenter(),e.latLng)),this.parent._radiusPolyline.setVisible(!1),t._radiusLabel.setVisible(!1),t._shapesChanged()})}},_displayRadius:function(e,t,n){var r=this,i=!1;if(!e){this._radiusLabel&&this._radiusLabel.setVisible(!1);return}var s=e.getCenter(),o=this._getRadiusLabelContent(n);e._radiusPolyline||(i=!0,this._decorateCircle(e)),this._radiusLabel.setContent(o),this._radiusLabel.setPosition(t),this._radiusLabel.setVisible(!0),e._radiusPolyline.setPath([s,t]),e._radiusCenterMarker.setPosition(s),e._radiusBorderMarker.setPosition(t);if(i||!e._radiusPolyline.getVisible())this._radiusLabel.open(this.map,this._radiusBorderMarker),this._radiusLabel.setVisible(!0),e._radiusPolyline.setVisible(!0),e._radiusCenterMarker.setVisible(!0),e._radiusBorderMarker.setVisible(!0),this.__drawHandles.push(google.maps.event.addListenerOnce(e._radiusBorderMarker,"mouseup",function(t){r.map.setOptions({draggableCursor:""}),r._displayRadius(null),r._clearDrawingMode(),r._circleAdded(e)}))},_circleAdded:function(e){if(e){if(!e.radius||e.radius<=1){e.setMap(null),e._radiusPolyline&&e._radiusPolyline.setMap(null),e._radiusBorderMarker&&e._radiusBorderMarker.setMap(null),e._radiusCenterMarker&&e._radiusCenterMarker.setMap(null);return}var t=this;e._radiusPolyline.setVisible(!1),this._shapes.push(e),this._toggleDrawingMode(null),this._shapesChanged(),google.maps.event.addListener(e,"click",function(e){this.selected=!0,t._selected=this,t.overlayOrFeatureClicked(this)}),this._shapes.length>1&&jQuery(".exclude, .union",this.drawingToolsElement).removeClass("disabled"),jQuery(".clear",this.drawingToolsElement).removeClass("disabled")}},_featureAdded:function(e,t){var n=this;this._shapes.push(e.feature||e.overlay),this._toggleDrawingMode(null),t||this._shapesChanged(),e&&e.feature&&(this._mapDataClick||(this._mapDataClick=this.map.data.addListener("click",function(e){e.feature.selected=!0,n._selected=e.feature,n.overlayOrFeatureClicked(e.feature)}))),e&&typeof e.overlay!="undefined"&&(e.overlay.radius?(google.maps.event.addListener(e.overlay,"radius_changed",function(e){n._shapesChanged()}),google.maps.event.addListener(e.overlay,"center_changed",function(e){n._shapesChanged()})):google.maps.event.addListener(e.overlay,"bounds_changed",function(e){n._shapesChanged()}),google.maps.event.addListener(e.overlay,"click",function(e){this.selected=!0,n._selected=this,n.overlayOrFeatureClicked(this)}),e.overlay.setOptions({clickable:!1})),this._shapes.length>1&&jQuery(".exclude, .union",this.drawingToolsElement).removeClass("disabled"),jQuery(".clear",this.drawingToolsElement).removeClass("disabled")},_shapesChanged:function(){var e=0;for(var t=0;t<this._shapes.length;t++){e++;if(!this._shapes[t]||this._shapes[t].length&&this._shapes[t].length==0)continue;if(this._shapes[t].setMap)this._shapes[t].setOptions({zIndex:e});else if(this._shapes[t].length&&this._shapes[t].length>0)for(var n=0;n<this._shapes[t].length;n++)e++,this.map.data.overrideStyle(this._shapes[t][n],{zIndex:e});else this.map.data.overrideStyle(this._shapes[t],{zIndex:e})}this.changed&&this.getShapes(this.changed)},_addGeoJson:function(e){if(!e.type||e.type.toLowerCase().indexOf("feature")!=0)e={type:"Feature",geometry:e};var t=this.map.data.addGeoJson(e),n=this._getOverlayFromFeature(t);n?(this._decorateCircle(n),this._featureAdded({overlay:n})):this._featureAdded({feature:t})},_overlayToPolygon:function(e){return e.radius?this._circleToPolygon(e):this._rectangleToPolygon(e)},_rectangleToPolygon:function(e){var t=e.bounds,n=t.getNorthEast(),r=t.getSouthWest(),i=new google.maps.LatLng(n.lat(),r.lng()),s=new google.maps.LatLng(r.lat(),n.lng()),o=[];return o.push([i.lng(),i.lat()]),o.push([r.lng(),r.lat()]),o.push([s.lng(),s.lat()]),o.push([n.lng(),n.lat()]),o.push([i.lng(),i.lat()]),{type:"Polygon",coordinates:[o]}},_circleToPolygon:function(e){var t=35,n=[],r=360/t;for(var i=0;i<t;i++){var s=google.maps.geometry.spherical.computeOffset(e.center,e.radius,r*i);n.push([s.lng(),s.lat()])}return n.push(n[0]),{type:"Polygon",coordinates:[n]}},_getFeatureBounds:function(e){var t=new google.maps.LatLngBounds;return e.getGeometry().getArray().forEach(function(e){e.getArray().forEach(function(e){t.extend(e)})}),t},_getOverlayFromFeature:function(e){e=e.length&&e.length>0?e[0]:e;var t=this._getFeatureBounds(e),n=e.getGeometry().getArray(),r=n[0].getArray(),i=t.getNorthEast(),s=t.getSouthWest(),o=t.getCenter(),u=new google.maps.LatLng(o.lat(),s.lng()),a=new google.maps.LatLng(o.lat(),i.lng());if(n.length==1&&r.length>=15){var o=t.getCenter(),f=google.maps.geometry.spherical.computeDistanceBetween(u,a)/2,l=Math.ceil(f/1e3),c=l<100?f*.01:f*l*.001;for(var h=0,p=r.length;h<p;h++){var d=google.maps.geometry.spherical.computeDistanceBetween(o,r[h]);if(Math.abs(Math.floor(d)-Math.floor(f))>c)return null}var v=jQuery.extend({},this.shapeOptions);return v.center=o,v.radius=f,v.map=this.map,v.editable=!1,v.clickable=!1,this.map.data.remove(e),new google.maps.Circle(v)}if(n.length==1&&(r.length==4||r.length==5)){var m=r[0].lng()==r[1].lng()?!0:!1,g=m?"lat":"lng",y=m?"lng":"lat",b=r[0][y]()==r[1][y]()&&r[1][g]()==r[2][g]()&&r[2][y]()==r[3][y]()&&r[3][g]()==r[0][g]();if(b){var v=jQuery.extend({},this.shapeOptions);return v.map=this.map,v.bounds=t,v.clickable=!1,this.map.data.remove(e),new google.maps.Rectangle(v)}}return null},getShapeBounds:function(){var e=new google.maps.LatLngBounds;this.map.data.forEach(function(t){t.getGeometry().getArray().forEach(function(t){t.getArray().forEach(function(t){e.extend(t)})})});for(var t=0;t<this._shapes.length;t++){if(!this._shapes[t].setMap)continue;var n=this._shapes[t].getBounds();e.extend(n.getNorthEast()),e.extend(n.getSouthWest())}return e}}),"SDS"in window||(window.SDS={}),SDS.SDSMap=function(e){if(e.type=="bing")return SDS.SDSMap.instances||SDS.BingMap.instances,new SDS.BingMap(e);if(e.type=="google")return SDS.SDSMap.instances||SDS.GoogleMap.instances,new SDS.GoogleMap(e);throw new Error("unknown map provider in SDS.SDSMap ("+e.type+")")},SDS.SDSMapIFrame=function(e){if(e.type=="bing")return SDS.SDSMap.instances||(SDS.BingMap.instances=[]),new SDS.BingMapIFrame(e);if(e.type=="google")return SDS.SDSMap.instances||(SDS.GoogleMap.instances=[]),new SDS.GoogleMapIFrame(e);throw new Error("unknown map provider in SDS.SDSMapIFrame ("+e.type+")")},REModel.Services.Service=Base.extend({auth:null,constructor:function(e,t){if(!e){REModel.Services.Service.serviceRoot=="../../Services/"&&(location.href.toLowerCase().indexOf("/web2")!=-1?REModel.Services.Service.serviceRoot="../../REModel/Services/":location.href.match(/\/pages\/\w{1,}\/\w{1,}\/\w{1,}.aspx/i)?REModel.Services.Service.serviceRoot="../../../Web2/REModel/Services/":REModel.Services.Service.serviceRoot="../../Web2/REModel/Services/");var e=REModel.Services.Service.serviceRoot+"REModel.svc/"}this.serviceUrl=e,typeof t!="undefined"?this.auth=t:this.auth=REModel.Session.getAuth()},invokeGet:function(e,t,n,r,i,s){return this.invoke("GET",e,t,n,r,i,null,s)},invokePost:function(e,t,n,r,i,s){return this.invoke("POST",e,t,n,r,i,null,s)},invoke:function(e,t,n,r,i,s,o,u){typeof REModel.Services.Service.onBeforeInvoke=="function"&&REModel.Services.Service.onBeforeInvoke.call(this);var a=!0;if(e)e=e.toUpperCase();else var e="GET";var f=null;if(e=="POST")f=a?JSON.stringifyWcf(n):JSON.stringify(n);else if(e=="GET"){var l=[];this.version&&(n.version=this.version);for(var c in n)if(n.hasOwnProperty(c)){var h=n[c];if(h===null||typeof h=="undefined")continue;var p=a?JSON.stringifyWcf(h):JSON.stringify(h);p=encodeURIComponent(p),l.push(c+"="+p)}f=l.join("&")}var d=this.serviceUrl+t;if(e=="GET"&&o)return d+"?"+f;var v=this;REModel.Services.Service.XHRCount=REModel.Services.Service.XHRCount||0,REModel.Services.Service.XHRCount++;var m=jQuery.ajax({url:d,data:f,type:e,processData:!1,contentType:"application/json",timeout:9e4,dataType:"text",success:function(e){REModel.Services.Service.XHRCount=REModel.Services.Service.XHRCount-1;if(u===!0){r&&r(e);return}if(e&&e.length>0&&e.charAt(0)!="{"){i&&i("Invalid JSON: "+e,v,null);return}var t=JSON.parseWithMsAjaxDate(e);if(t.ExceptionDetail){i&&i(t.ExceptionDetail,v,null);return}if(!r)return;if(s){delete t.__type,r(t);return}for(var n in t){t[n]&&delete t[n].__type,r(t[n]);return}},error:function(e,t){REModel.Services.Service.XHRCount=REModel.Services.Service.XHRCount-1;var n=null;if(e.readyState==4){var r=e.responseText;r&&r.charAt(0)=="{"&&(n=JSON.parseWithMsAjaxDate(r));if(n){e.status&&e.status!=200?n=e.status+" "+e.statusText+"\r\n"+e.responseText:n="Callback Error: "+t,n.detail=r;var s=new String(r);s.indexOf("CheckAuth")!=-1&&(window.location=REModel.Services.Service.serviceLogoutUrl)}if(e.status===0)return}n||(n="Callback Error: "+t),i&&i(n,v,e)}});return new REModel.Services.RequestHandle(m)}},{convertToWcfDictionary:function(e){Array.isArray||(Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"});var t=[];if(Array.isArray(e))for(var n=0,r=e.length;n<r;++n){var i=[];t.push(i);var s=e[n];for(var o in s)if(s.hasOwnProperty(o)){var u=s[o];i.push({Key:o,Value:u})}}else for(var o in e)if(e.hasOwnProperty(o)){var u=e[o];t.push({Key:o,Value:u})}return t},setLogoutUrl:function(e){REModel.Services.Service.serviceLogoutUrl=e},serviceLogoutUrl:"../../../Pages/Login/Logout.aspx",serviceRoot:"../../Services/",Util:{toQueryString:function(e){if(typeof e=="undefined"||e==null||typeof e=="string"||parseFloat(e)===e)return"";var t=[];return REModel.Services.Service.Util._toQueryStringImpl(e,"",t),t.join("&").split("%20").join("+")},_toQueryStringImpl:function(e,t,n){if(typeof e=="string"||parseFloat(e)===e)n.push(encodeURIComponent(t)+"="+encodeURIComponent(e));else if(REModel.Services.Service.Util.isArray(e))for(var r=0;r<e.length;r++)REModel.Services.Service.Util._toQueryStringImpl(e[r],t+"."+(1+r),n);else for(var i in e){var s=e[i];if(s!==null&&s!==undefined&&typeof s!="function"){var o=t?t+"."+i:i;REModel.Services.Service.Util._toQueryStringImpl(s,o,n)}}},isArray:function(e){if(!(typeof e.length!="undefined"&&parseInt(e.length)==e.length&&e.length>=0))return!1;if(e.length==0)return!0;try{var t=e[e.length-1];return!0}catch(n){return!1}}}});var __reISO=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/,__reMsAjax=/^\/Date\((d|-|.*)\)[\/|\\]$/;JSON.parseWithDate=function(e){return JSON.parse(e,__dateReplacer)},JSON.parseWithMsAjaxDate=function(e){return JSON.parse(e,__msAjaxDateReplacer)},JSON.stringifyWcf=function(e){return JSON.stringify(e,function(e,t){t!==null&&typeof t!="undefined"&&delete t.__type;if(typeof t=="string"){var n=__reISO.exec(t);if(n){var r="/Date("+(new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],+n[6]))).getTime()+")/";return this[e]=r,r}}return t})},JSON.dateStringToDate=function(e){var t=__reISO.exec(e);if(t)return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4],+t[5],+t[6]));t=__reMsAjax.exec(e);if(t){var n=t[1].split(/[-,.]/);return new Date(+n[0])}return null},REModel.Services.RequestHandle=Base.extend({constructor:function(e){this.abort=function(){if(e)return e.abort()},this.state=function(){var t=-1;return e&&(t=e.readyState),t},this.destroy=function(){this.abort(),e=null}}}),REModel.Services.RequestManager=Base.extend({constructor:function(){},requestHandlesByID:{},currentRequestHandleID:null,getUid:function(){var e=(new Date).getTime(),t=e,n=1;while(!this.requestHandlesByID[t]&&n<50)t=e+"."+n,n++;return this.requestHandlesByID[t]={},this.currentRequestHandleID=t,t},abortActiveRequests:function(){var e=this.requestHandlesByID,t=[];for(var n in e){if(!e.hasOwnProperty(n))continue;e[n]&&e[n].state&&e[n].state()!=4&&e[n].state()!=-1&&(e[n].abort(),t.push(e[n]),delete this.requestHandlesByID[n])}return t},isMostRecentRequest:function(e){return this.currentRequestHandleID==e},getActiveRequests:function(){var e=this.requestHandlesByID,t=[];for(var n in e){if(!e.hasOwnProperty(n))continue;e[n]&&e[n].state&&e[n].state()!=4&&e[n].state()!=-1&&t.push(e[n])}return t},add:function(e,t){this.requestHandlesByID[e]=t},getByID:function(e){return this.requestHandlesByID[e]}}),REModel.Services.PdfService=REModel.Services.Service.extend({constructor:function(e,t){this.base(e,t)},getRenderedDraft:function(e,t,n,r){this.invokePost("getRenderedDraft",{auth:this.auth,renderData:e,draft:t},n,r,!1)},getRenderedForm:function(e,t,n){this.invokePost("getRenderedForm",{auth:this.auth,renderData:e},t,n,!1)},getRenderedList:function(e,t,n){this.invokePost("getRenderedList",{auth:this.auth,listData:e},t,n,!1)},getRenderedLinkListings:function(e,t,n,r){this.invokePost("getRenderedLinkListings",{auth:this.auth,renderData:e,link:t},n,r,!1)},getRenderedHtml:function(e,t,n){this.invokePost("getRenderedHtml",{auth:this.auth,renderData:e},t,n,!1)},getRenderedPhotos:function(e,t,n){this.invokePost("getRenderedPhotos",{auth:this.auth,renderData:e},t,n,!1)},getRenderedMapList:function(e,t,n){this.invokePost("getRenderedMapList",{auth:this.auth,mapData:e},t,n,!1)},getRenderedDrivingDirections:function(e,t,n){this.invokePost("getRenderedDrivingDirections",{auth:this.auth,mapData:e},t,n,!1)},getRenderedDraftAsImages:function(e,t,n,r){this.invokePost("getRenderedDraftAsImages",{auth:this.auth,renderData:e,draft:t},n,r,!1)},getRenderedFormAsImages:function(e,t,n){this.invokePost("getRenderedFormAsImages",{auth:this.auth,renderData:e},t,n,!1)},getRenderedListAsImages:function(e,t,n){this.invokePost("getRenderedListAsImages",{auth:this.auth,listData:e},t,n,!1)},getRenderedLinkListingsAsImages:function(e,t,n,r){this.invokePost("getRenderedLinkListingsAsImages",{auth:this.auth,renderData:e,link:t},n,r,!1)},getRenderedHtmlAsImages:function(e,t,n){this.invokePost("getRenderedHtmlAsImages",{auth:this.auth,renderData:e},t,n,!1)},getRenderedPhotosAsImages:function(e,t,n){this.invokePost("getRenderedPhotosAsImages",{auth:this.auth,renderData:e},t,n,!1)},getRenderedMapListAsImages:function(e,t,n){this.invokePost("getRenderedMapListAsImages",{auth:this.auth,mapData:e},t,n,!1)},getRenderedDrivingDirectionsAsImages:function(e,t,n){this.invokePost("getRenderedDrivingDirectionsAsImages",{auth:this.auth,mapData:e},t,n,!1)}}),function(e){function u(){r=!1;for(var n in t){var i=e(n).filter(function(){return e(this).is(":appeared")});i.length&&(t[n]?t[n](i):i.first().trigger("appear",[i]))}}var t={},n=!1,r=!1,i={interval:250},s=e(window),o=e(document);e.expr[":"].appeared=function(t){var n=e(t);if(!n.is(":visible"))return!1;var r=s.scrollLeft(),i=s.scrollTop(),o=n.offset(),u=o.left,a=o.top;return a+n.height()>=i&&a-(n.data("appear-offset")||450)<=i+s.height()?!0:!1},e.fn.extend({appear:function(s,o){e.extend(i,o||{});if(!n){var a=function(){if(r)return;r=!0,setTimeout(u,i.interval)};e(window).scroll(a).resize(a),this.parents().each(function(){$this=e(this),($this.css("overflow")=="scroll"||$this.css("overflow-x")=="scroll"||$this.css("overflow-y")=="scroll"||$this.css("overflow-y")=="auto"||$this.css("overflow-x")=="auto")&&$this.scroll(a).resize(a)}),n=!0}return o&&o.force_process&&setTimeout(u,i.interval),t[this.selector]=s,e(this.selector)}}),e.extend({force_appear:function(){return n?(u(),!0):!1}})}(jQuery),function($){$.extend({tablesorter:new function(){function benchmark(e,t){log(e+","+((new Date).getTime()-t.getTime())+"ms")}function log(e){typeof console!="undefined"&&typeof console.debug!="undefined"?console.log(e):alert(e)}function buildParserCache(e,t){if(e.config.debug)var n="";if(e.tBodies.length==0)return;var r=e.tBodies[0].rows;if(r[0]){var i=[],s=r[0].cells,o=s.length;for(var u=0;u<o;u++){var a=!1;$.metadata&&$(t[u]).metadata()&&$(t[u]).metadata().sorter?a=getParserById($(t[u]).metadata().sorter):e.config.headers[u]&&e.config.headers[u].sorter&&(a=getParserById(e.config.headers[u].sorter)),a||(a=detectParserForColumn(e,r,-1,u)),e.config.debug&&(n+="column:"+u+" parser:"+a.id+"\n"),i.push(a)}}return e.config.debug&&log(n),i}function detectParserForColumn(e,t,n,r){var i=parsers.length,s=!1,o=!1,u=!0;while(o==""&&u)n++,t[n]?(s=getNodeFromRowAndCellIndex(t,n,r),o=trimAndGetNodeText(e.config,s),e.config.debug&&log("Checking if value was empty on row:"+n)):u=!1;for(var a=1;a<i;a++)if(parsers[a].is(o,e,s))return parsers[a];return parsers[0]}function getNodeFromRowAndCellIndex(e,t,n){return e[t].cells[n]}function trimAndGetNodeText(e,t){return $.trim(getElementText(e,t))}function getParserById(e){var t=parsers.length;for(var n=0;n<t;n++)if(parsers[n].id.toLowerCase()==e.toLowerCase())return parsers[n];return!1}function buildCache(e){if(e.config.debug)var t=new Date;var n=e.tBodies[0]&&e.tBodies[0].rows.length||0,r=e.tBodies[0].rows[0]&&e.tBodies[0].rows[0].cells.length||0,i=e.config.parsers,s={row:[],normalized:[]};for(var o=0;o<n;++o){var u=$(e.tBodies[0].rows[o]),a=[];if(u.hasClass(e.config.cssChildRow)){s.row[s.row.length-1]=s.row[s.row.length-1].add(u);continue}s.row.push(u);for(var f=0;f<r;++f)a.push(i[f].format(getElementText(e.config,u[0].cells[f]),e,u[0].cells[f]));a.push(s.normalized.length),s.normalized.push(a),a=null}return e.config.debug&&benchmark("Building cache for "+n+" rows:",t),s}function getElementText(e,t){var n="";return t?(e.supportsTextContent||(e.supportsTextContent=t.textContent||!1),e.textExtraction=="simple"?e.supportsTextContent?n=t.textContent:t.childNodes[0]&&t.childNodes[0].hasChildNodes()?n=t.childNodes[0].innerHTML:n=t.innerHTML:typeof e.textExtraction=="function"?n=e.textExtraction(t):n=$(t).text(),n):""}function appendToTable(e,t){if(e.config.debug)var n=new Date;var r=t,i=r.row,s=r.normalized,o=s.length,u=s[0].length-1,a=$(e.tBodies[0]),f=[];for(var l=0;l<o;l++){var c=s[l][u];f.push(i[c]);if(!e.config.appender){var h=i[c].length;for(var p=0;p<h;p++)a[0].appendChild(i[c][p])}}e.config.appender&&e.config.appender(e,f),f=null,e.config.debug&&benchmark("Rebuilt table:",n),applyWidget(e),setTimeout(function(){$(e).trigger("sortEnd")},0)}function buildHeaders(e){if(e.config.debug)var t=new Date;var n=$.metadata?!0:!1,r=computeTableHeaderCellIndexes(e);return $tableHeaders=$(e.config.selectorHeaders,e).each(function(t){this.column=r[this.parentNode.rowIndex+"-"+this.cellIndex],this.order=formatSortingOrder(e.config.sortInitialOrder),this.count=this.order;if(checkHeaderMetadata(this)||checkHeaderOptions(e,t))this.sortDisabled=!0;checkHeaderOptionsSortingLocked(e,t)&&(this.order=this.lockedOrder=checkHeaderOptionsSortingLocked(e,t));if(!this.sortDisabled){var n=$(this).addClass(e.config.cssHeader);e.config.onRenderHeader&&e.config.onRenderHeader.apply(n)}e.config.headerList[t]=this}),e.config.debug&&(benchmark("Built headers:",t),log($tableHeaders)),$tableHeaders}function computeTableHeaderCellIndexes(e){var t=[],n={},r=e.getElementsByTagName("THEAD")[0],i=r.getElementsByTagName("TR");for(var s=0;s<i.length;s++){var o=i[s].cells;for(var u=0;u<o.length;u++){var a=o[u],f=a.parentNode.rowIndex,l=f+"-"+a.cellIndex,c=a.rowSpan||1,h=a.colSpan||1,p;typeof t[f]=="undefined"&&(t[f]=[]);for(var d=0;d<t[f].length+1;d++)if(typeof t[f][d]=="undefined"){p=d;break}n[l]=p;for(var d=f;d<f+c;d++){typeof t[d]=="undefined"&&(t[d]=[]);var v=t[d];for(var m=p;m<p+h;m++)v[m]="x"}}}return n}function checkCellColSpan(e,t,n){var r=[],i=e.tHead.rows,s=i[n].cells;for(var o=0;o<s.length;o++){var u=s[o];u.colSpan>1?r=r.concat(checkCellColSpan(e,headerArr,n++)):(e.tHead.length==1||u.rowSpan>1||!i[n+1])&&r.push(u)}return r}function checkHeaderMetadata(e){return $.metadata&&$(e).metadata().sorter===!1?!0:!1}function checkHeaderOptions(e,t){return e.config.headers[t]&&e.config.headers[t].sorter===!1?!0:!1}function checkHeaderOptionsSortingLocked(e,t){return e.config.headers[t]&&e.config.headers[t].lockedOrder?e.config.headers[t].lockedOrder:!1}function applyWidget(e){var t=e.config.widgets,n=t.length;for(var r=0;r<n;r++)getWidgetById(t[r]).format(e)}function getWidgetById(e){var t=widgets.length;for(var n=0;n<t;n++)if(widgets[n].id.toLowerCase()==e.toLowerCase())return widgets[n]}function formatSortingOrder(e){return typeof e!="Number"?e.toLowerCase()=="desc"?1:0:e==1?1:0}function isValueInArray(e,t){var n=t.length;for(var r=0;r<n;r++)if(t[r][0]==e)return!0;return!1}function setHeadersCss(e,t,n,r){t.removeClass(r[0]).removeClass(r[1]);var i=[];t.each(function(e){this.sortDisabled||(i[this.column]=$(this))});var s=n.length;for(var o=0;o<s;o++)i[n[o][0]].addClass(r[n[o][1]])}function fixColumnWidth(e,t){var n=e.config;if(n.widthFixed){var r=$("<colgroup>");$("tr:first td",e.tBodies[0]).each(function(){r.append($("<col>").css("width",$(this).width()))}),$(e).prepend(r)}}function updateHeaderSortCount(e,t){var n=e.config,r=t.length;for(var i=0;i<r;i++){var s=t[i],o=n.headerList[s[0]];o.count=s[1],o.count++}}function multisort(table,sortList,cache){if(table.config.debug)var sortTime=new Date;var dynamicExp="var sortWrapper = function(a,b) {",l=sortList.length;for(var i=0;i<l;i++){var c=sortList[i][0],order=sortList[i][1],s=table.config.parsers[c].type=="text"?order==0?makeSortFunction("text","asc",c):makeSortFunction("text","desc",c):order==0?makeSortFunction("numeric","asc",c):makeSortFunction("numeric","desc",c),e="e"+i;dynamicExp+="var "+e+" = "+s,dynamicExp+="if("+e+") { return "+e+"; } ",dynamicExp+="else { "}var orgOrderCol=cache.normalized[0].length-1;dynamicExp+="return a["+orgOrderCol+"]-b["+orgOrderCol+"];";for(var i=0;i<l;i++)dynamicExp+="}; ";return dynamicExp+="return 0; ",dynamicExp+="}; ",table.config.debug&&benchmark("Evaling expression:"+dynamicExp,new Date),eval(dynamicExp),cache.normalized.sort(sortWrapper),table.config.debug&&benchmark("Sorting on "+sortList.toString()+" and dir "+order+" time:",sortTime),cache}function makeSortFunction(e,t,n){var r="a["+n+"]",i="b["+n+"]";if(e=="text"&&t=="asc")return"("+r+" == "+i+" ? 0 : ("+r+" === null ? Number.POSITIVE_INFINITY : ("+i+" === null ? Number.NEGATIVE_INFINITY : ("+r+" < "+i+") ? -1 : 1 )));";if(e=="text"&&t=="desc")return"("+r+" == "+i+" ? 0 : ("+r+" === null ? Number.POSITIVE_INFINITY : ("+i+" === null ? Number.NEGATIVE_INFINITY : ("+i+" < "+r+") ? -1 : 1 )));";if(e=="numeric"&&t=="asc")return"("+r+" === null && "+i+" === null) ? 0 :("+r+" === null ? Number.POSITIVE_INFINITY : ("+i+" === null ? Number.NEGATIVE_INFINITY : "+r+" - "+i+"));";if(e=="numeric"&&t=="desc")return"("+r+" === null && "+i+" === null) ? 0 :("+r+" === null ? Number.POSITIVE_INFINITY : ("+i+" === null ? Number.NEGATIVE_INFINITY : "+i+" - "+r+"));"}function makeSortText(e){return"((a["+e+"] < b["+e+"]) ? -1 : ((a["+e+"] > b["+e+"]) ? 1 : 0));"}function makeSortTextDesc(e){return"((b["+e+"] < a["+e+"]) ? -1 : ((b["+e+"] > a["+e+"]) ? 1 : 0));"}function makeSortNumeric(e){return"a["+e+"]-b["+e+"];"}function makeSortNumericDesc(e){return"b["+e+"]-a["+e+"];"}function sortText(e,t){return table.config.sortLocaleCompare?e.localeCompare(t):e<t?-1:e>t?1:0}function sortTextDesc(e,t){return table.config.sortLocaleCompare?t.localeCompare(e):t<e?-1:t>e?1:0}function sortNumeric(e,t){return e-t}function sortNumericDesc(e,t){return t-e}function getCachedSortType(e,t){return e[t].type}var parsers=[],widgets=[];this.defaults={cssHeader:"header",cssAsc:"headerSortUp",cssDesc:"headerSortDown",cssChildRow:"expand-child",sortInitialOrder:"asc",sortMultiSortKey:"shiftKey",sortForce:null,sortAppend:null,sortLocaleCompare:!0,textExtraction:"simple",parsers:{},widgets:[],widgetZebra:{css:["even","odd"]},headers:{},widthFixed:!1,cancelSelection:!0,sortList:[],headerList:[],dateFormat:"us",decimal:"/.|,/g",onRenderHeader:null,selectorHeaders:"thead th",debug:!1},this.benchmark=benchmark,this.construct=function(e){return this.each(function(){if(!this.tHead||!this.tBodies)return;var t,n,r,i,s,o=0,u;this.config={},s=$.extend(this.config,$.tablesorter.defaults,e),t=$(this),$.data(this,"tablesorter",s),r=buildHeaders(this),this.config.parsers=buildParserCache(this,r),i=buildCache(this);var a=[s.cssDesc,s.cssAsc];fixColumnWidth(this),r.click(function(e){var n=t[0].tBodies[0]&&t[0].tBodies[0].rows.length||0;if(!this.sortDisabled&&n>0){t.trigger("sortStart");var o=$(this),u=this.column;this.order=this.count++%2,this.lockedOrder&&(this.order=this.lockedOrder);if(!e[s.sortMultiSortKey]){s.sortList=[];if(s.sortForce!=null){var f=s.sortForce;for(var l=0;l<f.length;l++)f[l][0]!=u&&s.sortList.push(f[l])}s.sortList.push([u,this.order])}else if(isValueInArray(u,s.sortList))for(var l=0;l<s.sortList.length;l++){var c=s.sortList[l],h=s.headerList[c[0]];c[0]==u&&(h.count=c[1],h.count++,c[1]=h.count%2)}else s.sortList.push([u,this.order]);return setTimeout(function(){setHeadersCss(t[0],r,s.sortList,a),appendToTable(t[0],multisort(t[0],s.sortList,i))},1),!1}}).mousedown(function(){if(s.cancelSelection)return this.onselectstart=function(){return!1},!1}),t.bind("update",function(){var e=this;setTimeout(function(){e.config.parsers=buildParserCache(e,r),i=buildCache(e)},1)}).bind("updateCell",function(e,t){var n=this.config,r=[t.parentNode.rowIndex-1,t.cellIndex];i.normalized[r[0]][r[1]]=n.parsers[r[1]].format(getElementText(n,t),t)}).bind("sorton",function(e,t){$(this).trigger("sortStart"),s.sortList=t;var n=s.sortList;updateHeaderSortCount(this,n),setHeadersCss(this,r,n,a),appendToTable(this,multisort(this,n,i))}).bind("appendCache",function(){appendToTable(this,i)}).bind("applyWidgetId",function(e,t){getWidgetById(t).format(this)}).bind("applyWidgets",function(){applyWidget(this)}),$.metadata&&$(this).metadata()&&$(this).metadata().sortlist&&(s.sortList=$(this).metadata().sortlist),s.sortList.length>0&&t.trigger("sorton",[s.sortList]),applyWidget(this)})},this.addParser=function(e){var t=parsers.length,n=!0;for(var r=0;r<t;r++)parsers[r].id.toLowerCase()==e.id.toLowerCase()&&(n=!1);n&&parsers.push(e)},this.addWidget=function(e){widgets.push(e)},this.formatFloat=function(e){var t=parseFloat(e);return isNaN(t)?0:t},this.formatInt=function(e){var t=parseInt(e);return isNaN(t)?0:t},this.isDigit=function(e,t){return/^[-+]?\d*$/.test($.trim(e.replace(/[,.']/g,"")))},this.clearTableBody=function(e){if($.browser.msie){function t(){while(this.firstChild)this.removeChild(this.firstChild)}t.apply(e.tBodies[0])}else e.tBodies[0].innerHTML=""}}}),$.fn.extend({tablesorter:$.tablesorter.construct});var ts=$.tablesorter;ts.addParser({id:"text",is:function(e){return!0},format:function(e){return $.trim(e.toLocaleLowerCase())},type:"text"}),ts.addParser({id:"digit",is:function(e,t){var n=t.config;return $.tablesorter.isDigit(e,n)},format:function(e){return $.tablesorter.formatFloat(e)},type:"numeric"}),ts.addParser({id:"currency",is:function(e){return/^[$?.]/.test(e)},format:function(e){return e=e.replace(".",""),$.tablesorter.formatFloat(e.replace(new RegExp(/[^0-9.]/g),""))},type:"numeric"}),ts.addParser({id:"ipAddress",is:function(e){return/^\d{2,3}[\.]\d{2,3}[\.]\d{2,3}[\.]\d{2,3}$/.test(e)},format:function(e){var t=e.split("."),n="",r=t.length;for(var i=0;i<r;i++){var s=t[i];s.length==2?n+="0"+s:n+=s}return $.tablesorter.formatFloat(n)},type:"numeric"}),ts.addParser({id:"url",is:function(e){return/^(https?|ftp|file):\/\/$/.test(e)},format:function(e){return jQuery.trim(e.replace(new RegExp(/(https?|ftp|file):\/\//),""))},type:"text"}),ts.addParser({id:"isoDate",is:function(e){return/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(e)},format:function(e){return $.tablesorter.formatFloat(e!=""?(new Date(e.replace(new RegExp(/-/g),"/"))).getTime():"0")},type:"numeric"}),ts.addParser({id:"percent",is:function(e){return/\%$/.test($.trim(e))},format:function(e){return $.tablesorter.formatFloat(e.replace(new RegExp(/%/g),""))},type:"numeric"}),ts.addParser({id:"usLongDate",is:function(e){return e.match(new RegExp(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/))},format:function(e){return $.tablesorter.formatFloat((new Date(e)).getTime())},type:"numeric"}),ts.addParser({id:"shortDate",is:function(e){return/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/.test(e)},format:function(e,t){var n=t.config;e=e.replace(/\-/g,"/");if(n.dateFormat=="us")e=e.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$1/$2");else if(n.dateFormat=="uk")e=e.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$2/$1");else if(n.dateFormat=="dd/mm/yy"||n.dateFormat=="dd-mm-yy")e=e.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/,"$1/$2/$3");return $.tablesorter.formatFloat((new Date(e)).getTime())},type:"numeric"}),ts.addParser({id:"time",is:function(e){return/^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(e)},format:function(e){return $.tablesorter.formatFloat((new Date("2000/01/01 "+e)).getTime())},type:"numeric"}),ts.addParser({id:"metadata",is:function(e){return!1},format:function(e,t,n){var r=t.config,i=r.parserMetadataName?r.parserMetadataName:"sortValue";return $(n).metadata()[i]},type:"numeric"}),ts.addWidget({id:"zebra",format:function(e){if(e.config.debug)var t=new Date;var n,r=-1,i;$("tr:visible",e.tBodies[0]).each(function(t){n=$(this),n.hasClass(e.config.cssChildRow)||r++,i=r%2==0,n.removeClass(e.config.widgetZebra.css[i?0:1]).addClass(e.config.widgetZebra.css[i?1:0])}),e.config.debug&&$.tablesorter.benchmark("Applying Zebra widget",t)}})}(jQuery);var CustomInfobox=function(e,t){function a(){s=e.getRootElement().parentNode.id+"_infobox",$("body").append("<div id='"+s+"' style='position:absolute;z-index:10000;display:none;'></div>"),l(u.tether),p(t)}function f(e){var t=["<div id='",s,"_arrow' style='position:relative;float:left;width:0;height:0;line-height:0;border-style:solid;"],n=u.arrowWidth*.5;switch(e){case 0:t.push("border-width:0 ",n,"px ",u.arrowLength,"px ",n,"px;"),t.push("border-color:transparent transparent ",u.arrowColor," transparent;");break;case 1:t.push("border-width:",n,"px 0 ",n,"px ",u.arrowLength,"px;"),t.push("border-color:transparent transparent transparent ",u.arrowColor,";");break;case 2:t.push("border-width:",u.arrowLength,"px ",n,"px 0 ",n,"px;"),t.push("border-color:",u.arrowColor," transparent transparent transparent;");break;case 3:t.push("border-width:",n,"px ",u.arrowLength,"px ",n,"px 0;"),t.push("border-color:transparent ",u.arrowColor," transparent transparent;")}return t.push("'></div>"),t.join("")}function l(e){o!=null&&Microsoft.Maps.Events.removeHandler(o),e?o=Microsoft.Maps.Events.addThrottledHandler(n,"viewchange",h,40):o=Microsoft.Maps.Events.addHandler(n,"viewchangestart",c)}function c(){i=null,r=null,h()}function h(){var e=$("#"+s);if(e!=null&&i!=null&&r!=null)if(!n.getBounds().contains(i))e.css("display","none");else{e.css("display","");var t=n.tryLocationToPixel(i,Microsoft.Maps.PixelReference.control),o=n.getPageX()+t.x,a=n.getPageY()+t.y,l=n.getHeight()*.5<t.y?2:0;l+=n.getWidth()*.5<t.x?1:0;var h=["<div id='",s,"_content' style='position:relative;float:left;border:1px solid ",u.borderColor,";background-color:",u.color,";min-width:",u.minWidth,"px;min-height:",u.minHeight,"px;'>",r,"</div>"],p=0,d=0,v;u.showArrow?u.orientation?(p=u.arrowWidth,d=u.arrowLength,l>1?v=h.join("")+f(2):v=f(0)+h.join("")):(p=u.arrowLength,d=u.arrowWidth,l%2?v=h.join("")+f(1):v=f(3)+h.join("")):v=h.join(""),e.html(v);var m=$("#"+s+"_content");u.showCloseButton&&(m.append("<span id='"+s+"_closeBtn' href='javascript:void()' style='position:absolute;right:5px;top:2px;cursor:pointer;font:bold 18px Arial;line-height:12px;'>x</span>"),$("#"+s+"_closeBtn").click(function(){c()}));var g=m.outerWidth(),y=m.outerHeight(),b=0,w=0,E=0,S=0;u.orientation?(b=g,w=y+d,l%2?(S=b-u.arrowWidth,o+=u.offset.x-b+u.arrowWidth*.5):o+=u.offset.x-u.arrowWidth*.5,l>1?a-=w+u.offset.y:a-=u.offset.y):(b=p+g+2,w=Math.max(y,d),l%2?o+=u.offset.x-b:o+=u.offset.x,l>1?(E=w-u.arrowWidth,a-=w-u.arrowWidth*.5+u.offset.y):a-=u.arrowWidth*.5+u.offset.y);if(u.showArrow){var x=$("#"+s+"_arrow");x.css({"margin-left":Math.ceil(S)+"px","margin-top":Math.ceil(E)+"px"})}e.css({width:Math.ceil(b)+"px",height:Math.ceil(w)+"px",top:a,left:o})}else e!=null&&(e.html(""),e.css("display","none"))}function p(e){var t=u.tether;for(attrname in e)u[attrname]=e[attrname];t!=u.tether&&l(u.tether),h()}var n=e,r,i,s,o,u={arrowColor:"#fff",arrowLength:20,arrowWidth:30,borderColor:"#000",color:"#fff",minHeight:50,minWidth:100,offset:{x:0,y:0},orientation:0,showArrow:!0,showCloseButton:!0,tether:!1};this.hide=function(){c()},this.show=function(e,t){i=e,r=t,h()},this.getOptions=function(){return u},this.setOptions=function(e){p(e)},a()};jQuery(document).ready(function(){$.facebox.settings.ziBase=2e4,jQuery(document).on("click",".prev",function(){var e=jQuery(this),t=e.parents(".multi-photo"),n=t.find("img.multi-photo"),r=n.data("mp-index")||0,i=n.data("multi-photos");return i&&(i=i["multi-photos"]),r=(r-2)%i.length,r<0&&(r=i.length-1),n.attr("src",i[r].url),n.data("mp-index",++r),t.find(".info").text(r+" of "+i.length),!1}),jQuery(document).on("click",".next",function(){var e=jQuery(this),t=e.parents(".multi-photo"),n=t.find("img.multi-photo"),r=n.data("mp-index")||0,i=n.data("multi-photos");return i&&(i=i["multi-photos"]),r%=i.length,n.attr("src",i[r].url),n.data("mp-index",++r),t.find(".info").text(r+" of "+i.length),!1}),jQuery(".link-item").appear(function(e){e.not(".loaded"),e.addClass("loaded"),e.each(function(e,t){var n=jQuery(t),r=n.attr("data-deferred-load");r&&(n.removeAttr("data-deferred-load"),n.attr("data-deferred-loaded",r),r+="&units="+jQuery("#units").val(),n.addClass("loading"),n.append("<div></div>").find("div:last").load(r,function(){n.removeClass("loading").css("min-width","0px").css("min-height","0px"),n.find(".header").addClass("loaded");var e=n.find("img.multi-photo");e.length&&e.each(function(e,t){jQuery(t).data("mp-index",1);var n=jQuery(t).data("multi-photos");n&&(n["multi-photos"].length>1&&(n=n["multi-photos"],jQuery(t).parent().append('<span class="multi-photo-help"><span class="bg"></span><span class="info">1 of '+n.length+'</span><span class="nav"><a href="#" class="prev">Previous</a><a href="#" class="next">Next</a></span></span>').addClass("multi-photo")),_mpLightGallery(t))})}))})});var e=jQuery("img.multi-photo");e.length&&e.each(function(e,t){jQuery(t).data("mp-index",1);var n=jQuery(t).data("multi-photos");n&&(n["multi-photos"].length>1&&(n=n["multi-photos"],jQuery(t).parent().append('<span class="multi-photo-help"><span class="bg"></span><span class="info">1 of '+n.length+'</span><span class="nav"><a href="#" class="prev">Previous</a><a href="#" class="next">Next</a></span></span>').addClass("multi-photo")),_mpLightGallery(n))}),$.force_appear();if(document.getElementById("map")){var t=window.bingApiKey;SDS.Maps.Map.create("map",{key:t,clientID:window.googleClientID,channelID:window.googleChannelID})}jQuery(".data-list").tablesorter({cssAsc:"sort-asc",cssDesc:"sort-desc"}).bind("sortEnd",function(){jQuery(".reports").hide(),jQuery(".data-list tbody").hide(),jQuery(".data-list tbody tr").each(function(e,t){jQuery(t).removeClass("even odd").addClass(e%2==0?"even":"odd").find(".data-list-row-number").text(e+1);var n=jQuery(t).data("identifier"),r=jQuery(".link-item[data-identifier="+n+"]");r.find(".map-marker-index").text(e+1),jQuery(".reports").append(r)}),SDS.Maps.Map.addPushPins(),$.force_appear(),jQuery(".data-list tbody").show(),jQuery(".reports").show()})});var pdfStorePath=window.rootUrl+"Temp/Public/PdfStore/",formatPdfStorePath=function(e){return e.indexOf("~/")===0?window.rootUrl+e.substring(2):e.indexOf("http")===0?e:window.pdfStorePath+e},PdfPrint=Base.extend({entityName:null,userData:null,formId:null,mlsNums:null,externalStyles:null,includeHeaders:null,includeFooters:null,mimeType:"application/pdf",pdfStorePath:"~/Temp/Public/PdfStore/",targetDiv:"PdfDiv",targetFrame:"PdfFrame",constructor:function(){},init:function(e,t,n,r,i,s,o,u){this.entityName=e,this.userData=t,this.formId=n,this.mlsNums=r,this.type=i,this.externalStyles=s,this.includeHeader=o,this.includeFooter=u},printLinkPage:function(e,t,n){var r=this;showSpinner(jQuery("#MasterDynamicBody"));var i=typeof window.displayUnits!="undefined"?window.displayUnits:null;!i&&jQuery("#units").length>0&&(i=jQuery("#units").val());var s=getEntityKey().appName=="TREB",o=!0,u={entityKey:getEntityKey(),userKey:getUserKey(),connectionKey:getConnectionKey(),metadata:e.dataMap,criteriaName:e.criteriaName,formId:e.formId,photoGalleryFormID:e.photoGalleryFormID,columnSetID:window.columnSetID||0,mlsNums:e.mlsNums,externalStyles:"",includeHeader:s,includeFooter:o,pdfStorePath:this.pdfStorePath,displayColumns:e.columns,columnNames:e.columnNames,orientation:0,sortOrder:e.sortOrder,mapPushpinData:e.pushpins,mapCenter:e.mapCenter,mapZoom:e.mapZoom,showListingsOnMap:!0,forDisplay:n||t,forDownload:n||!1,includeCriteria:e.includeCriteria,searchConditions:e.searchConditions,mapShapes:e.currentShape?[e.currentShape]:[],mapLocations:e.mapLocations,mapPlaces:e.mapPlaces,mapView:e.mapView,includeMap:e.includeMap,keyColumnName:e.keyColumnName,displayUnits:i},a=this.getPdf;t&&(a=this.showPdf),n&&(a=this.download);var f=typeof window.chrome!="undefined",l=navigator.appVersion.indexOf("Mac")!=-1&&jQuery.browser.safari&&!f;l=l||jQuery.browser.mozilla&&parseInt(jQuery.browser.version,10)>=19,!t&&!n&&l&&SDS.Print.PdfPrint2.safariPrintOpen();if(t&&!n){var c=new REModel.Services.PdfService(window.rootUrl+"Pages/Public/Services/Pdf.svc/"),h=function(){jQuery(document).trigger("close.facebox","print-preview-dialog"),r.printLinkPage(e,!1,!1)};c.getRenderedLinkListingsAsImages(u,e.link,function(e){a(e,h)},printFailed)}else{var c=new REModel.Services.PdfService(window.rootUrl+"Pages/Public/Services/Pdf.svc/");c.getRenderedLinkListings(u,e.link,a,printFailed)}},printPdf:function(){var e=jQuery("#"+this.targetFrame);if(jQuery.browser.msie){e.get(0).contentWindow.document.getElementById("PdfObj").print();return}e.get(0).contentWindow.print()},stateChangeCallback:function(){(!jQuery.browser.msie||document.getElementById("PdfFrame").readyState=="complete")&&setTimeout("printPdf()",250)},download:function(e){jQuery("#PdfFrame").remove(),hideSpinner();var t=window.rootUrl+"Pages/Public/Download.aspx?file="+window.formatPdfStorePath(e);jQuery("#PdfFrame").remove(),e.indexOf("http")==0&&(t=e);var n=[];n.push({Text:"Cancel",Type:SDS.Controls.MessageBox.ButtonType.Cancel});var r=[];r.push('<div id="DownloadReadyContent">'),r.push("<p>Your download is ready. Click below to download it.</p>"),r.push('<div id="DownloadLinkContainer"></div>'),r.push("</div>"),downloadReadyBox=new SDS.Controls.MessageBox(r.join(""),{buttons:n,title:"Download Ready",id:"download-ready-dialog"}),downloadReadyBox.show(),jQuery("#download-ready-dialog").css("top",jQuery(window).scrollTop()+10+"px");if(window.currentAppName.toLowerCase()!=="treb"){var i='<button class="image-button" onclick="downloadReadyBox.hide(); window.location=\''+t+"';\"><span>Download</span></button>";jQuery("div.dialog-toolbar",downloadReadyBox.element).prepend(i)}},getPdf:function(e){jQuery("#PdfFrame").remove(),handleChromeOrFirefoxOnMac()!=null&&hideSpinner(),jQuery("#PdfDiv").html('<iframe id="PdfFrame" type="application/pdf" style="width:1000px;height:500px;position:absolute;left:-9999px;"></iframe>');var t=detectAcrobat();if(SDS.Print.PdfPrint2.safariPrintWindow){hideSpinner(),SDS.Print.PdfPrint2.safariPrintLoad(e.replace("~/",window.rootUrl||"../../"),!1);return}jQuery("#PdfFrame").load(function(){/Edge\/\d/.test(navigator.userAgent)&&jQuery("#PdfDiv").show(),setTimeout(function(){hideSpinner(),/Edge\/\d/.test(navigator.userAgent)&&jQuery("#PdfDiv").hide(),t||jQuery("#PdfFrame").get(0).contentWindow.print()},250)}),jQuery.browser.msie&&setTimeout(function(){hideSpinner()},1500),jQuery.browser.mozilla&&t&&setTimeout(function(){hideSpinner()},1500),jQuery("#PdfFrame").attr("src",formatPdfStorePath(e)),jQuery("#PdfFrame").attr("data",formatPdfStorePath(e))},showPdf:function(e,t){var n="printPreviewDiv",r=jQuery(window).width(),i=jQuery(window).height(),s=new SDS.Controls.PageBox("Print Preview",'<div id="'+n+'" style="overflow:scroll;width:'+(r-80)+"px;height:"+(i-200)+'px;"><ul style="text-align:center;list-style-type:none;margin-left:0px;padding-left:0px;"></ul></div>',{bodyClass:"",id:"print-preview-dialog"});s.show(),jQuery("#print-preview-dialog .footer #print-preview-print").remove(),jQuery("#print-preview-dialog .footer").prepend('<a href="javascript:void();" id="print-preview-print" class="facebox-footer-button"><img class="image" style="display:none;" title="print" src="null"/><div class="print-image-div"></div></a>'),jQuery("#print-preview-dialog #print-preview-print").click(t),hideSpinner();var o=jQuery("#"+n+" > ul");for(var u=0,a=e.length;u<a;++u){var f=e[u];o.append('<li><img style="width:'+(r-100)+'px;" src="'+formatPdfStorePath(f)+'"/></li>')}}}),pdfPrint=new PdfPrint,spinner=new SDS.Controls.Spinner({container:document.body,options:{delay:0}});"SDS"in window||(SDS={}),SDS.Page={},SDS.Page.getCurrent=function(){return null},SDS.Utility.registerNamespace("SDS.Print"),SDS.Print.PdfPrint2=Base.extend({},{mimeType:"application/pdf",pdfStorePath:"~/Temp/PdfStore/",targetDiv:"PdfDiv",targetFrame:"PdfFrame",targetObj:"PdfObj",getHandlersObject:function(){return{getPdf:SDS.Print.PdfPrint2.getPdf,showPdf:SDS.Print.PdfPrint2.showPdf,download:SDS.Print.PdfPrint2.download,printFailed:SDS.Print.PdfPrint2.printFailed}},getPdfStorePath:function(){return SDS.Print.PdfPrint2.pdfStorePath},getPdfStorePathAsync:function(e,t){e&&e.call(this,this.pdfStorePath)},printPdf:function(){var e=jQuery("#"+SDS.Print.PdfPrint2.targetFrame);if(jQuery.browser.msie){e.get(0).contentWindow.document.getElementById(SDS.Print.PdfPrint2.targetObj).print();return}e.get(0).contentWindow.print()},stateChangeCallback:function(){(!jQuery.browser.msie||document.getElementById(SDS.Print.PdfPrint2.targetFrame).readyState=="complete")&&setTimeout("SDS.Print.PdfPrint2.printPdf()",250)},download:function(e){jQuery("#"+SDS.Print.PdfPrint2.targetFrame).remove(),hideSpinner();var t=window.rootUrl+"Temp/PdfStore/",n=window.rootUrl+"Pages/Public/Download.aspx?file="+(new String(e)).replace("~/",window.rootUrl||"../../");jQuery("#PdfFrame").remove(),e.indexOf("http")==0&&(n=e);var r=[];r.push({Text:"Cancel",Type:SDS.Controls.MessageBox.ButtonType.Cancel});var i=[];i.push('<div id="DownloadReadyContent">'),i.push("<p>Your download is ready. Click below to download it.</p>"),i.push('<div id="DownloadLinkContainer"></div>'),i.push("</div>"),downloadReadyBox=new SDS.Controls.MessageBox(i.join(""),{buttons:r,title:"Download Ready",id:"download-ready-dialog"}),downloadReadyBox.show(),jQuery("#download-ready-dialog").css("top",jQuery(window).scrollTop()+10+"px");var s='<button class="image-button" onclick="downloadReadyBox.hide(); window.location=\''+n+"';\"><span>Download</span></button>";jQuery("div.dialog-toolbar",downloadReadyBox.element).prepend(s)},getPdf:function(e){jQuery("#"+SDS.Print.PdfPrint2.targetFrame).remove(),SDS.Print.PdfPrint2.handleChromeOrFirefoxOnMac()!=null&&SDS.Print.PdfPrint2.hideSpinner();var t=SDS.Print.PdfPrint2.detectAcrobat(),n=typeof window.chrome!="undefined",r=navigator.appVersion.indexOf("Mac")!=-1,i=navigator.userAgent.indexOf("Windows NT 6.2")!=-1;if(SDS.Print.PdfPrint2.safariPrintWindow){SDS.Print.PdfPrint2.hideSpinner(),SDS.Print.PdfPrint2.safariPrintLoad(e.replace("~/",window.rootUrl||"../../"),!1);return}var s=jQuery('<iframe id="'+SDS.Print.PdfPrint2.targetFrame+'" type="application/pdf" style="width:1000px;height:500px;position:absolute;left:-9999px;display:none;"></iframe>').load(function(){setTimeout(function(){hideSpinner();if(macSafari||t||n)return;jQuery("#"+SDS.Print.PdfPrint2.targetFrame).get(0).contentWindow.print()},250)}).appendTo("#"+SDS.Print.PdfPrint2.targetDiv);jQuery.browser.msie&&s.contents().ready(function(){setTimeout(function(){hideSpinner()},250)}),jQuery.browser.mozilla&&t&&setTimeout(function(){hideSpinner()},1500),(i&&!t||jQuery.browser.mozilla&&r)&&setTimeout(function(){hideSpinner()},1500),s.attr("src",e.replace("~/",window.rootUrl||"../../")).attr("data",e.replace("~/",window.rootUrl||"../../")).attr("style","height:0;width:0;")},showPdf:function(e){var t="printPreviewDiv",n=jQuery(window).width(),r=jQuery(window).height(),i=new SDS.Controls.PageBox("Print Preview",'<div id="'+t+'" style="overflow:scroll;width:'+(n-80)+"px;height:"+(r-200)+'px;"><ul style="text-align:center;list-style-type:none;margin-left:0px;padding-left:0px;"></ul></div>',{bodyClass:"",id:"print-preview-dialog"});i.show(),SDS.Print.PdfPrint2.hideSpinner();var s="../../Temp/pdfStore/",o=jQuery("#"+t+" > ul");for(var u=0,a=e.length;u<a;++u){var f=e[u];if(u==0){SDS.Print.PdfPrint2.showSpinner(jQuery(".facebox-popup:first","#print-preview-dialog"),null,"Please Wait . . .");var l=jQuery(document.createElement("img")).css({width:n-100+"px"}).attr("src",f.replace("~/",window.rootUrl||"../../")).load(function(){SDS.Print.PdfPrint2.hideSpinner()}).error(function(){SDS.Print.PdfPrint2.hideSpinner()});o.append("<li>").append(l)}else o.append('<li><img style="width:'+(n-100)+'px;" src="'+f.replace("~/",window.rootUrl||"../../")+'"/></li>')}},printFailed:function(e){var t="";if(typeof e=="object")for(var n in e)e.hasOwnProperty(n)&&(messsage+="\n"+e[n]);else t=e;SDS.Print.PdfPrint2.hideSpinner(),(new SDS.Controls.PageBox("There was a Problem",'<p>We were unable to render the requested printout. Please submit a bug report and include the following information:<br /><br /><p><textarea style="width:300px;height:200px;">"Failed to render print data: '+t+"</textarea></p><p>(You can select all text by clicking in the box and press CTRL-A (Windows) or META-A (Mac)</p>",{bodyClass:"body-dark"})).show()},showSpinner:function(e,t,n){var r="print";t==="Download"&&(r="Download"),SDS.Print.PdfPrint2.spinner=new SDS.Controls.Spinner({container:e.get(0),text:typeof n!="undefined"?n:"Preparing to "+r+"..."});var i=jQuery(".spinner-container");i.css("top","10px"),i.css("color","Black"),SDS.Print.PdfPrint2.spinner.show();var s=jQuery(".spinner-label");s.css("color","Black")},hideSpinner:function(){jQuery(".spinner-container").css("display","none"),SDS.Print.PdfPrint2.spinner!=null&&(SDS.Print.PdfPrint2.spinner.hide(),SDS.Print.PdfPrint2.spinner=null)},detectAcrobat:function(){var acrobat=new Object;acrobat.installed=!1;if(navigator.plugins&&navigator.plugins.length){var hasChromePDF=!1;for(var x=0,l=navigator.plugins.length;x<l;++x)if(navigator.plugins[x].description.indexOf("Adobe Acrobat")!=-1||navigator.plugins[x].description.indexOf("Adobe PDF")!=-1||navigator.plugins[x].name.indexOf("Adobe Acrobat")!=-1)acrobat.installed=!0}else if(window.ActiveXObject){for(x=2;x<10;x++)try{oAcro=eval("new ActiveXObject('PDF.PdfCtrl."+x+"');"),oAcro&&(acrobat.installed=!0)}catch(e){}try{oAcro4=new ActiveXObject("PDF.PdfCtrl.1"),oAcro4&&(acrobat.installed=!0)}catch(e){}try{oAcro7=new ActiveXObject("AcroPDF.PDF.1"),oAcro7&&(acrobat.installed=!0)}catch(e){}}return acrobat.installed},handleChromeOrFirefoxOnMac:function(){return navigator.appVersion.indexOf("Mac")!=-1&&jQuery.browser.mozilla?"<p>Important: Your print or preview will open using your browser's file download feature. Select 'Open with Preview' to view or print it.</p>":navigator.appVersion.indexOf("Mac")!=-1&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1?"<p>Important: Your print or preview will open using your browser's file download feature. Click on the button at the bottom of the screen to view or print it in Mac Preview.</p>":null},addGlobalParams:function(e,t){var n=new SDS.Dynamic.Context(SDS.Page.ClientContext.items.dynamicContext),r=n.store.criteria.name,i=new SDS.KeyFactory(window.currentAppName),s=window.storage.getFromEntityKey(getEntityKey()).get("keyPropertyName");e.entityKey=e.entityKey||i.createEntityKey(n.get("entityName"),n.get("metadataName")),e.userKey=e.userKey||getUserKey(),e.connectionKey=e.connectionKey||getConnectionKey(),e.pdfStorePath=SDS.Print.PdfPrint2.pdfStorePath,e.forDisplay=t==1&&t!=="Download"?!0:!1,e.keyColumnName=e.keyColumnName||s},callPrint:function(e,t,n,r){var i=jQuery("#MasterDynamicBody");r&&(i=r),SDS.Print.PdfPrint2.showSpinner(i,t);var s=typeof window.chrome!="undefined",o=navigator.appVersion.indexOf("Mac")!=-1&&jQuery.browser.safari&&!s;o=o||jQuery.browser.mozilla&&parseInt(jQuery.browser.version,10)>=19,!t&&o&&SDS.Print.PdfPrint2.safariPrintOpen(),SDS.Print.PdfPrint2.addGlobalParams(e,t);var u=SDS.Print.PdfPrint2.getHandlersObject(),a=SDS.Print.PrintFactory.getPrintObject(e,n,t,u);a.print()},printForm:function(e,t){SDS.Print.PdfPrint2.callPrint(e,t,"SDS.Pdf.PdfService.getRenderedForm"+(t&&t!=="Download"?"AsImages":""))},printList:function(e,t){SDS.Print.PdfPrint2.callPrint(e,t,"SDS.Pdf.PdfService.getRenderedList"+(t&&t!=="Download"?"AsImages":""))},printPhotos:function(e,t){SDS.Print.PdfPrint2.callPrint(e,t,"SDS.Pdf.PdfService.getRenderedPhotos"+(t&&t!=="Download"?"AsImages":""),jQuery("#PhotosContainer"))},printMapList:function(e,t){SDS.Print.PdfPrint2.callPrint(e,t,"SDS.Pdf.PdfService.getRenderedMapList"+(t&&t!=="Download"?"AsImages":""))},printLinkPage:function(e,t){SDS.Print.PdfPrint2.callPrint(e,t,"SDS.Pdf.PdfService.getRenderedLinkListings"+(t&&t!=="Download"?"AsImages":""))},printDirections:function(e,t){SDS.Print.PdfPrint2.callPrint(e,t,"SDS.Pdf.PdfService.getRenderedDrivingDirections"+(t&&t!=="Download"?"AsImages":""),jQuery("#directions-dialog"))},printStatistics:function(e,t){SDS.Print.PdfPrint2.callPrint(e,t,"SDS.Pdf.PdfService.getRenderedHtml"+(t&&t!=="Download"?"AsImages":""),jQuery("#StatisticsContainer"))},safariPrintOpen:function(){var e=window.location.href.split("/");e.pop(),e=e.join("/");var t=["<html>","<head>","<title>Please Wait</title>",'<link id="ctl00_ctl00_ThemeStylesheet" rel="stylesheet" type="text/css" href="',e,window.rootUrl+'Styles/Themes/Default/Theme.min.css">','<link id="ctl00_ctl00_ThemeStylesheet" rel="stylesheet" type="text/css" href="',e,window.rootUrl+'Pages/Dynamic/Results.css">',"</head>","<body>",'<div class="spinner-container" style="padding-top: 50px; margin: 50px auto; text-align:center;font-size:11px;font-family: Lucida Sans,Lucida Sans Unicode,Lucida Grande,Geneva,Arial,Sans-Serif;">','<div class="spinner-label" style="color: black; "><span>Preparing to print...</span></div>','<img width="32" height="32" src="'+window.rootUrl+'Images/SpinnerWhite.gif"></div>',"</body><html>"];try{SDS.Print.PdfPrint2.safariPrintWindow&&(!SDS.Print.PdfPrint2.safariPrintWindow.closed||SDS.Print.PdfPrint2.safariPrintWindow.document)&&SDS.Print.PdfPrint2.safariPrintWindow.close()}catch(n){}var r=1024,i=768;window.outerWidth<r&&(window.height=800,window.width=600),screen.width<r&&(r=screen.width-20,i=screen.height-20);var s=window.outerWidth>r?window.screenX+(window.outerWidth-r)/2:window.screenX,o=window.outerHeight>i?window.screenY+(window.outerHeight-i)/2:window.screenY;SDS.Print.PdfPrint2.safariPrintWindow=window.open("about:blank","safariPrintWindow","left="+s+",top="+o+",width="+r+",height="+i+",toolbar=1,scrollbars=1,status=0,resizable=1"),SDS.Print.PdfPrint2.safariPrintWindow&&(SDS.Print.PdfPrint2.safariPrintWindow.document.open(),SDS.Print.PdfPrint2.safariPrintWindow.document.write(t.join("")))},safariPrintLoad:function(e,t){SDS.Print.PdfPrint2.safariPrintWindow?SDS.Print.PdfPrint2.safariPrintWindow.location.href=e:SDS.Print.PdfPrint2.safariPrintWindow=window.open(e,"safariPrintWindow","left=0,left=0,width=640,height=480,toolbar=1,scrollbars=1,status=0,resizable=1");if(t||SDS.Print.PdfPrint2.detectAcrobat())return;var n=setInterval(function(){var e=SDS.Print.PdfPrint2.safariPrintWindow.document,t=e.location.href;if(t.indexOf(".html")!=-1)return;e&&/loaded|complete/.test(e.readyState)&&(SDS.Print.PdfPrint2.safariPrintWindow.print(),clearInterval(n))},1750)}}),"SDS"in window||(SDS={}),"Maps"in SDS||(SDS.Maps={}),SDS.Maps.Map={create:function(e,t){t=t||{},t.key=t.key||"";var n=this;typeof e=="string"&&(e=document.getElementById(e));var n=this;this.map||(n.mapContainer=e,n._initialZoom=t.clientID?17:15,n.map=SDS.SDSMap({container:n.mapContainer,modulePath:"Links/",type:t.clientID?"google":"bing",key:t.key,clientID:t.clientID,channelID:t.channelID,location:{latitude:0,longitude:0},zoom:n._initialZoom,features:{drawing:!1,logUsage:!0,directions:!1,clusters:currentAppName=="TREB",mapArt:currentAppName=="TREB",defaultUnits:currentAppName=="TREB"?"km":"mi"},initialType:currentAppName=="TREB"?"road":null,loadHandler:function(){n.addPushPins(n.map)},showLegendHandler:jQuery.proxy(n.showLegend,n),zoomForSingleListing:function(){return n._initialZoom}}))},addPushPins:function(e){e=e||this.map;var t=this;e.clearPushpins();var n=jQuery(".data-list tbody tr"),r=n.length,i=[],s=[];n.each(function(n,r){var i=jQuery(r),s=i.data("lt"),o=i.data("ln"),u=i.data("map-class"),a={Name:"",Latitude:s,Longitude:o,lsc:u,$o:i,index:n+1,identifier:i.data("identifier")};if(!s||!o)return!0;e.addPushpin({location:[s,o],data:a,cssClass:"map-pushpin "+t.getPushpinClass(a[_mapIcons.propertyName]),label:(n+1).toString(),mouseover:function(e){var n=e.target||e;n.mouseovercancel=!1,RenderMapInfoboxStaticContent(t.map,n,t.getInfoboxContent(n))},mouseout:function(e){var t=e.target||e;t.mouseovercancel=!0},click:function(e){var n=e.target||e;t.map.infoboxVisible?(n.mouseovercancel=!0,HideMapInfobox(t.map,n)):(n.mouseovercancel=!1,RenderMapInfoboxStaticContent(t.map,n,t.getInfoboxContent(n)))}})}),this.map.setBoundsFromPushpins()},getInfoboxContent:function(e){var t=SDS.Web.Pages.Public.Link.Config.get(getEntityKey().appName);if(!e.data&&e.getMarkers){var n=e.getMarkers();e.data=[];for(var r=0;r<n.length;r++)e.data.push(n[r].data[0])}if(e.data.length>1)return e.data.sort(function(e,t){return e.index-t.index}),e.getPushpinClass=this.getPushpinClass,t.getPopupForms(e);var i=e.data[0].$o,s=i.data("pop-up");s.index=e.data[0].index,s.pinCssClass=this.getPushpinClass(s[_mapIcons.propertyName]);var o=i.data("identifier")+"";return t.getPopupForm(o,s)},getPushpinClass:function(e){e=(e||"").toLowerCase(),e=e.replace("status-","");if(!window._mapIcons.mapIconUrls.classDictionary){window._mapIcons.mapIconUrls.classDictionary={};var t;for(var n=0;n<window._mapIcons.mapIconUrls.length;n++){var t=jQuery.trim(window._mapIcons.mapIconUrls[n].value);t!=null&&t!=""&&(window._mapIcons.mapIconUrls.classDictionary[t]=window._mapIcons.mapIconUrls[n].urlName.toLowerCase())}}var r=window._mapIcons.mapIconUrls.classDictionary[e];return r?"map-pushpin-"+r:""},showLegend:function(){var e=['<div id="LegendForm"><table><tbody>'];legendIcons=[],jQuery(window._mapIcons.mapIconUrls).each(function(){array=jQuery.grep(legendIcons,function(e){return e.url==this.url&&e.visibleName==this.visibleName}.bind(this)),array.length==0&&(e.push('<tr><td style="padding-top:2px; padding-bottom:2px;"><img src="'+this.url.replace("~/",rootUrl)+'"></td><td style="text-align:left; padding-left:8px;">'+this.visibleName+"</td></tr>"),legendIcons.push(this))}),e.push("</tbody></table></div>"),e=e.join("");var t=new SDS.Controls.MessageBox(e,{id:"map-legend-dialog",buttons:[{Text:"Close",Type:SDS.Controls.MessageBox.ButtonType.OK}],title:"Map Legend"});t.show()}};var HelpUtility={getCurrentVirtualPageID:function(){var e=SDS.Page.getCurrent()||{},t=e.name;return t},getCurrentTabID:function(){var e=jQuery(".master-section-tabs li.ui-tabs-selected > a");if(e&&e.length>0){var t=e[0];if(t.hash)return t.hash.substr(1)}return null},getCurrentDialogIDs:function(){var e=[];return jQuery(".facebox").each(function(){var t=jQuery(this);t.css("display")=="block"&&e.push({id:t.attr("id"),zIndex:t.css("z-index")||0})}),e.sort(function(e,t){return t-e}),jQuery.map(e,function(e){return e.id})},getDynamicPanelIsOpen:function(){return jQuery(".master-dynamic-panel").is(":visible")?!0:!1},getHelpID:function(){var e="";e+=window.helpIDPage;var t=HelpUtility.getCurrentVirtualPageID(),n=HelpUtility.getCurrentTabID(),r=HelpUtility.getCurrentDialogIDs(),i=HelpUtility.getDynamicPanelIsOpen();t?(e+="/",e+=t):n&&(e+="/",e+=n),r&&r.length>0&&(e+="/",e+=r.join("/")),i&&(e+="/",e+="dp"),window.helpIDSuffix&&(e+="/",e+=window.helpIDSuffix);if(e=="Pages/Dynamic/Results.aspx/List"){var s=SDS.Page.ClientContext.items.dynamicContext.criteria;s.searchRef=="EntityListSearch"&&(e+="/",e+=s.name.replace(/ /g,"-"))}return e=e.replace(/\//g,"%2f"),e},getOpenOptions:function(){var e=774,t=630,n=screen.width-e,r=screen.height/2-t/2,i="location=no";return i+=",toolbar=no",i+=",menubar=no",i+=",status=yes",i+=",scrollbars=yes",i+=",resizable=yes",i+=",width="+e,i+=",height="+t,i+=",left="+n,i+=",screenX="+n,i+=",top="+r,i+=",screenY="+r,i},showHelp:function(e,t,n){e=HelpUtility.getHelpID();var r=window.event;if(r&&r.altKey)return alert(e),!1;var i=HelpUtility.getOpenOptions();HelpUtility.finishShowHelp(e,i,t,n)},finishShowHelp:function(e,t,n,r){if(!n||n==="undefined"||n==="")var n="Listing";var i="Help.aspx?EntityName="+n+"&HelpID="+e;r&&(i+="&HelpPath="+r),window.open(i,"StratusMLSHelp",t)}};if(typeof SDS=="undefined")var SDS={};typeof SDS.Web=="undefined"&&(SDS.Web={}),typeof SDS.Web.Pages=="undefined"&&(SDS.Web.Pages={}),typeof SDS.Web.Pages.Public=="undefined"&&(SDS.Web.Pages.Public={}),typeof SDS.Web.Pages.Public.Link=="undefined"&&(SDS.Web.Pages.Public.Link={}),SDS.Web.Pages.Public.Link.Config=Base.extend({constructor:function(e){this.appName=e.appName,this.name=e.name},appName:null,name:null,showUnitsSelect:function(){throw new Error("Not Implemented")}}),SDS.Web.Pages.Public.Link.Config.register=function(e){typeof this._registry=="undefined"&&(this._registry={}),this._registry[e.appName.toUpperCase()]=e},SDS.Web.Pages.Public.Link.Config.get=function(e){return typeof this._registry=="undefined"?null:this._registry[e.toUpperCase()]},SDS.Web.Pages.Public.Link.MLSLIConfig=SDS.Web.Pages.Public.Link.Config.extend({constructor:function(){this.base({appName:"MLSLI",name:"Multiple Listing Service of Long Island"})},showUnitsSelect:function(){return!1},getPopupForms:function(e){var t=[];for(var n=0,r=e.data.length;n<r;n++){var i=e.data[n].$o,s=i.data("pop-up");s.pinCssClass=e.getPushpinClass(s[_mapIcons.propertyName]);var o=i.data("identifier")+"";t.push(this.getPopupForm(o,s))}var u='<h4 style="margin: 0px 0px 5px 0px;">'+r+" Overlapping Listings:</h4>",a=['<div style="padding:0px 0px 10px 10px;">',u,'<div style="width:100%; overflow-x: auto; overflow-y: auto; border-top: 1px solid #ddd; border-bottom: 1px solid #ddd;">',t.join('<hr style="border-width: 0px; border-top:1px solid #ddd"/>'),"</div>","</div>"];return a.join("")},getPopupForm:function(e,t){var n=(t.lsc||"").toLowerCase(),r=formatMoney(n=="cl"?t.sp_dol:t.lsc=="re"?t.rp_dol:t.lp_dol,0,".",","),i=t.br,s=t.bth,o=t.style,u=t.index,a=t.pinCssClass,f=o+(i?", "+i+" Beds":"")+(s?", "+s+" Baths":"");return['<div class="pop-up-form">','<div class="infobox-pushpin map-pushpin map-pushpin '+a+'"><div class="text">'+u+"</div></div>","<div>",'<img src="'+window.rootUrl+"photos/FULL/1/"+e.substring(e.length-3)+"/"+(e||"").replace("*","P")+'.jpg" onerror="this.src=window.rootUrl+\'Images/PhotoNotAvailable.png\';" width="165" height="110" />',"</div>","<div>",'<label>ML#:</label> <a href="#'+e+'">'+e+"</a>","</div>","<div>"+r+"</div><div>"+t.addr+"</div><div>"+t.town+", "+(t.ste||"NY")+" "+t.zip+"</div><div>"+f+"</div>",'<br /><a href="#'+e+'">Detail View</a>','</div><hr class="clearfix" />'].join("")}}),SDS.Web.Pages.Public.Link.Config.register(new SDS.Web.Pages.Public.Link.MLSLIConfig),SDS.Web.Pages.Public.Link.TREBConfig=SDS.Web.Pages.Public.Link.Config.extend({constructor:function(){this.base({appName:"TREB",name:"Toronto Regional Real Estate Board"})},showUnitsSelect:function(){return!0},getPopupForms:function(e){var t=[];for(var n=0,r=e.data.length;n<r;n++){var i=e.data[n].$o,s=i.data("pop-up");s.index=e.data[n].index;var o=i.data("identifier")+"";t.push(this.getPopupForm(o,s))}var u=['<div style="padding:0px 0px 10px 10px;">','<div style="width:100%; overflow-x: auto; overflow-y: auto; border-top: 1px solid #ddd; border-bottom: 1px solid #ddd;">',t.join('<hr style="border-width: 0px; border-top:1px solid #ddd"/>'),"</div>","</div>"];return u.join("")},getPopupForm:function(e,t){var n=(t["class"]||"").toLowerCase();if(n=="com")return'<div class="pop-up-form"><div><img src="'+window.rootUrl+"photos/FULL/1/"+e.substring(e.length-3)+"/"+e+'.jpg" onerror="this.src=window.rootUrl+\'Images/PhotoNotAvailable.png\';" width="165" height="110" /></div><div>'+formatMoney(t.lp_dol,2,".",",")+" "+t.lp_code+'</div><div><label>MLS#:</label><a href="#'+e+'">'+e+"</a></div><div>"+t.type_own1_out+"</div><div>"+t.tot_area+" "+t.tot_areacd+"</div><div>"+t.addr+" "+t.apt_num+"</div><div>"+t.municipality+" "+(t.province||"ON")+" "+t.zip+'</div><br /><a href="#'+e+'">Property Detail</a></div><hr class="clearfix" />';var r=t.br,i=t.bath_tot,s=t.style,o=t.index,u=t.pinCssClass,a=(r?r+" Br ":"")+(i?i+" Wr ":"")+s;return['<div class="pop-up-form">','<div class="infobox-pushpin map-pushpin map-pushpin '+u+'"><div class="text">'+o+"</div></div>","<div>",'<img src="'+window.rootUrl+"photos/FULL/1/"+e.substring(e.length-3)+"/"+e+'.jpg" onerror="this.src=window.rootUrl+\'Images/PhotoNotAvailable.png\';" width="165" height="110" />',"</div><div>",formatMoney(t.lp_dol,2,".",","),"</div><div>",'<label>MLS#:</label><a href="#'+e+'">'+e+"</a>","</div><div>",a,"</div><div>","<label>LSC:</label>"+t.lsc,"</div><div>",t.addr+" "+t.apt_num,"</div><div>",t.municipality+" "+(t.province||"ON")+" "+t.zip,"</div><br />",'<a href="#'+e+'">Property Detail</a>','</div><hr class="clearfix" />'].join("")}}),SDS.Web.Pages.Public.Link.Config.register(new SDS.Web.Pages.Public.Link.TREBConfig);